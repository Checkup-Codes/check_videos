import{Q as X,p as v,r as f,m as ee,c as i,o as u,a as s,t as l,F as P,g as W,h as y,n as b,S as te,U as se,N as re,K as ne}from"./ssr-DzRk3HnO.js";import{g}from"./index-D3jsOSc0.js";import{_ as oe}from"./app-CJ9FyM0q.js";const m=h=>(te("data-v-aefdf18c"),h=h(),se(),h),ae={class:"flex flex-col items-center justify-center"},le={key:0,class:"w-full max-w-md rounded-2xl border border-gray-200 bg-white shadow-sm"},ie=m(()=>s("h2",{class:"mb-2 text-2xl font-semibold text-gray-900"},"Test Özeti",-1)),ue={class:"mb-4 text-center"},ce={class:"text-4xl font-bold text-gray-900"},de=m(()=>s("p",{class:"text-sm text-gray-600"},"Puan",-1)),ge={class:"mb-4 grid grid-cols-2 gap-4 rounded-lg bg-gray-50 p-4"},ve={class:"text-center"},fe={class:"text-2xl font-bold text-green-600"},pe=m(()=>s("p",{class:"text-sm text-gray-600"},"Doğru",-1)),me={class:"text-center"},he={class:"text-2xl font-bold text-red-600"},xe=m(()=>s("p",{class:"text-sm text-gray-600"},"Yanlış",-1)),_e={class:"mb-4 max-h-60 overflow-y-auto"},we=m(()=>s("h3",{class:"mb-2 font-medium text-gray-700"},"Cevaplarınız:",-1)),ye={class:"space-y-2 text-left text-sm text-gray-800"},be={class:"flex flex-col"},ke={class:"text-xs text-gray-500"},Ce={class:"space-y-2"},Ie=["disabled"],Se={class:"flex gap-2"},Qe={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-gray-200"},Ae={class:"mb-4 text-right text-sm text-gray-500"},Oe={class:"flex items-center justify-between"},Me={class:"text-xl font-semibold text-gray-900"},Re=["disabled"],Te={class:"mt-1 text-sm text-gray-500"},Pe={key:0,class:"rounded-lg bg-blue-50 p-3"},We=m(()=>s("p",{class:"text-sm text-blue-600"},"Örnek Cümle:",-1)),Be={key:0,class:"mt-1 text-sm text-gray-700"},He={key:1,class:"mt-1 text-sm text-gray-700"},De=["onClick","disabled"],ze={__name:"MultipleChoice",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(h,{emit:B}){const c=h,S=B,Q=X(),H=Q.props.languagePacks||[],A=v(()=>{var t;return!!((t=Q.props.auth)!=null&&t.user)});v(()=>c.packSlug?H.find(t=>t.slug===c.packSlug):null);const e=f({isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),w=f([]),O=v(()=>Object.fromEntries(w.value.map(t=>[t.id,t]))),k=f(null),M=f(null),C=f(null),R=f(null),p=f(!1),D=()=>{g.fromTo(R.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),g.fromTo(k.value.children,{opacity:0,x:-20},{opacity:1,x:0,duration:.3,stagger:.1,ease:"power2.out"})},z=t=>{g.to(t,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}),g.to(t,{scale:1,duration:.2,delay:.2})},G=t=>{g.timeline().to(t,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(t,{x:-10,duration:.1}).to(t,{x:10,duration:.1}).to(t,{x:-5,duration:.1}).to(t,{x:5,duration:.1}).to(t,{x:0,scale:1,duration:.2})},j=t=>{g.to(M.value,{width:`${t}%`,duration:.5,ease:"power2.out"}),g.fromTo(C.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),g.to(C.value,{opacity:t===100?0:.5,duration:.3})},L=()=>{e.value.currentIndex++,e.value.progress=Math.round(e.value.currentIndex/e.value.totalQuestions*100),e.value.currentIndex<e.value.totalQuestions?(e.value.selectedAnswer=null,e.value.showAnswer=!1,e.value.currentOptions=[],e.value.hintShown=!1,e.value.currentHintIndex=0,e.value.currentQuestion=w.value[e.value.currentIndex],ne(()=>{D()})):e.value.isPlaying=!1},T=async()=>{if(!c.words||c.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let t=[...c.words];if(c.gameConfig.prioritizeUnlearned){const o=t.filter(d=>d.learning_status===0),r=t.filter(d=>d.learning_status===1),a=t.filter(d=>d.learning_status===2);t=[...o,...r,...a]}c.gameConfig.prioritizeRecentlyLearned&&t.sort((o,r)=>{const a=new Date(o.last_reviewed_at||0);return new Date(r.last_reviewed_at||0)-a}),c.gameConfig.prioritizeFlagged&&t.sort((o,r)=>o.is_flagged&&!r.is_flagged?-1:!o.is_flagged&&r.is_flagged?1:0),c.gameConfig.prioritizeMostIncorrect&&t.sort((o,r)=>{const a=o.incorrect_count||0;return(r.incorrect_count||0)-a}),t=t.sort(()=>Math.random()-.5);const n=Math.min(c.gameConfig.questionCount,t.length);t=t.slice(0,n),e.value={isLoading:!1,isPlaying:!0,currentQuestion:t[0],currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:t.length,userResponses:[],hintShown:!1,currentHintIndex:0},w.value=t},N=v(()=>{if(!e.value.userResponses.length)return 0;const t=e.value.userResponses.filter(n=>n.correct).length;return Math.round(t/e.value.userResponses.length*100)}),U=t=>{switch(t){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},$=v(()=>e.value.userResponses.filter(t=>t.correct).length),E=v(()=>e.value.userResponses.filter(t=>!t.correct).length),F=v(()=>e.value.currentQuestion?(e.value.currentOptions.length===0&&(e.value.currentOptions=J(e.value.currentQuestion,w.value)),e.value.currentOptions):[]),q=t=>{e.value.selectedAnswer=t,e.value.showAnswer=!0,e.value.isCorrect=I(t,e.value.currentQuestion),e.value.userResponses.push({word_id:e.value.currentQuestion.id,selected_option:t.meaningText,correct:e.value.isCorrect});const n=event.target;e.value.isCorrect?z(n):G(n);const o=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);j(o),setTimeout(()=>{const r=k.value.children;for(let a of r)g.set(a,{clearProps:"all"}),a.style.backgroundColor="",a.style.borderColor="";L()},1500)},K=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},T()},V=()=>{if(!A.value||!e.value.userResponses.length||p.value)return;p.value=!0;const t=e.value.userResponses.map(n=>({word_id:n.word_id,review_count:1,incorrect_count:n.correct?0:1}));re.post("/update-words",{words:t},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),p.value=!1,S("game-completed")},onError:n=>{console.error("İstatistik güncelleme hatası:",n),p.value=!1}})},Y=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},x=t=>{if(!t)return"";if(t.meanings&&t.meanings.length>0){const n=t.meanings.find(o=>o.is_primary);return n?n.meaning:t.meanings[0].meaning}return t.meaning||""},I=(t,n)=>!t||!n?!1:t.wordId===n.id,Z=t=>{var n;return((n=e.value.selectedAnswer)==null?void 0:n.wordId)===t.wordId},J=(t,n,o=4)=>{const r={wordId:t.id,meaningText:x(t),isCorrect:!0};return[...[...n.filter(_=>_.id!==t.id&&x(_)!==x(t))].sort(()=>.5-Math.random()).slice(0,o-1).map(_=>({wordId:_.id,meaningText:x(_),isCorrect:!1})),r].sort(()=>.5-Math.random())};return ee(()=>{T()}),(t,n)=>{var o;return u(),i("div",ae,[!e.value.isPlaying&&e.value.userResponses.length>0?(u(),i("div",le,[ie,s("div",ue,[s("p",ce,l(N.value)+" / 100",1),de]),s("div",ge,[s("div",ve,[s("p",fe,l($.value),1),pe]),s("div",me,[s("p",he,l(E.value),1),xe])]),s("div",_e,[we,s("ul",ye,[(u(!0),i(P,null,W(e.value.userResponses,r=>{var a;return u(),i("li",{key:r.word_id,class:"flex items-center justify-between rounded-md bg-gray-50 px-4 py-2"},[s("div",be,[s("span",{class:b(r.correct?"font-medium text-green-600":"font-medium text-red-600")},l(((a=O.value[r.word_id])==null?void 0:a.word)||"Unknown"),3),s("span",ke,l(x(O.value[r.word_id])),1)]),s("span",{class:b(r.correct?"text-lg text-green-600":"text-lg text-red-600")},l(r.correct?"✓":"✗"),3)])}),128))])]),s("div",Ce,[A.value?(u(),i("button",{key:0,onClick:V,class:"w-full rounded-lg bg-blue-600 px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-blue-700",disabled:p.value},l(p.value?"Güncelleniyor...":"Kelime İstatistiklerini Güncelle"),9,Ie)):y("",!0),s("div",Se,[s("button",{onClick:n[0]||(n[0]=r=>S("game-completed")),class:"flex-1 rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700"}," Pakete Dön "),s("button",{onClick:K,class:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Tekrar Başla ")])])])):(u(),i("div",{key:1,class:b(["relative w-full max-w-md rounded-2xl border border-gray-200 p-6 shadow-sm transition-colors duration-500",{"bg-white":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[s("div",Qe,[s("div",{ref_key:"progressBar",ref:M,class:"h-full w-0 bg-black"},null,512),s("div",{ref_key:"progressBarGlow",ref:C,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),s("div",Ae," Soru "+l(e.value.currentIndex+1)+" / "+l(e.value.totalQuestions),1),e.value.currentQuestion?(u(),i("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:R},[s("div",null,[s("div",Oe,[s("h2",Me,' "'+l(e.value.currentQuestion.word)+'" kelimesinin anlamı nedir? ',1),e.value.showAnswer?y("",!0):(u(),i("button",{key:0,onClick:Y,class:"rounded-lg border border-gray-200 px-3 py-1 text-sm text-gray-600 hover:bg-gray-50",disabled:e.value.hintShown&&(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length<=1)},l(e.value.hintShown?`İpucu (${e.value.currentHintIndex+1}/${((o=e.value.currentQuestion.example_sentences)==null?void 0:o.length)||0})`:"İpucu Göster"),9,Re))]),s("p",Te,"Kelime Türü: "+l(U(e.value.currentQuestion.type)),1)]),e.value.hintShown?(u(),i("div",Pe,[We,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(u(),i("p",Be,l(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)):(u(),i("p",He,"Bu kelime için örnek cümle bulunmuyor."))])):y("",!0),s("div",{class:"space-y-2",ref_key:"optionsContainer",ref:k},[(u(!0),i(P,null,W(F.value,(r,a)=>(u(),i("button",{key:a,onClick:d=>q(r),disabled:e.value.showAnswer,class:b(["w-full rounded-lg border border-gray-200 p-3 text-left text-base text-gray-900 transition disabled:cursor-not-allowed",{"border-green-500 bg-green-50":e.value.showAnswer&&I(r,e.value.currentQuestion),"border-red-500 bg-red-50":e.value.showAnswer&&!I(r,e.value.currentQuestion)&&Z(r)}])},l(r.meaningText),11,De))),128))],512)],512)):y("",!0)],2))])}}},$e=oe(ze,[["__scopeId","data-v-aefdf18c"]]);export{$e as default};
