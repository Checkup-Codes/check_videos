const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-xJT5jGAa.js","assets/index-yBjzXJbu.js","assets/index-fNjTmf9T.js","assets/index-LzOW3efo.js","assets/app-fMi4_bpD.js","assets/app-CRogC4ds.css","assets/app-h54fPrz6.css","assets/client-pNluWoJl.js"])))=>i.map(i=>d[i]);
import{Q as O,r as d,C as L,x as M,D as c,g as m,o as v,h as f,b as l,t as k,j as R,E as A,F as D,m as P,u as V,s as C}from"./app-fMi4_bpD.js";const B={key:0,class:"rounded bg-green-200 p-3 text-green-800"},N={class:"bg-base-100 px-2 lg:p-3"},j={class:"flex justify-between rounded-md px-1 py-2 text-base-content sm:mx-3 md:mx-5"},F={class:"flex"},J=l("label",{for:"versionDropdown",class:"my-auto text-nowrap px-3 font-semibold"},"Versiyon Seç:",-1),$=["value"],z={class:"ml-auto flex items-center justify-end space-x-2"},K=l("div",{id:"excalidraw-container",class:"h-[calc(79vh)] w-full"},[l("div",{id:"excali",class:"h-full w-full"})],-1),q={__name:"ExcalidrawComponent",setup(Q){const{props:o}=O(),h=d([]),u=d(""),n=d(o.write.write_draws),s=d(n.value.length>0?n.value[0].id:null),b=d(null),i=d(document.documentElement.getAttribute("data-theme")==="dark");L(i,a=>{b.value&&b.value.updateScene({theme:a?"dark":"light"})}),M(()=>{const a=new MutationObserver(e=>{e.forEach(t=>{t.attributeName==="data-theme"&&(i.value=document.documentElement.getAttribute("data-theme")==="dark")})});return a.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),S(),()=>a.disconnect()});const S=()=>{c(async()=>{const{Excalidraw:a}=await import("./main-xJT5jGAa.js").then(e=>e.m);return{Excalidraw:a}},__vite__mapDeps([0,1,2])).then(({Excalidraw:a})=>{c(()=>import("./index-LzOW3efo.js").then(e=>e.i),__vite__mapDeps([3,4,5,6,1])).then(e=>{c(()=>import("./client-pNluWoJl.js").then(t=>t.c),__vite__mapDeps([7,4,5,6,2,1])).then(t=>{const _=document.getElementById("excali"),p=t.createRoot(_),w=n.value.length>0?{elements:JSON.parse(n.value[0].elements),scrollToContent:!0,theme:i.value?"dark":"light"}:{elements:[],scrollToContent:!0,theme:i.value?"dark":"light"},g=r=>{h.value=r},E=e.createElement(a,{initialData:w,onChange:g,viewModeEnabled:!o.auth.user,theme:i.value?"dark":"light",onMount:r=>{b.value=r}});p.render(E)})})})},x=()=>{const a=n.value.find(e=>e.id===s.value);a&&c(async()=>{const{Excalidraw:e}=await import("./main-xJT5jGAa.js").then(t=>t.m);return{Excalidraw:e}},__vite__mapDeps([0,1,2])).then(({Excalidraw:e})=>{c(()=>import("./index-LzOW3efo.js").then(t=>t.i),__vite__mapDeps([3,4,5,6,1])).then(t=>{c(()=>import("./client-pNluWoJl.js").then(_=>_.c),__vite__mapDeps([7,4,5,6,2,1])).then(_=>{const p=document.getElementById("excali"),w=_.createRoot(p),g={elements:JSON.parse(a.elements),scrollToContent:!0,theme:i.value?"dark":"light"},E=t.createElement(e,{initialData:g,onChange:r=>{h.value=r},viewModeEnabled:!o.auth.user,theme:i.value?"dark":"light",onMount:r=>{b.value=r}});w.render(E)})})})},T=()=>{const a=h.value.length>0?h.value:[],e=JSON.stringify(a);C.post(`/writes/${o.write.id}/draw`,{elements:e}).then(t=>{y("Canvas durumu başarıyla kaydedildi!"),n.value.push(t.data)}).catch(()=>{y("Kaydetme sırasında bir hata oluştu. Lütfen tekrar deneyin.")})},I=()=>{n.value.find(e=>e.id===s.value)&&confirm("Bu versiyonu silmek istediğinizden emin misiniz?")&&C.delete(`/writes/${o.write.id}/draw/${s.value}`).then(()=>{u.value="Versiyon başarıyla silindi.",n.value=n.value.filter(e=>e.id!==s.value),n.value.length>0?(s.value=n.value[0].id,x()):(h.value=[],s.value=null)}).catch(e=>{u.value="Silme işlemi sırasında bir hata oluştu. Lütfen tekrar deneyin."})},y=a=>{u.value=a,setTimeout(()=>{u.value=""},3e3)};return(a,e)=>(v(),m(D,null,[u.value?(v(),m("div",B,k(u.value),1)):f("",!0),l("div",N,[l("div",j,[l("div",F,[J,R(l("select",{id:"versionDropdown","onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t),onChange:x,class:"select-bordered select select-sm mx-5 bg-base-100 text-base-content"},[(v(!0),m(D,null,P(n.value,t=>(v(),m("option",{key:t.id,value:t.id},"Versiyon "+k(t.version),9,$))),128))],544),[[A,s.value]])]),l("div",z,[V(o).auth.user?(v(),m("button",{key:0,onClick:I,class:"btn btn-ghost btn-sm"},"Sil")):f("",!0),V(o).auth.user?(v(),m("button",{key:1,onClick:T,class:"btn btn-primary btn-sm"},"Kaydet")):f("",!0)])]),K])],64))}};export{q as _};
