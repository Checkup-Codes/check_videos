import{Q as K,p as g,r as m,m as $,c as i,o as c,a as t,t as a,F as P,g as H,h as x,n as _,k as X,v as Z,H as J,S as ee,U as te,N as se,I as ne}from"./ssr-CelVhnxm.js";import{g as v}from"./index-D3jsOSc0.js";import{_ as oe}from"./app-DqonJLi-.js";/* empty css            */const b=f=>(ee("data-v-4b439450"),f=f(),te(),f),re={class:"flex flex-col items-center justify-center"},ae={key:0,class:"w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6"},le={class:"mb-4 text-center"},ue=b(()=>t("h2",{class:"mb-2 text-xl font-semibold text-base-content"},"Test Tamamlandı",-1)),ie={class:"inline-flex items-center gap-2 rounded bg-base-200 px-3 py-1"},ce=b(()=>t("span",{class:"text-base-content/70 text-sm"},"Puan:",-1)),de={class:"text-lg font-bold text-base-content"},ve={class:"mb-4 grid grid-cols-2 gap-4"},be={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},me={class:"mb-1"},pe={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100"},ge={class:"text-sm font-bold text-green-600"},xe=b(()=>t("p",{class:"text-base-content/70 text-xs"},"Doğru",-1)),fe={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},he={class:"mb-1"},_e={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100"},we={class:"text-sm font-bold text-red-600"},ye=b(()=>t("p",{class:"text-base-content/70 text-xs"},"Yanlış",-1)),ke={class:"mb-4"},Ce=b(()=>t("h3",{class:"mb-2 text-sm font-medium text-base-content"},"Cevaplarınız",-1)),Ie={class:"max-h-48 space-y-2 overflow-y-auto"},Qe={class:"flex items-center gap-2"},Se={class:"flex flex-col"},Ae={class:"text-sm font-medium text-base-content"},Re={class:"text-base-content/70 text-xs"},Te={class:"space-y-2"},Be=["disabled"],De={class:"flex gap-2"},Pe={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-base-200"},He={class:"text-base-content/70 mb-4 text-right text-sm"},Me={class:"mb-2 text-2xl font-semibold text-base-content"},je=b(()=>t("p",{class:"text-base-content/70 mb-3"},"Bu kelimenin anlamı nedir?",-1)),ze={class:"flex items-center justify-between"},We={class:"inline-flex items-center rounded border border-base-300 bg-base-200 px-2 py-1 text-xs text-base-content"},Le={key:0,class:"rounded border border-base-300 bg-base-200 p-3"},Ge=b(()=>t("p",{class:"text-sm font-medium text-base-content"},"Örnek Cümle:",-1)),Ne={key:0,class:"mt-1 text-sm text-base-content"},Ue={key:1,class:"mt-1 text-sm text-base-content"},Ee={class:"space-y-4"},Fe=["disabled"],Oe=["disabled"],Ve={class:"mt-1 text-base-content"},Ye={key:0,class:"mt-3"},qe=b(()=>t("p",{class:"text-base-content/70 text-sm font-medium"},"Diğer Anlamlar:",-1)),Ke={class:"mt-1 list-inside list-disc space-y-1 text-sm text-base-content"},$e={__name:"TranslateWord",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(f,{emit:M}){const d=f,y=M,k=K(),j=k.props.languagePacks||[],C=g(()=>{var s;return!!((s=k.props.auth)!=null&&s.user)});g(()=>d.packSlug?j.find(s=>s.slug===d.packSlug):null);const e=m({isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),h=m([]),I=g(()=>Object.fromEntries(h.value.map(s=>[s.id,s]))),Q=m(null),w=m(null),S=m(null),l=m(null),p=m(!1),z=()=>{v.fromTo(S.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),v.fromTo(l.value,{opacity:0,y:10},{opacity:1,y:0,duration:.3,delay:.2,ease:"power2.out"})},W=()=>{v.timeline().to(l.value,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}).to(l.value,{scale:1,duration:.2,ease:"power2.out"});const o=50,n=["#34d399","#10b981","#059669"];for(let u=0;u<o;u++){const r=document.createElement("div");r.style.position="absolute",r.style.width="8px",r.style.height="8px",r.style.backgroundColor=n[Math.floor(Math.random()*n.length)],r.style.borderRadius="50%",document.body.appendChild(r);const B=l.value.getBoundingClientRect().left+l.value.offsetWidth/2,D=l.value.getBoundingClientRect().top;v.fromTo(r,{x:B,y:D,scale:0},{x:B+(Math.random()-.5)*200,y:D-100-Math.random()*100,scale:1,opacity:0,duration:1,ease:"power4.out",onComplete:()=>r.remove()})}},L=()=>{v.timeline().to(l.value,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(l.value,{x:-10,duration:.1}).to(l.value,{x:10,duration:.1}).to(l.value,{x:-5,duration:.1}).to(l.value,{x:5,duration:.1}).to(l.value,{x:0,scale:1,duration:.2})},G=s=>{v.to(Q.value,{width:`${s}%`,duration:.5,ease:"power2.out"}),v.fromTo(w.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),v.to(w.value,{opacity:s===100?0:.5,duration:.3})},A=async()=>{if(!d.words||d.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let s=[...d.words];if(d.gameConfig.prioritizeUnlearned){const o=s.filter(r=>r.learning_status===0),n=s.filter(r=>r.learning_status===1),u=s.filter(r=>r.learning_status===2);s=[...o,...n,...u]}d.gameConfig.prioritizeRecentlyLearned&&s.sort((o,n)=>{const u=new Date(o.last_reviewed_at||0);return new Date(n.last_reviewed_at||0)-u}),d.gameConfig.prioritizeFlagged&&s.sort((o,n)=>o.is_flagged&&!n.is_flagged?-1:!o.is_flagged&&n.is_flagged?1:0),d.gameConfig.prioritizeMostIncorrect&&s.sort((o,n)=>{const u=o.incorrect_count||0;return(n.incorrect_count||0)-u}),s=s.sort(()=>Math.random()-.5),await new Promise(o=>{h.value=s,e.value.totalQuestions=h.value.length,e.value.currentIndex=0,e.value.userResponses=[],o()}),e.value.isLoading=!1,e.value.isPlaying=!0,R()},N=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},R=()=>{if(e.value.currentIndex>=h.value.length){F();return}e.value.currentQuestion=h.value[e.value.currentIndex],e.value.userInput="",e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0&&(e.value.hintShown=!0,e.value.currentHintIndex=0),ne(()=>{z()})},T=()=>{if(!e.value.userInput.trim())return;const s=e.value.userInput.trim().toLowerCase(),n=(e.value.currentQuestion.meanings||[{meaning:e.value.currentQuestion.meaning}]).some(r=>r.meaning.toLowerCase()===s);e.value.isCorrect=n,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:e.value.isCorrect}),e.value.showAnswer=!0,e.value.isCorrect?W():L();const u=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);G(u),setTimeout(()=>{v.set(l.value,{clearProps:"all"}),l.value.style.backgroundColor="",l.value.style.borderColor="",e.value.currentIndex++,e.value.userInput="",e.value.showAnswer=!1,e.value.progress=0,R()},2e3)},U=g(()=>{if(!e.value.userResponses.length)return 0;const s=e.value.userResponses.filter(o=>o.correct).length;return Math.round(s/e.value.userResponses.length*100)}),E=s=>{switch(s){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},F=()=>{e.value.isPlaying=!1},O=()=>{if(!C.value||!e.value.userResponses.length||p.value)return;p.value=!0;const s=e.value.userResponses.map(o=>({word_id:o.word_id,review_count:1,incorrect_count:o.correct?0:1}));se.post("/update-words",{words:s},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),p.value=!1,setTimeout(()=>{y("game-completed")},1e3)},onError:o=>{console.error("İstatistik güncelleme hatası:",o),p.value=!1}})},V=g(()=>e.value.userResponses.filter(s=>s.correct).length),Y=g(()=>e.value.userResponses.filter(s=>!s.correct).length),q=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},A()};return $(()=>{A()}),(s,o)=>(c(),i("div",re,[!e.value.isPlaying&&e.value.userResponses.length>0?(c(),i("div",ae,[t("div",le,[ue,t("div",ie,[ce,t("span",de,a(U.value)+" / 100",1)])]),t("div",ve,[t("div",be,[t("div",me,[t("div",pe,[t("span",ge,a(V.value),1)])]),xe]),t("div",fe,[t("div",he,[t("div",_e,[t("span",we,a(Y.value),1)])]),ye])]),t("div",ke,[Ce,t("div",Ie,[(c(!0),i(P,null,H(e.value.userResponses,n=>{var u,r;return c(),i("div",{key:n.word_id,class:"flex items-center justify-between rounded border border-base-300 bg-base-200 p-2"},[t("div",Qe,[t("div",{class:_(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",n.correct?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},a(n.correct?"✓":"✗"),3),t("div",Se,[t("span",Ae,a(((u=I.value[n.word_id])==null?void 0:u.word)||"Unknown"),1),t("span",Re,a(((r=I.value[n.word_id])==null?void 0:r.meaning)||""),1)])]),t("span",{class:_(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",n.correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},a(n.correct?"Doğru":"Yanlış"),3)])}),128))])]),t("div",Te,[C.value?(c(),i("button",{key:0,onClick:O,class:"w-full rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content",disabled:p.value},a(p.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,Be)):x("",!0),t("div",De,[t("button",{onClick:o[0]||(o[0]=n=>y("game-completed")),class:"flex-1 rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content"}," Pakete Dön "),t("button",{onClick:q,class:"flex-1 rounded border border-base-300 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"}," Tekrar Başla ")])])])):(c(),i("div",{key:1,class:_(["relative w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6 transition-colors duration-500",{"bg-base-100":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",Pe,[t("div",{ref_key:"progressBar",ref:Q,class:"h-full w-0 bg-base-content"},null,512),t("div",{ref_key:"progressBarGlow",ref:w,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),t("div",He," Soru "+a(e.value.currentIndex+1)+" / "+a(e.value.totalQuestions),1),e.value.currentQuestion?(c(),i("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:S},[t("div",null,[t("h2",Me,'"'+a(e.value.currentQuestion.word)+'"',1),je,t("div",ze,[t("span",We,a(E(e.value.currentQuestion.type)),1),!e.value.showAnswer&&e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>1?(c(),i("button",{key:0,onClick:N,class:"text-base-content/70 text-xs transition-colors hover:text-base-content"}," Sonraki İpucu ("+a(e.value.currentHintIndex+1)+"/"+a(e.value.currentQuestion.example_sentences.length)+") ",1)):x("",!0)])]),e.value.hintShown?(c(),i("div",Le,[Ge,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(c(),i("p",Ne,a(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)):(c(),i("p",Ue,"Bu kelime için örnek cümle bulunmuyor."))])):x("",!0),t("div",Ee,[X(t("input",{ref_key:"answerInput",ref:l,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.userInput=n),type:"text",disabled:e.value.showAnswer,onKeyup:J(T,["enter"]),placeholder:"Cevabınızı yazın...",class:"w-full rounded border border-base-300 bg-base-100 p-3 text-base-content focus:border-base-content focus:outline-none focus:ring-1 focus:ring-base-content disabled:cursor-not-allowed"},null,40,Fe),[[Z,e.value.userInput]]),t("button",{onClick:T,disabled:!e.value.userInput.trim()||e.value.showAnswer,class:"w-full rounded border border-base-300 bg-base-content px-4 py-3 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content disabled:cursor-not-allowed disabled:opacity-50"},a(e.value.showAnswer?"Sonraki Soru":"Cevapla"),9,Oe)]),e.value.showAnswer?(c(),i("div",{key:1,class:_(["mt-4 rounded border border-base-300 p-4",{"bg-red-50":!e.value.isCorrect,"bg-green-50":e.value.isCorrect}])},[t("p",{class:_(["text-sm font-medium",{"text-red-600":!e.value.isCorrect,"text-green-600":e.value.isCorrect}])}," Doğru Cevap: ",2),t("p",Ve,a(e.value.currentQuestion.meaning),1),e.value.currentQuestion.meanings&&e.value.currentQuestion.meanings.length>1?(c(),i("div",Ye,[qe,t("ul",Ke,[(c(!0),i(P,null,H(e.value.currentQuestion.meanings,(n,u)=>(c(),i("li",{key:u},a(n.meaning),1))),128))])])):x("",!0)],2)):x("",!0)],512)):x("",!0)],2))]))}},tt=oe($e,[["__scopeId","data-v-4b439450"]]);export{tt as default};
