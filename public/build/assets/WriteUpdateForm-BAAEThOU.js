import{e as c,Q as me,p as D,T as be,m as J,D as L,y as T,A as pe,c as n,a as l,k as g,h as b,v as h,u as r,n as k,t as p,b as ge,C as Q,F as X,g as Z,J as xe,f as ye,l as he,N as we,o as d}from"./ssr-C3nf8soi.js";import ke from"./RichTextEditor-pkFYVoW0.js";import"./quill-Bb0ovXu7.js";import"./app-Bsz95oYN.js";/* empty css            */const _e={class:"space-y-4 py-6"},Se={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ce={key:0,class:"mt-1 text-xs text-destructive"},Ee={key:0,class:"mt-1 text-xs text-destructive"},Te={class:"flex gap-2"},Ve={key:0,class:"mt-1 text-xs text-destructive"},ze={key:0,class:"mt-1 text-xs text-destructive"},Le={class:"relative"},Re={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Ue=["onMousedown"],Me={key:0,class:"mt-1 text-xs text-destructive"},Ae={class:"relative"},De={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Fe=["onMousedown"],Oe={class:"flex flex-col"},je={key:0,class:"text-xs text-muted-foreground"},Pe={key:0,class:"mt-1 text-xs text-destructive"},$e={key:0,class:"mt-1 text-xs text-destructive"},Be={key:0,class:"mt-1 text-xs text-destructive"},Ne={class:"mt-1 flex items-center justify-between"},Ie={key:0,class:"text-xs text-destructive"},Ke={class:"text-xs text-muted-foreground"},Ge={class:"flex items-center"},Ye={class:"flex cursor-pointer items-center gap-2"},qe={class:"flex justify-end gap-2 pt-2"},He=["disabled"],We={key:0,class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},rt=Object.assign({name:"WriteUpdateForm"},{__name:"WriteUpdateForm",setup(Je){const F=c(null),O=c(null),j=c(null),P=c(null),$=c(null),B=c(null),N=c(null),{props:I}=me(),ee=o=>{const e=[],a=new Set,s=f=>{!f||!Array.isArray(f)||f.forEach(u=>{u&&u.id&&!a.has(u.id)&&(a.add(u.id),e.push(u),u.children&&Array.isArray(u.children)&&u.children.length>0&&s(u.children))})};return s(o),e},te=c(I.categories||[]),x=D(()=>ee(te.value)),v=c(I.write),_=c(""),S=c(!1),K=c(null),E=[{value:"published",label:"Herkese Açık"},{value:"private",label:"Gizli"},{value:"link_only",label:"Sadece Link"}],w=c(""),C=c(!1),G=c(null),Y=D(()=>{if(!w.value)return E;const o=E.find(a=>a.value===t.status);if(o&&w.value===o.label)return E;const e=w.value.toLowerCase();return E.filter(a=>a.label.toLowerCase().includes(e))}),t=be({title:v.value.title||"",slug:v.value.slug||"",content:v.value.content||"",published_at:v.value.published_at||"",summary:v.value.summary||"",status:v.value.status||"published",category_id:v.value.category_id||"",seo_keywords:v.value.seo_keywords||"",meta_description:v.value.meta_description||"",tags:v.value.tags||"",views_count:v.value.views_count||0,hasDraw:v.value.hasDraw||!1}),i=c({title:"",slug:"",content:"",published_at:"",summary:"",status:"",category_id:"",seo_keywords:"",meta_description:"",tags:""}),m=c({date:"",time:""}),R=o=>{if(!o||!x.value||x.value.length===0)return"";const e=f=>x.value.find(u=>u.id===f),a=(f,u=[])=>{const y=e(f);return y?(u.unshift(y.name),y.parent_id?a(y.parent_id,u):u):u},s=a(o);return s.length>1?s.slice(0,-1).join(" > "):""},U=o=>{if(!o||!x.value||x.value.length===0)return"";const e=f=>x.value.find(u=>u.id===f),a=(f,u=[])=>{const y=e(f);return y?(u.unshift(y.name),y.parent_id?a(y.parent_id,u):u):u};return a(o).join(" > ")},V=D(()=>{if(!x.value||x.value.length===0)return[];if(!_.value){const s=[],f=new Set;return x.value.forEach(u=>{u&&u.id&&!f.has(u.id)&&(f.add(u.id),s.push(u))}),s}const o=_.value.toLowerCase(),e=[],a=new Set;return x.value.forEach(s=>{if(!s||!s.name||a.has(s.id))return;const f=s.name.toLowerCase().includes(o),y=R(s.id).toLowerCase().includes(o),ve=U(s.id).toLowerCase().includes(o);(f||y||ve)&&(a.add(s.id),e.push(s))}),e}),se=()=>{_.value.length>=1&&(S.value=!0)},re=()=>{clearTimeout(K.value),V.value.length>0&&(S.value=!0)},oe=()=>{K.value=setTimeout(()=>{S.value=!1},100)},le=o=>{if(!o||!o.id)return;t.category_id=o.id;const e=U(o.id);_.value=e,L(()=>{S.value=!1})},ie=()=>{_.value="",t.category_id="",S.value=!1},ue=()=>{w.value.length>=1&&(C.value=!0)},ae=()=>{clearTimeout(G.value),C.value=!0},ne=()=>{G.value=setTimeout(()=>{C.value=!1},100)},de=o=>{!o||!o.value||(t.status=o.value,w.value=o.label,L(()=>{C.value=!1}))},ce=()=>{w.value="",t.status="",C.value=!1},M=c(!0);J(()=>{if(t.published_at){const e=new Date(t.published_at);isNaN(e.getTime())||(m.value.date=e.toISOString().split("T")[0],m.value.time=e.toTimeString().substring(0,5))}if(t.category_id){const e=x.value.find(a=>a.id===t.category_id);if(e){const a=U(e.id);_.value=a}}const o=E.find(e=>e.value===t.status);o&&(w.value=o.label),t.slug&&t.slug!==""&&(A.value=!0),document.addEventListener("keydown",e=>{e.key==="Escape"&&(S.value=!1,C.value=!1)}),L(()=>{setTimeout(()=>{M.value=!1},100)})}),T(m.value,()=>{M.value||m.value.date&&m.value.time&&(t.published_at=`${m.value.date}T${m.value.time}:00`)},{deep:!0});const q=()=>{L(()=>{var a;const e=[{ref:F,error:i.value.title||t.errors.title},{ref:O,error:i.value.slug||t.errors.slug},{ref:$,error:i.value.content||t.errors.content},{ref:N,error:i.value.category_id||t.errors.category_id},{ref:j,error:i.value.published_at||t.errors.published_at},{ref:P,error:i.value.summary||t.errors.summary},{ref:B,error:i.value.status||t.errors.status}].find(s=>s.error);if(e&&((a=e.ref)!=null&&a.value)){e.ref.value.scrollIntoView({behavior:"smooth",block:"center"});const s=e.ref.value.querySelector("input, textarea");s&&setTimeout(()=>s.focus(),300)}})},fe=()=>{Object.keys(i.value).forEach(e=>{i.value[e]=""});let o=!1;return(!t.title||t.title.trim()==="")&&(i.value.title="Başlık zorunludur.",o=!0),(!t.slug||t.slug.trim()==="")&&(i.value.slug="Slug zorunludur.",o=!0),(!t.content||t.content.trim()===""||t.content==="<p><br></p>")&&(i.value.content="İçerik zorunludur.",o=!0),t.category_id||(i.value.category_id="Kategori seçilmelidir.",o=!0),m.value.date&&m.value.time?t.published_at=`${m.value.date}T${m.value.time}:00`:t.published_at=null,o&&q(),!o},H=`write_edit_form_${v.value.id||v.value.slug||"unknown"}`;T(t,o=>{M.value||localStorage.setItem(H,JSON.stringify(o))},{deep:!0}),T(()=>t.processing,o=>{window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:o}}))});let z=null;J(()=>{t.processing=!1,window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:!1}})),z=()=>{W()},window.addEventListener("sidebarFormSubmit",z)}),pe(()=>{z&&window.removeEventListener("sidebarFormSubmit",z)});const W=()=>{fe()&&t.put(route("writes.update",{write:v.value.slug}),{onSuccess:()=>{localStorage.removeItem(H),we.visit(route("writes.show",{write:t.slug}))},onError:o=>{o&&(Object.keys(o).forEach(e=>{i.value.hasOwnProperty(e)&&(i.value[e]=o[e])}),q())}})};let A=c(!1);return T(()=>t.title,o=>{!A.value&&o&&(t.slug=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").trim())}),T(()=>t.slug,(o,e)=>{e!==void 0&&o!==e&&e!==""&&(A.value=!0)}),(o,e)=>{var a;return d(),n("div",_e,[l("form",{onSubmit:he(W,["prevent"]),class:"space-y-4"},[l("div",Se,[l("div",{class:"md:col-span-2",ref_key:"titleRef",ref:F},[e[15]||(e[15]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Başlık",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r(t).title=s),placeholder:"Yazının başlığını girin",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.title||r(t).errors.title}])},null,2),[[h,r(t).title]]),i.value.title||r(t).errors.title?(d(),n("p",Ce,p(i.value.title||r(t).errors.title),1)):b("",!0)],512),l("div",{ref_key:"slugRef",ref:O},[e[16]||(e[16]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Slug",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>r(t).slug=s),placeholder:"örnek-yazı-slug",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.slug||r(t).errors.slug}])},null,2),[[h,r(t).slug]]),i.value.slug||r(t).errors.slug?(d(),n("p",Ee,p(i.value.slug||r(t).errors.slug),1)):b("",!0)],512),l("div",{ref_key:"publishedAtRef",ref:j},[e[17]||(e[17]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Yayınlama Tarihi",-1)),l("div",Te,[g(l("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>m.value.date=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||r(t).errors.published_at}])},null,2),[[h,m.value.date]]),g(l("input",{type:"time","onUpdate:modelValue":e[3]||(e[3]=s=>m.value.time=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||r(t).errors.published_at}])},null,2),[[h,m.value.time]])]),i.value.published_at||r(t).errors.published_at?(d(),n("p",Ve,p(i.value.published_at||r(t).errors.published_at),1)):b("",!0)],512),l("div",{class:"md:col-span-2",ref_key:"summaryRef",ref:P},[e[18]||(e[18]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Özet",-1)),g(l("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(t).summary=s),rows:"2",placeholder:"Yazının kısa özeti",class:k(["flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.summary||r(t).errors.summary}])},null,2),[[h,r(t).summary]]),i.value.summary||r(t).errors.summary?(d(),n("p",ze,p(i.value.summary||r(t).errors.summary),1)):b("",!0)],512),l("div",{class:"md:col-span-2",ref_key:"contentRef",ref:$},[ge(ke,{modelValue:r(t).content,"onUpdate:modelValue":e[5]||(e[5]=s=>r(t).content=s),label:"İçerik",error:i.value.content||r(t).errors.content,placeholder:"İçeriği buraya yazın...",height:"400px"},null,8,["modelValue","error"])],512),l("div",{ref_key:"statusRef",ref:B},[e[19]||(e[19]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Durumu",-1)),l("div",Le,[g(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>w.value=s),onFocus:ae,onBlur:ne,onInput:ue,onKeydown:e[7]||(e[7]=Q(s=>C.value=!1,["esc"])),placeholder:"Durum seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.status||r(t).errors.status}]),tabindex:"0"},null,34),[[h,w.value]]),w.value?(d(),n("button",{key:0,onClick:ce,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):b("",!0),C.value&&Y.value.length>0?(d(),n("ul",Re,[(d(!0),n(X,null,Z(Y.value,s=>(d(),n("li",{key:s.value,onMousedown:f=>de(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},p(s.label),41,Ue))),128))])):b("",!0)]),i.value.status||r(t).errors.status?(d(),n("p",Me,p(i.value.status||r(t).errors.status),1)):b("",!0)],512),l("div",{ref_key:"categoryRef",ref:N},[e[20]||(e[20]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Kategori",-1)),l("div",Ae,[g(l("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>_.value=s),onFocus:re,onBlur:oe,onInput:se,onKeydown:e[9]||(e[9]=Q(s=>S.value=!1,["esc"])),placeholder:"Kategori seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.category_id||r(t).errors.category_id}]),tabindex:"0"},null,34),[[h,_.value]]),_.value?(d(),n("button",{key:0,onClick:ie,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):b("",!0),S.value&&V.value&&V.value.length>0?(d(),n("ul",De,[(d(!0),n(X,null,Z(V.value,s=>(d(),n("li",{key:s.id,onMousedown:f=>le(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},[l("div",Oe,[l("span",null,p(s.name),1),R(s.id)?(d(),n("span",je,p(R(s.id)),1)):b("",!0)])],40,Fe))),128))])):b("",!0)]),i.value.category_id||r(t).errors.category_id?(d(),n("p",Pe,p(i.value.category_id||r(t).errors.category_id),1)):b("",!0)],512),l("div",null,[e[21]||(e[21]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Etiketler",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=s=>r(t).tags=s),placeholder:"etiket1, etiket2, etiket3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.tags||r(t).errors.tags}])},null,2),[[h,r(t).tags]]),i.value.tags||r(t).errors.tags?(d(),n("p",$e,p(i.value.tags||r(t).errors.tags),1)):b("",!0)]),l("div",null,[e[22]||(e[22]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Anahtar Kelimeleri",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[11]||(e[11]=s=>r(t).seo_keywords=s),placeholder:"anahtar1, anahtar2, anahtar3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.seo_keywords||r(t).errors.seo_keywords}])},null,2),[[h,r(t).seo_keywords]]),i.value.seo_keywords||r(t).errors.seo_keywords?(d(),n("p",Be,p(i.value.seo_keywords||r(t).errors.seo_keywords),1)):b("",!0)]),l("div",null,[e[23]||(e[23]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Meta Açıklaması",-1)),g(l("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>r(t).meta_description=s),placeholder:"Arama motorları için kısa bir açıklama (max 160 karakter)",class:k(["flex min-h-[60px] w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.meta_description||r(t).errors.meta_description}]),maxlength:"160",rows:"2"},null,2),[[h,r(t).meta_description]]),l("div",Ne,[i.value.meta_description||r(t).errors.meta_description?(d(),n("p",Ie,p(i.value.meta_description||r(t).errors.meta_description),1)):b("",!0),l("span",Ke,p(((a=r(t).meta_description)==null?void 0:a.length)||0)+"/160",1)])]),l("div",null,[e[24]||(e[24]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Görüntülenme Sayısı",-1)),g(l("input",{type:"number","onUpdate:modelValue":e[13]||(e[13]=s=>r(t).views_count=s),class:"flex h-9 w-full rounded border border-input bg-muted px-3 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50",readonly:""},null,512),[[h,r(t).views_count]])]),l("div",Ge,[l("label",Ye,[g(l("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>r(t).hasDraw=s),class:"h-4 w-4 rounded border-input text-primary"},null,512),[[xe,r(t).hasDraw]]),e[25]||(e[25]=l("span",{class:"text-xs text-foreground"},"Çizim İçerir",-1))])])]),l("div",qe,[l("button",{type:"submit",class:"inline-flex h-9 items-center justify-center rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:r(t).processing},[r(t).processing?(d(),n("svg",We,[...e[26]||(e[26]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):b("",!0),ye(" "+p(r(t).processing?"Güncelleniyor...":"Güncelle"),1)],8,He)])],32)])}}});export{rt as default};
