import{Q as de,p as b,r as h,m as ve,y as fe,c as l,o as i,a as s,t as c,F as _,g as L,h as C,n as A,f as M,S as ge,U as me,N as be,I as G}from"./ssr-CelVhnxm.js";import{g as w}from"./index-D3jsOSc0.js";import{_ as he}from"./app-DqonJLi-.js";/* empty css            */const f=I=>(ge("data-v-8c3e0a90"),I=I(),me(),I),xe={class:"flex flex-col items-center justify-center"},pe={key:0,class:"w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6"},_e={class:"mb-4 text-center"},we=f(()=>s("h2",{class:"mb-2 text-xl font-semibold text-base-content"},"Test Tamamlandı",-1)),ye={class:"inline-flex items-center gap-2 rounded bg-base-200 px-3 py-1"},ke=f(()=>s("span",{class:"text-base-content/70 text-sm"},"Puan:",-1)),Le={class:"text-lg font-bold text-base-content"},Ie={class:"mb-4 grid grid-cols-2 gap-4"},Ce={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},Ae={class:"mb-1"},Pe={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100"},Se={class:"text-sm font-bold text-green-600"},Qe=f(()=>s("p",{class:"text-base-content/70 text-xs"},"Doğru",-1)),je={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},Me={class:"mb-1"},Ue={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100"},ze={class:"text-sm font-bold text-red-600"},He=f(()=>s("p",{class:"text-base-content/70 text-xs"},"Yanlış",-1)),Be={class:"mb-4 text-center"},Te={class:"inline-flex items-center gap-2 rounded bg-base-200 px-3 py-1"},Re=f(()=>s("span",{class:"text-base-content/70 text-sm"},"Toplam Puan:",-1)),De={class:"text-lg font-bold text-base-content"},Ee={class:"mb-4"},qe=f(()=>s("h3",{class:"mb-2 text-sm font-medium text-base-content"},"Cevaplarınız",-1)),We={class:"max-h-48 space-y-2 overflow-y-auto"},$e={class:"flex items-center gap-2"},Fe={class:"flex flex-col"},Ge={class:"text-sm font-medium text-base-content"},Ke={class:"text-base-content/70 text-xs"},Ne={key:0,class:"text-base-content/70 text-xs"},Ve={class:"space-y-2"},Oe=["disabled"],Ye={class:"flex gap-2"},Ze={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-base-200"},Je={class:"text-base-content/70 mb-4 flex items-center justify-between text-sm"},Xe={class:"flex flex-col items-end gap-1"},et={class:"flex items-center gap-2"},tt={class:"font-medium text-base-content"},st=f(()=>s("span",null,"toplam puan",-1)),nt={class:"flex items-center gap-2 text-xs"},ot={class:"text-base-content/70 font-medium"},rt=f(()=>s("span",null,"mevcut soru puanı",-1)),at={class:"mb-2 text-2xl font-semibold text-base-content"},lt=f(()=>s("p",{class:"text-base-content/70 mb-3"},"Bu kelimenin İngilizce anlamını yazın",-1)),it={class:"flex items-center justify-between"},ct={class:"inline-flex items-center rounded border border-base-300 bg-base-200 px-2 py-1 text-xs text-base-content"},ut={class:"space-y-2"},dt={key:1,class:"text-base-content/70 text-center"},vt=f(()=>s("p",null,"Harf kutuları yükleniyor...",-1)),ft=[vt],gt={key:2,class:"flex justify-center space-x-2"},mt=["disabled"],bt={key:1,class:"mt-4"},ht={class:"flex flex-col gap-1 rounded border border-base-300 bg-base-200 p-2"},xt={class:"flex gap-1"},pt=["onClick"],_t={class:"flex gap-1"},wt=["onClick"],yt={class:"flex gap-1"},kt=["onClick"],Lt=f(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{d:"M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12zm-1-5a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1zm0-4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"})],-1)),It=f(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),Ct={__name:"WordCompletion",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(I,{emit:K}){const d=I,U=K,z=de(),N=z.props.languagePacks||[],H=b(()=>{var t;return!!((t=z.props.auth)!=null&&t.user)});b(()=>d.packSlug?N.find(t=>t.slug===d.packSlug):null);const e=h({isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0,correctAnswer:"",totalPoints:0,displayPoints:0,hintsUsed:0,hintLetterIndices:[],isHintAnimating:!1}),x=h([]),B=b(()=>Object.fromEntries(x.value.map(t=>[t.id,t]))),S=b(()=>e.value.selectedLetters.every(t=>t!=="")),y=h(!1),P=h(!1),T=()=>{P.value=!P.value},V=()=>{const t=[...e.value.selectedLetters].reverse().findIndex((r,n)=>{const o=e.value.selectedLetters.length-1-n;return r&&!e.value.hintLetterIndices.includes(o)});if(t!==-1){const r=e.value.selectedLetters.length-1-t;e.value.selectedLetters[r]=""}},O=()=>{if(e.value.showAnswer||e.value.isHintAnimating)return;const t=q(e.value.currentQuestion.word.length);if(e.value.hintsUsed>=t){console.log("Maksimum ipucu sayısına ulaşıldı");return}const r=e.value.maskedIndices.filter((n,o)=>!e.value.selectedLetters[o]);if(r.length>0){const n=r[Math.floor(Math.random()*r.length)],o=e.value.currentQuestion.word[n].toLowerCase();e.value.isHintAnimating=!0;const a=p.value.children[n],u="abcdefghijklmnopqrstuvwxyz".split("");let g=50,v=0;const m=20,k=setInterval(()=>{a.textContent=u[Math.floor(Math.random()*u.length)],v>m*.7&&(g+=10),v++,v>=m&&(clearInterval(k),a.textContent=o,e.value.selectedLetters[n]=o,e.value.hintsUsed++,e.value.hintLetterIndices.push(n),w.to(a,{scale:1.1,duration:.2,yoyo:!0,repeat:1,onComplete:()=>{e.value.isHintAnimating=!1}}))},g)}},R=()=>{if(!d.words||d.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let t=[...d.words];if(d.gameConfig.wordType&&d.gameConfig.wordType!==""&&(t=t.filter(n=>n.type===d.gameConfig.wordType)),d.gameConfig.learningStatus&&d.gameConfig.learningStatus!==""&&(t=t.filter(n=>n.learning_status===parseInt(d.gameConfig.learningStatus))),d.gameConfig.difficultyLevel&&d.gameConfig.difficultyLevel!==""&&(t=t.filter(n=>n.difficulty_level===d.gameConfig.difficultyLevel)),d.gameConfig.prioritizeUnlearned){const n=t.filter(u=>u.learning_status===0),o=t.filter(u=>u.learning_status===1),a=t.filter(u=>u.learning_status===2);t=[...n,...o,...a]}d.gameConfig.prioritizeRecentlyLearned&&t.sort((n,o)=>{const a=new Date(n.last_reviewed_at||0);return new Date(o.last_reviewed_at||0)-a}),d.gameConfig.prioritizeFlagged&&t.sort((n,o)=>n.is_flagged&&!o.is_flagged?-1:!n.is_flagged&&o.is_flagged?1:0),d.gameConfig.prioritizeMostIncorrect&&t.sort((n,o)=>{const a=n.incorrect_count||0;return(o.incorrect_count||0)-a}),t=t.sort(()=>Math.random()-.5);const r=Math.min(d.gameConfig.questionCount||10,t.length);if(t=t.slice(0,r),t.length===0){alert("Filtreleme sonucu hiç kelime kalmadı. Lütfen filtreleri kontrol edin.");return}x.value=t,e.value.totalQuestions=x.value.length,e.value.currentIndex=0,e.value.userResponses=[],e.value.isLoading=!1,e.value.isPlaying=!0,D()},Y=b(()=>{if(!e.value.userResponses.length)return 0;const t=e.value.userResponses.filter(r=>r.correct).length;return Math.round(t/e.value.userResponses.length*100)}),Z=b(()=>{if(!e.value.currentQuestion)return 0;const r=e.value.currentQuestion.word.length*100,n=e.value.hintsUsed*100;return r-n}),J=()=>"abcçdefgğhıijklmnoöprsştuüvwxyz".split(""),X=b(()=>e.value.userResponses.filter(t=>t.correct).length),ee=b(()=>e.value.userResponses.filter(t=>!t.correct).length),D=()=>{if(e.value.currentIndex>=x.value.length){le();return}if(!x.value[e.value.currentIndex])return;const r=x.value[e.value.currentIndex].word.length;e.value.currentQuestion=x.value[e.value.currentIndex],e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,e.value.hintsUsed=0,e.value.hintLetterIndices=[],e.value.isHintAnimating=!1,e.value.progress=0,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0&&(e.value.hintShown=!0,e.value.currentHintIndex=0),e.value.selectedLetters=Array(r).fill(""),e.value.maskedIndices=Array.from({length:r},(n,o)=>o),G(()=>{if(p.value&&p.value.children){const n=p.value.children;w.fromTo(n,{y:-50,opacity:0,scale:.8},{y:0,opacity:1,scale:1,duration:.5,stagger:.05,ease:"back.out(1.7)"})}})},E=h(null),te=h(null),se=h(null),p=h(null),ne=t=>{const r=e.value.selectedLetters.findIndex(o=>!o);if(r===-1)return;const n=p.value.children[r];w.from(n,{scale:1.2,duration:.2,ease:"power2.out"})},Q=t=>{if(e.value.showAnswer)return;const r=e.value.selectedLetters.findIndex(n=>!n);r!==-1&&(e.value.selectedLetters[r]=t.toLowerCase(),ne())},oe=()=>e.value.selectedLetters.findIndex(t=>!t),q=t=>t<=3?1:t<=4?2:t<=5?3:4,re=t=>{switch(t){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},W=t=>{if(e.value.showAnswer)return;const r=t.key.toLowerCase(),n=J();if(t.key==="Shift"){if(console.log("Shift tuşuna basıldı:",{selectedLetters:e.value.selectedLetters,hintLetterIndices:e.value.hintLetterIndices}),e.value.isHintAnimating)return;const o=q(e.value.currentQuestion.word.length);if(e.value.hintsUsed>=o){console.log("Maksimum ipucu sayısına ulaşıldı");return}const a=e.value.maskedIndices.filter((u,g)=>!e.value.selectedLetters[g]);if(a.length>0){const u=a[Math.floor(Math.random()*a.length)],g=e.value.currentQuestion.word[u].toLowerCase();e.value.isHintAnimating=!0;const v=p.value.children[u],m="abcdefghijklmnopqrstuvwxyz".split("");let k=50,j=0;const F=20,ue=setInterval(()=>{v.textContent=m[Math.floor(Math.random()*m.length)],j>F*.7&&(k+=10),j++,j>=F&&(clearInterval(ue),v.textContent=g,e.value.selectedLetters[u]=g,e.value.hintsUsed++,e.value.hintLetterIndices.push(u),w.to(v,{scale:1.1,duration:.2,yoyo:!0,repeat:1,onComplete:()=>{e.value.isHintAnimating=!1}}))},k)}}else if(n.includes(r)||r===" "){const o=e.value.selectedLetters.findIndex(a=>!a);o!==-1&&(e.value.selectedLetters[o]=r)}else if(t.key==="Backspace"){const o=[...e.value.selectedLetters].reverse().findIndex((a,u)=>{const g=e.value.selectedLetters.length-1-u;return a&&!e.value.hintLetterIndices.includes(g)});if(o!==-1){const a=e.value.selectedLetters.length-1-o;e.value.selectedLetters[a]=""}}else t.key==="Enter"&&S.value&&$()},$=()=>{if(e.value.showAnswer||!S.value)return;console.log("Cevap kontrolü öncesi:",{selectedLetters:e.value.selectedLetters,hintLetterIndices:e.value.hintLetterIndices});const t=e.value.currentQuestion.word.toLowerCase();let r=!0,n="";for(let v=0;v<e.value.maskedIndices.length;v++){const m=t[e.value.maskedIndices[v]],k=e.value.selectedLetters[v].toLowerCase();m!==k&&(r=!1),n+=m}console.log("Cevap kontrolü sonrası:",{isCorrect:r,correctAnswer:n,selectedLetters:e.value.selectedLetters,hintLetterIndices:e.value.hintLetterIndices}),e.value.isCorrect=r,e.value.correctAnswer=n;let o=0;r&&(o=t.length*100,o-=e.value.hintsUsed*100);const a=e.value.totalPoints,u=a+o;e.value.displayPoints=a,setTimeout(()=>{ae(a,u)},500),e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:r,points:o,hintsUsed:e.value.hintsUsed}),e.value.showAnswer=!0;const g=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);w.to(E.value,{width:`${g}%`,duration:.5,ease:"power2.out"}),setTimeout(()=>{e.value.currentIndex++,D()},2e3)},ae=(t,r)=>{w.to(e.value,{displayPoints:r,duration:1,ease:"power2.out",onUpdate:()=>{e.value.totalPoints=Math.round(e.value.displayPoints)}})},le=()=>{console.log("Oyun bitti, özet ekranı gösteriliyor"),e.value.isPlaying=!1,G(()=>{const t=document.querySelector(".game-summary");t&&w.fromTo(t,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"})})},ie=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0,correctAnswer:"",totalPoints:0,displayPoints:0,hintsUsed:0,hintLetterIndices:[],isHintAnimating:!1},R()},ce=()=>{if(!H.value||!e.value.userResponses.length||y.value)return;y.value=!0;const t=e.value.userResponses.map(r=>({word_id:r.word_id,review_count:1,incorrect_count:r.correct?0:1}));be.post("/update-words",{words:t},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),y.value=!1,setTimeout(()=>{U("game-completed")},1e3)},onError:r=>{console.error("İstatistik güncelleme hatası:",r),y.value=!1}})};return ve(()=>{R(),window.addEventListener("keydown",W)}),fe(()=>{window.removeEventListener("keydown",W)}),(t,r)=>(i(),l("div",xe,[!e.value.isPlaying&&e.value.userResponses.length>0?(i(),l("div",pe,[s("div",_e,[we,s("div",ye,[ke,s("span",Le,c(Y.value)+" / 100",1)])]),s("div",Ie,[s("div",Ce,[s("div",Ae,[s("div",Pe,[s("span",Se,c(X.value),1)])]),Qe]),s("div",je,[s("div",Me,[s("div",Ue,[s("span",ze,c(ee.value),1)])]),He])]),s("div",Be,[s("div",Te,[Re,s("span",De,c(e.value.totalPoints),1)])]),s("div",Ee,[qe,s("div",We,[(i(!0),l(_,null,L(e.value.userResponses,n=>{var o,a;return i(),l("div",{key:n.word_id,class:"flex items-center justify-between rounded border border-base-300 bg-base-200 p-2"},[s("div",$e,[s("div",{class:A(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",n.correct?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},c(n.correct?"✓":"✗"),3),s("div",Fe,[s("span",Ge,c(((o=B.value[n.word_id])==null?void 0:o.word)||"Unknown"),1),s("span",Ke,c(((a=B.value[n.word_id])==null?void 0:a.meaning)||""),1),n.correct?(i(),l("span",Ne,c(n.points)+" puan "+c(n.hintsUsed>0?`(${n.hintsUsed} ipucu)`:""),1)):C("",!0)])]),s("span",{class:A(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",n.correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},c(n.correct?"Doğru":"Yanlış"),3)])}),128))])]),s("div",Ve,[H.value?(i(),l("button",{key:0,onClick:ce,class:"w-full rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content",disabled:y.value},c(y.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,Oe)):C("",!0),s("div",Ye,[s("button",{onClick:r[0]||(r[0]=n=>U("game-completed")),class:"flex-1 rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content"}," Pakete Dön "),s("button",{onClick:ie,class:"flex-1 rounded border border-base-300 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"}," Tekrar Başla ")])])])):(i(),l("div",{key:1,class:A(["relative w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6 transition-colors duration-500",{"bg-base-100":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[s("div",Ze,[s("div",{ref_key:"progressBar",ref:E,class:"h-full w-0 bg-base-content"},null,512),s("div",{ref_key:"progressBarGlow",ref:te,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),s("div",Je,[s("div",null,"Soru "+c(e.value.currentIndex+1)+" / "+c(e.value.totalQuestions),1),s("div",Xe,[s("div",et,[s("span",tt,c(e.value.totalPoints),1),st]),s("div",nt,[s("span",ot,c(Z.value),1),rt])])]),e.value.currentQuestion?(i(),l("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:se},[s("div",null,[s("h2",at,'"'+c(e.value.currentQuestion.meaning)+'"',1),lt,s("div",it,[s("span",ct,c(re(e.value.currentQuestion.type)),1)])]),s("div",ut,[e.value.currentQuestion&&e.value.currentQuestion.word?(i(),l("div",{key:0,class:"flex justify-center space-x-2",ref_key:"selectedLettersContainer",ref:p},[(i(!0),l(_,null,L(e.value.currentQuestion.word.split(""),(n,o)=>(i(),l("div",{key:`${e.value.currentIndex}-${o}`,class:A(["flex h-12 w-12 items-center justify-center rounded border text-xl font-semibold transition-all",{"border-base-300 bg-base-100":!e.value.selectedLetters[o],"border-base-content bg-base-200":!e.value.selectedLetters[o]&&o===oe(),"border-green-500 bg-green-50":e.value.showAnswer&&e.value.isCorrect,"border-red-500 bg-red-50":e.value.showAnswer&&!e.value.isCorrect,"border-blue-500":e.value.hintLetterIndices.includes(o)&&!e.value.isHintAnimating}])},[e.value.maskedIndices.includes(o)?(i(),l("span",{key:0,class:A({"text-blue-600":e.value.hintLetterIndices.includes(o)})},c(e.value.selectedLetters[o]||""),3)):(i(),l(_,{key:1},[M(c(n.toLowerCase()),1)],64))],2))),128))],512)):(i(),l("div",dt,ft)),e.value.showAnswer&&!e.value.isCorrect?(i(),l("div",gt,[(i(!0),l(_,null,L(e.value.currentQuestion.word.split(""),(n,o)=>(i(),l("div",{key:o,class:"flex h-8 w-8 items-center justify-center rounded border border-green-500 bg-green-50 text-sm font-medium text-green-700"},c(n.toLowerCase()),1))),128))])):C("",!0)]),s("button",{onClick:$,disabled:e.value.showAnswer||!S.value,class:"w-full rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content disabled:opacity-50"}," Kontrol Et ",8,mt)],512)):C("",!0),P.value?(i(),l("div",bt,[s("div",ht,[s("div",xt,[(i(),l(_,null,L(["q","w","e","r","t","y","u","ı","o","p","ğ","ü"],n=>s("button",{key:n,onClick:o=>Q(n),class:"flex h-10 w-10 items-center justify-center rounded bg-base-100 text-sm font-medium text-base-content transition hover:bg-base-300 active:bg-base-content active:text-base-100"},c(n),9,pt)),64))]),s("div",_t,[(i(),l(_,null,L(["a","s","d","f","g","h","j","k","l","ş","i"],n=>s("button",{key:n,onClick:o=>Q(n),class:"flex h-10 w-10 items-center justify-center rounded bg-base-100 text-sm font-medium text-base-content transition hover:bg-base-300 active:bg-base-content active:text-base-100"},c(n),9,wt)),64))]),s("div",yt,[(i(),l(_,null,L(["z","x","c","v","b","n","m","ö","ç"],n=>s("button",{key:n,onClick:o=>Q(n),class:"flex h-10 w-10 items-center justify-center rounded bg-base-100 text-sm font-medium text-base-content transition hover:bg-base-300 active:bg-base-content active:text-base-100"},c(n),9,kt)),64))]),s("div",{class:"flex gap-1"},[s("button",{onClick:V,class:"flex h-10 flex-1 items-center justify-center rounded bg-base-100 text-sm font-medium text-base-content transition hover:bg-base-300 active:bg-base-content active:text-base-100"}," ← "),s("button",{onClick:O,class:"flex h-10 flex-1 items-center justify-center rounded bg-base-content text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content"}," İpucu ")])])])):C("",!0),P.value?(i(),l("button",{key:3,onClick:T,class:"mt-4 flex w-full items-center justify-center gap-2 rounded border border-base-300 bg-base-100 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"},[It,M(" Klavyeyi Kapat ")])):(i(),l("button",{key:2,onClick:T,class:"mt-4 flex w-full items-center justify-center gap-2 rounded border border-base-300 bg-base-100 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"},[Lt,M(" Klavyeyi Aç ")]))],2))]))}},jt=he(Ct,[["__scopeId","data-v-8c3e0a90"]]);export{jt as default};
