import{Q as q,p,r as b,m as K,c as i,a as t,t as a,F as B,g as D,h as g,n as f,k as $,v as J,I as X,N as Z,J as ee,o as c}from"./ssr-CAy-S3_r.js";import{g as v}from"./index-CH_iu5NA.js";import{_ as te}from"./app-CfiUSdJ9.js";/* empty css            */const se={class:"flex flex-col items-center justify-center"},ne={key:0,class:"w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6"},re={class:"mb-4 text-center"},oe={class:"inline-flex items-center gap-2 rounded bg-base-200 px-3 py-1"},ae={class:"text-lg font-bold text-base-content"},le={class:"mb-4 grid grid-cols-2 gap-4"},ue={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},ie={class:"mb-1"},ce={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100"},de={class:"text-sm font-bold text-green-600"},ve={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},be={class:"mb-1"},me={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100"},pe={class:"text-sm font-bold text-red-600"},ge={class:"mb-4"},xe={class:"max-h-48 space-y-2 overflow-y-auto"},fe={class:"flex items-center gap-2"},he={class:"flex flex-col"},we={class:"text-sm font-medium text-base-content"},_e={class:"text-base-content/70 text-xs"},ye={class:"space-y-2"},ke=["disabled"],Ce={class:"flex gap-2"},Ie={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-base-200"},Qe={class:"text-base-content/70 mb-4 text-right text-sm"},Se={class:"mb-2 text-2xl font-semibold text-base-content"},Ae={class:"flex items-center justify-between"},Re={class:"inline-flex items-center rounded border border-base-300 bg-base-200 px-2 py-1 text-xs text-base-content"},Te={key:0,class:"rounded border border-base-300 bg-base-200 p-3"},Be={key:0,class:"mt-1 text-sm text-base-content"},De={key:1,class:"mt-1 text-sm text-base-content"},Pe={class:"space-y-4"},Me=["disabled"],He=["disabled"],je={class:"mt-1 text-base-content"},ze={key:0,class:"mt-3"},We={class:"mt-1 list-inside list-disc space-y-1 text-sm text-base-content"},Le={__name:"TranslateWord",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(P,{emit:M}){const d=P,w=M,_=q(),H=_.props.languagePacks||[],y=p(()=>{var n;return!!((n=_.props.auth)!=null&&n.user)});p(()=>d.packSlug?H.find(n=>n.slug===d.packSlug):null);const e=b({isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),x=b([]),k=p(()=>Object.fromEntries(x.value.map(n=>[n.id,n]))),C=b(null),h=b(null),I=b(null),l=b(null),m=b(!1),j=()=>{v.fromTo(I.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),v.fromTo(l.value,{opacity:0,y:10},{opacity:1,y:0,duration:.3,delay:.2,ease:"power2.out"})},z=()=>{v.timeline().to(l.value,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}).to(l.value,{scale:1,duration:.2,ease:"power2.out"});const s=50,r=["#34d399","#10b981","#059669"];for(let u=0;u<s;u++){const o=document.createElement("div");o.style.position="absolute",o.style.width="8px",o.style.height="8px",o.style.backgroundColor=r[Math.floor(Math.random()*r.length)],o.style.borderRadius="50%",document.body.appendChild(o);const R=l.value.getBoundingClientRect().left+l.value.offsetWidth/2,T=l.value.getBoundingClientRect().top;v.fromTo(o,{x:R,y:T,scale:0},{x:R+(Math.random()-.5)*200,y:T-100-Math.random()*100,scale:1,opacity:0,duration:1,ease:"power4.out",onComplete:()=>o.remove()})}},W=()=>{v.timeline().to(l.value,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(l.value,{x:-10,duration:.1}).to(l.value,{x:10,duration:.1}).to(l.value,{x:-5,duration:.1}).to(l.value,{x:5,duration:.1}).to(l.value,{x:0,scale:1,duration:.2})},L=n=>{v.to(C.value,{width:`${n}%`,duration:.5,ease:"power2.out"}),v.fromTo(h.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),v.to(h.value,{opacity:n===100?0:.5,duration:.3})},Q=async()=>{if(!d.words||d.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let n=[...d.words];if(d.gameConfig.prioritizeUnlearned){const s=n.filter(o=>o.learning_status===0),r=n.filter(o=>o.learning_status===1),u=n.filter(o=>o.learning_status===2);n=[...s,...r,...u]}d.gameConfig.prioritizeRecentlyLearned&&n.sort((s,r)=>{const u=new Date(s.last_reviewed_at||0);return new Date(r.last_reviewed_at||0)-u}),d.gameConfig.prioritizeFlagged&&n.sort((s,r)=>s.is_flagged&&!r.is_flagged?-1:!s.is_flagged&&r.is_flagged?1:0),d.gameConfig.prioritizeMostIncorrect&&n.sort((s,r)=>{const u=s.incorrect_count||0;return(r.incorrect_count||0)-u}),n=n.sort(()=>Math.random()-.5),await new Promise(s=>{x.value=n,e.value.totalQuestions=x.value.length,e.value.currentIndex=0,e.value.userResponses=[],s()}),e.value.isLoading=!1,e.value.isPlaying=!0,S()},G=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},S=()=>{if(e.value.currentIndex>=x.value.length){E();return}e.value.currentQuestion=x.value[e.value.currentIndex],e.value.userInput="",e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0&&(e.value.hintShown=!0,e.value.currentHintIndex=0),ee(()=>{j()})},A=()=>{if(!e.value.userInput.trim())return;const n=e.value.userInput.trim().toLowerCase(),r=(e.value.currentQuestion.meanings||[{meaning:e.value.currentQuestion.meaning}]).some(o=>o.meaning.toLowerCase()===n);e.value.isCorrect=r,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:e.value.isCorrect}),e.value.showAnswer=!0,e.value.isCorrect?z():W();const u=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);L(u),setTimeout(()=>{v.set(l.value,{clearProps:"all"}),l.value.style.backgroundColor="",l.value.style.borderColor="",e.value.currentIndex++,e.value.userInput="",e.value.showAnswer=!1,e.value.progress=0,S()},2e3)},N=p(()=>{if(!e.value.userResponses.length)return 0;const n=e.value.userResponses.filter(s=>s.correct).length;return Math.round(n/e.value.userResponses.length*100)}),U=n=>{switch(n){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},E=()=>{e.value.isPlaying=!1},F=()=>{if(!y.value||!e.value.userResponses.length||m.value)return;m.value=!0;const n=e.value.userResponses.map(s=>({word_id:s.word_id,review_count:1,incorrect_count:s.correct?0:1}));Z.post("/update-words",{words:n},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),m.value=!1,setTimeout(()=>{w("game-completed")},1e3)},onError:s=>{console.error("İstatistik güncelleme hatası:",s),m.value=!1}})},O=p(()=>e.value.userResponses.filter(n=>n.correct).length),V=p(()=>e.value.userResponses.filter(n=>!n.correct).length),Y=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},Q()};return K(()=>{Q()}),(n,s)=>(c(),i("div",se,[!e.value.isPlaying&&e.value.userResponses.length>0?(c(),i("div",ne,[t("div",re,[s[3]||(s[3]=t("h2",{class:"mb-2 text-xl font-semibold text-base-content"},"Test Tamamlandı",-1)),t("div",oe,[s[2]||(s[2]=t("span",{class:"text-base-content/70 text-sm"},"Puan:",-1)),t("span",ae,a(N.value)+" / 100",1)])]),t("div",le,[t("div",ue,[t("div",ie,[t("div",ce,[t("span",de,a(O.value),1)])]),s[4]||(s[4]=t("p",{class:"text-base-content/70 text-xs"},"Doğru",-1))]),t("div",ve,[t("div",be,[t("div",me,[t("span",pe,a(V.value),1)])]),s[5]||(s[5]=t("p",{class:"text-base-content/70 text-xs"},"Yanlış",-1))])]),t("div",ge,[s[6]||(s[6]=t("h3",{class:"mb-2 text-sm font-medium text-base-content"},"Cevaplarınız",-1)),t("div",xe,[(c(!0),i(B,null,D(e.value.userResponses,r=>{var u,o;return c(),i("div",{key:r.word_id,class:"flex items-center justify-between rounded border border-base-300 bg-base-200 p-2"},[t("div",fe,[t("div",{class:f(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",r.correct?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},a(r.correct?"✓":"✗"),3),t("div",he,[t("span",we,a(((u=k.value[r.word_id])==null?void 0:u.word)||"Unknown"),1),t("span",_e,a(((o=k.value[r.word_id])==null?void 0:o.meaning)||""),1)])]),t("span",{class:f(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",r.correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},a(r.correct?"Doğru":"Yanlış"),3)])}),128))])]),t("div",ye,[y.value?(c(),i("button",{key:0,onClick:F,class:"w-full rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content",disabled:m.value},a(m.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,ke)):g("",!0),t("div",Ce,[t("button",{onClick:s[0]||(s[0]=r=>w("game-completed")),class:"flex-1 rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content"}," Pakete Dön "),t("button",{onClick:Y,class:"flex-1 rounded border border-base-300 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"}," Tekrar Başla ")])])])):(c(),i("div",{key:1,class:f(["relative w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6 transition-colors duration-500",{"bg-base-100":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",Ie,[t("div",{ref_key:"progressBar",ref:C,class:"h-full w-0 bg-base-content"},null,512),t("div",{ref_key:"progressBarGlow",ref:h,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),t("div",Qe," Soru "+a(e.value.currentIndex+1)+" / "+a(e.value.totalQuestions),1),e.value.currentQuestion?(c(),i("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:I},[t("div",null,[t("h2",Se,'"'+a(e.value.currentQuestion.word)+'"',1),s[7]||(s[7]=t("p",{class:"text-base-content/70 mb-3"},"Bu kelimenin anlamı nedir?",-1)),t("div",Ae,[t("span",Re,a(U(e.value.currentQuestion.type)),1),!e.value.showAnswer&&e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>1?(c(),i("button",{key:0,onClick:G,class:"text-base-content/70 text-xs transition-colors hover:text-base-content"}," Sonraki İpucu ("+a(e.value.currentHintIndex+1)+"/"+a(e.value.currentQuestion.example_sentences.length)+") ",1)):g("",!0)])]),e.value.hintShown?(c(),i("div",Te,[s[8]||(s[8]=t("p",{class:"text-sm font-medium text-base-content"},"Örnek Cümle:",-1)),e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(c(),i("p",Be,a(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)):(c(),i("p",De,"Bu kelime için örnek cümle bulunmuyor."))])):g("",!0),t("div",Pe,[$(t("input",{ref_key:"answerInput",ref:l,"onUpdate:modelValue":s[1]||(s[1]=r=>e.value.userInput=r),type:"text",disabled:e.value.showAnswer,onKeyup:X(A,["enter"]),placeholder:"Cevabınızı yazın...",class:"w-full rounded border border-base-300 bg-base-100 p-3 text-base-content focus:border-base-content focus:outline-none focus:ring-1 focus:ring-base-content disabled:cursor-not-allowed"},null,40,Me),[[J,e.value.userInput]]),t("button",{onClick:A,disabled:!e.value.userInput.trim()||e.value.showAnswer,class:"w-full rounded border border-base-300 bg-base-content px-4 py-3 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content disabled:cursor-not-allowed disabled:opacity-50"},a(e.value.showAnswer?"Sonraki Soru":"Cevapla"),9,He)]),e.value.showAnswer?(c(),i("div",{key:1,class:f(["mt-4 rounded border border-base-300 p-4",{"bg-red-50":!e.value.isCorrect,"bg-green-50":e.value.isCorrect}])},[t("p",{class:f(["text-sm font-medium",{"text-red-600":!e.value.isCorrect,"text-green-600":e.value.isCorrect}])}," Doğru Cevap: ",2),t("p",je,a(e.value.currentQuestion.meaning),1),e.value.currentQuestion.meanings&&e.value.currentQuestion.meanings.length>1?(c(),i("div",ze,[s[9]||(s[9]=t("p",{class:"text-base-content/70 text-sm font-medium"},"Diğer Anlamlar:",-1)),t("ul",We,[(c(!0),i(B,null,D(e.value.currentQuestion.meanings,(r,u)=>(c(),i("li",{key:u},a(r.meaning),1))),128))])])):g("",!0)],2)):g("",!0)],512)):g("",!0)],2))]))}},Fe=te(Le,[["__scopeId","data-v-4b439450"]]);export{Fe as default};
