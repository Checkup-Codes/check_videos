import{Q as B,i,l as C,x as H,g as a,o as l,b as t,t as d,F as m,m as x,n as h,h as I,U as W,f as F,N as G}from"./app-qkNd7UvL.js";/* empty css            */const V={class:"flex min-h-screen flex-col items-center justify-center"},$={key:0,class:"w-full max-w-md rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"},U=t("h2",{class:"mb-2 text-2xl font-semibold text-gray-900"},"Test Özeti",-1),K={class:"mb-4 text-center"},Y={class:"text-4xl font-bold text-gray-900"},J=t("p",{class:"text-sm text-gray-600"},"Puan",-1),Z={class:"mb-4 grid grid-cols-2 gap-4 rounded-lg bg-gray-50 p-4"},q={class:"text-center"},X={class:"text-2xl font-bold text-green-600"},ee=t("p",{class:"text-sm text-gray-600"},"Doğru",-1),te={class:"text-center"},se={class:"text-2xl font-bold text-red-600"},re=t("p",{class:"text-sm text-gray-600"},"Yanlış",-1),ne={class:"mb-4 max-h-60 overflow-y-auto"},oe=t("h3",{class:"mb-2 font-medium text-gray-700"},"Cevaplarınız:",-1),ae={class:"space-y-2 text-left text-sm text-gray-800"},le={class:"flex flex-col"},de={class:"text-xs text-gray-500"},ue={class:"flex gap-2"},ce={class:"mb-4 h-1 w-full overflow-hidden rounded-full bg-gray-200"},ie={class:"mb-4 text-right text-sm text-gray-500"},ve={key:0,class:"space-y-4"},ge=t("div",{class:"flex items-center justify-between"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"Eksik harfleri tamamlayın:")],-1),me={class:"mt-1 text-sm text-gray-500"},he={class:"flex justify-center space-x-2"},we={key:0},xe={key:1},fe={key:1},pe={key:0,class:"mt-4 rounded-lg bg-yellow-50 p-4"},_e={class:"text-sm text-yellow-800"},ye={class:"font-bold"},be={class:"grid grid-cols-7 gap-2"},ke=["onClick","disabled"],Ce=["disabled"],Ie=["disabled"],Qe={__name:"WordCompletion",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(L,{emit:A}){const v=L,S=A,Q=B().props.languagePacks||[];i(()=>v.packSlug?Q.find(s=>s.slug===v.packSlug):null);const e=C({isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0}),g=C([]),f=i(()=>Object.fromEntries(g.value.map(s=>[s.id,s]))),p=i(()=>e.value.maskedIndices.length===e.value.selectedLetters.length),_=async()=>{if(!v.words||v.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let s=[...v.words];s.sort(()=>Math.random()-.5),await new Promise(r=>{g.value=s,e.value.totalQuestions=g.value.length,e.value.currentIndex=0,e.value.userResponses=[],r()}),e.value.isLoading=!1,e.value.isPlaying=!0,y()},R=i(()=>{if(!e.value.userResponses.length)return 0;const s=e.value.userResponses.filter(r=>r.correct).length;return Math.round(s/e.value.userResponses.length*100)}),M=()=>"ABCÇDEFGĞHIİJKLMNOÖPRSŞTUÜVYZ".split(""),P=i(()=>e.value.userResponses.filter(s=>s.correct).length),O=i(()=>e.value.userResponses.filter(s=>!s.correct).length),y=()=>{if(e.value.currentIndex>=g.value.length){N();return}e.value.currentQuestion=g.value[e.value.currentIndex],e.value.selectedLetters=[],e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,j()},j=()=>{const r=e.value.currentQuestion.word.length,n={1:1,2:1,3:1,4:2,5:2,6:3,7:3,8:3,9:4,10:4},o=Math.min(4,Math.floor(r/2)),u=n[r]||o,c=new Set;for(;c.size<u;){const w=Math.floor(Math.random()*r);c.add(w)}e.value.maskedIndices=Array.from(c).sort((w,T)=>w-T)},b=s=>{e.value.showAnswer||e.value.selectedLetters.length>=e.value.maskedIndices.length||(e.value.selectedLetters.push(s),e.value.selectedLetters.length===e.value.maskedIndices.length&&k())},z=()=>{e.value.showAnswer||(e.value.selectedLetters=[])},k=()=>{if(e.value.showAnswer||!p.value)return;const s=e.value.currentQuestion.word;let r=!0;for(let o=0;o<e.value.maskedIndices.length;o++){const u=s[e.value.maskedIndices[o]].toLowerCase(),c=e.value.selectedLetters[o].toLowerCase();if(u!==c){r=!1;break}}e.value.isCorrect=r,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:r}),e.value.showAnswer=!0,e.value.progress=0;const n=setInterval(()=>{e.value.progress+=1,e.value.progress>=100&&(clearInterval(n),e.value.currentIndex++,e.value.selectedLetters=[],e.value.showAnswer=!1,e.value.progress=0,y())},20)},N=()=>{e.value.isPlaying=!1,E()},D=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0},_()},E=()=>{if(!e.value.userResponses.length)return;const s=e.value.userResponses.map(r=>({word_id:r.word_id,review_count:1,incorrect_count:r.correct?0:1}));G.post("/update-words",{words:s},{preserveState:!0,onSuccess:()=>console.log("Words updated successfully"),onError:r=>console.error("Failed to update word stats",r)})};return H(()=>{_()}),(s,r)=>(l(),a("div",V,[!e.value.isPlaying&&e.value.userResponses.length>0?(l(),a("div",$,[U,t("div",K,[t("p",Y,d(R.value)+" / 100",1),J]),t("div",Z,[t("div",q,[t("p",X,d(P.value),1),ee]),t("div",te,[t("p",se,d(O.value),1),re])]),t("div",ne,[oe,t("ul",ae,[(l(!0),a(m,null,x(e.value.userResponses,n=>{var o,u;return l(),a("li",{key:n.word_id,class:"flex items-center justify-between rounded-md bg-gray-50 px-4 py-2"},[t("div",le,[t("span",{class:h(n.correct?"font-medium text-green-600":"font-medium text-red-600")},d(((o=f.value[n.word_id])==null?void 0:o.word)||"Unknown"),3),t("span",de,d(((u=f.value[n.word_id])==null?void 0:u.meaning)||""),1)]),t("span",{class:h(n.correct?"text-lg text-green-600":"text-lg text-red-600")},d(n.correct?"✓":"✗"),3)])}),128))])]),t("div",ue,[t("button",{onClick:r[0]||(r[0]=n=>S("game-completed")),class:"flex-1 rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700"}," Pakete Dön "),t("button",{onClick:D,class:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Tekrar Başla ")])])):(l(),a("div",{key:1,class:h(["relative w-full max-w-md rounded-2xl border border-gray-200 p-6 shadow-sm transition-colors duration-500",{"bg-white":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",ce,[t("div",{class:"duration-2000 h-full bg-black transition-all",style:W({width:`${e.value.progress}%`})},null,4)]),t("div",ie," Soru "+d(e.value.currentIndex+1)+" / "+d(e.value.totalQuestions),1),e.value.currentQuestion?(l(),a("div",ve,[t("div",null,[ge,t("p",me,"Anlam: "+d(e.value.currentQuestion.meaning),1)]),t("div",he,[(l(!0),a(m,null,x(e.value.currentQuestion.word,(n,o)=>{var u,c;return l(),a("div",{key:o,class:h(["flex h-12 w-12 items-center justify-center rounded-lg border-2 text-xl font-bold",{"border-gray-200 bg-gray-50":e.value.maskedIndices.includes(o),"border-gray-300 bg-white":!e.value.maskedIndices.includes(o),"text-red-600":e.value.showAnswer&&!e.value.isCorrect&&e.value.maskedIndices.includes(o)&&((u=e.value.selectedLetters[e.value.maskedIndices.indexOf(o)])==null?void 0:u.toLowerCase())!==n.toLowerCase(),"text-green-600":e.value.showAnswer&&e.value.maskedIndices.includes(o)&&((c=e.value.selectedLetters[e.value.maskedIndices.indexOf(o)])==null?void 0:c.toLowerCase())===n.toLowerCase()}])},[e.value.maskedIndices.includes(o)?(l(),a(m,{key:0},[e.value.selectedLetters[e.value.maskedIndices.indexOf(o)]?(l(),a("span",we,d(e.value.selectedLetters[e.value.maskedIndices.indexOf(o)]),1)):(l(),a("span",xe,"_"))],64)):(l(),a("span",fe,d(n),1))],2)}),128))]),e.value.showAnswer&&!e.value.isCorrect?(l(),a("div",pe,[t("p",_e,[F(" Doğru cevap: "),t("span",ye,d(e.value.currentQuestion.word),1)])])):I("",!0),t("div",be,[(l(!0),a(m,null,x(M(),n=>(l(),a("button",{key:n,onClick:o=>b(n),disabled:e.value.showAnswer||e.value.selectedLetters.includes(n),class:"h-10 w-10 rounded-lg border border-gray-200 text-center text-lg font-medium transition hover:bg-gray-50 disabled:opacity-50"},d(n),9,ke))),128)),t("button",{onClick:r[1]||(r[1]=n=>b(" ")),disabled:e.value.showAnswer||e.value.selectedLetters.includes(" "),class:"h-10 w-10 rounded-lg border border-gray-200 text-center text-lg font-medium transition hover:bg-gray-50 disabled:opacity-50"}," ␣ ",8,Ce)]),t("button",{onClick:z,class:"w-full rounded-lg border border-gray-300 px-4 py-2 text-center text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Seçilen Harfleri Temizle "),t("button",{onClick:k,disabled:e.value.showAnswer||!p.value,class:"w-full rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700 disabled:opacity-50"}," Kontrol Et ",8,Ie)])):I("",!0)],2))]))}};export{Qe as default};
