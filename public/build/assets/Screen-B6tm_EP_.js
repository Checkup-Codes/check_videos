import{Q as F,e as b,p as W,m as G,D as Q,A as P,y as U,j as J,w as C,a as t,c as l,h as c,n as w,t as f,u as d,o as r,b as R,i as N,f as B,F as j,g as M}from"./ssr-Dd8vfvSV.js";import{_ as K}from"./CheckScreen-CGJmr-Qf.js";const X={class:"space-y-4"},Y={class:"flex items-center justify-between"},Z={class:"text-3xl font-bold text-foreground"},ee={key:0,class:"flex gap-2"},te={key:0,class:"text-muted-foreground"},oe={class:"flex flex-wrap gap-4 text-sm text-muted-foreground"},se={class:"flex items-center gap-2"},ne={key:0,class:"flex items-center gap-2"},re={key:1,class:"flex items-center gap-2"},ie={key:0,class:"space-y-4"},le={class:"space-y-6"},ae=["id"],de={class:"mb-4"},ue={class:"text-sm font-medium text-muted-foreground"},ce={class:"mt-2 text-foreground"},fe={class:"space-y-2"},me={class:"text-sm font-medium text-muted-foreground"},ge={class:"text-sm text-foreground"},pe={key:0,class:"ml-auto text-xs font-medium text-green-600 dark:text-green-400"},ve={key:0,class:"mt-3 rounded-md bg-muted p-2 text-sm text-muted-foreground"},xe={class:"flex gap-4"},he={class:"flex h-full flex-col"},be={class:"space-y-1"},we=["onClick"],ke={class:"font-medium"},ye={class:"rounded-lg border border-border bg-popover shadow-lg"},_e={class:"space-y-1"},Ce=["onClick"],Be={class:"font-medium"},Te={__name:"Screen",setup(je){const{props:z}=F(),i=z.test||{},O=z.isAdmin||!1,g=b(!1),v=W(()=>i.questions&&i.questions.length>0),x=b(null),S=b(new Map),q=b(null),E=b(null),H=b(!1);let k=null,y=null,h=!1;const I=(s,e)=>{s?S.value.set(e,s):S.value.delete(e)},_=()=>{g.value=!g.value},$=s=>{if(!s)return;const e=document.getElementById(`question-${s}`);if(!e)return;const o=e.closest(".overflow-y-auto");if(!o)return;h=!0,x.value=s,Q(()=>{A()});const n=o.getBoundingClientRect(),a=e.getBoundingClientRect(),u=o.scrollTop,m=a.top-n.top+u;o.scrollTo({top:m-80,behavior:"smooth"}),setTimeout(()=>{h=!1},600),window.innerWidth<1280&&(g.value=!1)},A=()=>{if(!x.value)return;const s=S.value.get(x.value);if(!s)return;const e=window.innerWidth>=1280?E.value:q.value;if(!e)return;const o=e.getBoundingClientRect(),n=s.getBoundingClientRect(),a=n.top<o.top,u=n.bottom>o.bottom;if(a||u){e.scrollTop;const m=s.offsetTop,p=e.clientHeight,T=s.offsetHeight,D=m-p/2+T/2;e.scrollTo({top:D,behavior:"smooth"})}},V=()=>{if(!i.questions||i.questions.length===0)return;const s=i.questions.map(n=>document.getElementById(`question-${n.id}`)).filter(Boolean);if(s.length===0)return;const e=80,o=()=>{if(h)return;let n=null,a=1/0;s.forEach(u=>{if(!u)return;const m=u.getBoundingClientRect(),p=m.top-e;m.top<=e+50&&m.bottom>0&&p<=50&&Math.abs(p)<a&&(a=Math.abs(p),n=u.id.replace("question-",""))}),n||s.forEach(u=>{if(!u)return;const m=u.getBoundingClientRect();if(m.top<e+200&&m.bottom>0){const p=Math.abs(m.top-e);p<a&&(a=p,n=u.id.replace("question-",""))}}),n&&x.value!==n&&(x.value=n)};k=new IntersectionObserver(()=>{h||o()},{root:null,rootMargin:`-${e+10}px 0px -60% 0px`,threshold:[0,.1,.25,.5,.75,1]}),s.forEach(n=>{n&&k.observe(n)}),y=()=>{h||o()},window.addEventListener("scroll",y,{passive:!0}),o()},L=()=>{const s=window.innerWidth>=1280;H.value=s,s&&v.value?g.value=!0:s||(g.value=!1)};return G(()=>{L(),Q(()=>{v.value&&V()});const s=()=>{L()};window.addEventListener("resize",s)}),P(()=>{k&&(k.disconnect(),k=null),y&&(window.removeEventListener("scroll",y),y=null)}),U(x,(s,e)=>{s&&s!==e&&!h&&Q(()=>{A()})}),(s,e)=>(r(),J(K,null,{default:C(()=>[t("div",{class:w(["mx-auto max-w-4xl space-y-6 p-6 transition-all duration-300",{"xl:-translate-x-[100px]":v.value&&g.value}])},[t("div",X,[t("div",Y,[t("h1",Z,f(d(i).title),1),d(O)?(r(),l("div",ee,[R(d(N),{href:`/tests/${d(i).id}/edit`,class:"inline-flex h-9 items-center justify-center rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground hover:bg-primary/90"},{default:C(()=>[...e[0]||(e[0]=[B(" Düzenle ",-1)])]),_:1},8,["href"])])):c("",!0)]),d(i).description?(r(),l("div",te,f(d(i).description),1)):c("",!0),t("div",oe,[t("div",se,[e[1]||(e[1]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t("span",null,f(d(i).total_questions)+" soru",1)]),d(i).total_points?(r(),l("div",ne,[e[2]||(e[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),t("span",null,f(d(i).total_points)+" puan",1)])):c("",!0),d(i).time_limit?(r(),l("div",re,[e[3]||(e[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,f(d(i).time_limit)+" dakika",1)])):c("",!0)])]),d(i).questions&&d(i).questions.length>0?(r(),l("div",ie,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold text-foreground"},"Sorular",-1)),t("div",le,[(r(!0),l(j,null,M(d(i).questions,(o,n)=>(r(),l("div",{key:o.id,id:`question-${o.id}`,class:"scroll-mt-24 rounded-lg border border-border bg-card p-4"},[t("div",de,[t("span",ue,"Soru "+f(n+1),1),t("p",ce,f(o.question_text),1)]),t("div",fe,[(r(!0),l(j,null,M(o.options,(a,u)=>(r(),l("div",{key:a.id,class:w(["flex items-center gap-2 rounded-md border border-border bg-background p-2",a.is_correct?"border-green-500 bg-green-50 dark:bg-green-950":""])},[t("span",me,f(String.fromCharCode(65+u))+".",1),t("span",ge,f(a.option_text),1),a.is_correct?(r(),l("span",pe," ✓ Doğru ")):c("",!0)],2))),128))]),o.explanation?(r(),l("div",ve,[e[4]||(e[4]=t("strong",null,"Açıklama:",-1)),B(" "+f(o.explanation),1)])):c("",!0)],8,ae))),128))])])):c("",!0),t("div",xe,[R(d(N),{href:`/tests/${d(i).slug}/take`,class:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-6 text-sm font-medium text-primary-foreground hover:bg-primary/90"},{default:C(()=>[...e[6]||(e[6]=[B(" Testi Çöz ",-1)])]),_:1},8,["href"]),R(d(N),{href:"/tests",class:"inline-flex h-10 items-center justify-center rounded-md border border-input bg-background px-6 text-sm font-medium text-foreground hover:bg-accent hover:text-accent-foreground"},{default:C(()=>[...e[7]||(e[7]=[B(" Geri Dön ",-1)])]),_:1})])],2),v.value?(r(),l("button",{key:0,onClick:_,class:"fixed right-4 top-1/2 z-50 flex h-10 w-10 -translate-y-1/2 items-center justify-center rounded-full bg-primary text-primary-foreground shadow-lg transition-colors hover:bg-primary/90 xl:hidden"},[...e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-5 w-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})],-1)])])):c("",!0),v.value?(r(),l("div",{key:1,class:w(["fixed right-0 top-12 z-40 h-[calc(100vh-3rem)] w-80 transform border-l border-border bg-popover shadow-2xl transition-transform duration-300 lg:h-[calc(100vh-5.5rem)] xl:hidden",{"translate-x-full":!g.value}])},[t("div",he,[t("div",{class:"flex items-center justify-between border-b border-border p-4"},[e[10]||(e[10]=t("h3",{class:"text-lg font-semibold text-foreground"},"Sorular",-1)),t("button",{onClick:_,class:"inline-flex h-8 w-8 items-center justify-center rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"},[...e[9]||(e[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",{ref_key:"mobileQuestionNavScrollRef",ref:q,class:"flex-1 overflow-y-auto p-4"},[t("nav",be,[(r(!0),l(j,null,M(d(i).questions,(o,n)=>(r(),l("button",{key:o.id,ref_for:!0,ref:a=>I(a,o.id),onClick:a=>$(o.id),class:w(["flex w-full items-center justify-between rounded-md px-3 py-2 text-sm transition-colors",[x.value===o.id?"bg-accent font-medium text-accent-foreground":"text-muted-foreground hover:bg-accent/50 hover:text-foreground"]])},[t("span",ke,"Soru "+f(n+1),1)],10,we))),128))])],512)])],2)):c("",!0),v.value?(r(),l("button",{key:2,onClick:_,class:"fixed right-4 top-28 z-50 hidden h-10 w-10 items-center justify-center rounded-full bg-primary text-primary-foreground shadow-lg transition-colors hover:bg-primary/90 xl:flex"},[...e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-5 w-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})],-1)])])):c("",!0),v.value?(r(),l("div",{key:3,class:w(["fixed right-4 top-28 z-30 hidden w-64 transition-all duration-300 ease-in-out xl:block",g.value?"translate-x-0 opacity-100":"pointer-events-none translate-x-full opacity-0"])},[t("div",ye,[t("div",{class:"flex items-center justify-between border-b border-border p-3"},[e[13]||(e[13]=t("h3",{class:"text-sm font-semibold text-foreground"},"Sorular",-1)),t("button",{onClick:_,class:"inline-flex h-6 w-6 items-center justify-center rounded-md text-xs font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"},[...e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",{ref_key:"desktopQuestionNavScrollRef",ref:E,class:"overflow-y-auto p-3",style:{"max-height":"calc(100vh - 220px)"}},[t("nav",_e,[(r(!0),l(j,null,M(d(i).questions,(o,n)=>(r(),l("button",{key:o.id,ref_for:!0,ref:a=>I(a,o.id),onClick:a=>$(o.id),class:w(["flex w-full items-center justify-between rounded-md px-2 py-1.5 text-xs transition-colors",[x.value===o.id?"bg-accent font-medium text-accent-foreground":"text-muted-foreground hover:bg-accent/50 hover:text-foreground"]])},[t("span",Be,"Soru "+f(n+1),1)],10,Ce))),128))])],512)])],2)):c("",!0),v.value&&g.value?(r(),l("div",{key:4,onClick:_,class:"fixed inset-0 z-30 bg-black/20 xl:hidden"})):c("",!0)]),_:1}))}};export{Te as default};
