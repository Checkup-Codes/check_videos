import{_ as V,Q as Y,i as x,r as v,x as J,g as i,o as c,b as t,t as u,F as D,m as M,h,n as y,j as X,q as Z,O as ee,J as te,K as se,N as ne,P as re}from"./app-CJEG1hw9.js";import{g}from"./index-D3jsOSc0.js";/* empty css            */const m=f=>(te("data-v-ba0fc5e2"),f=f(),se(),f),oe={class:"flex flex-col items-center justify-center"},ae={key:0,class:"w-full max-w-md rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"},le=m(()=>t("h2",{class:"mb-2 text-2xl font-semibold text-gray-900"},"Test Özeti",-1)),ue={class:"mb-4 text-center"},ie={class:"text-4xl font-bold text-gray-900"},ce=m(()=>t("p",{class:"text-sm text-gray-600"},"Puan",-1)),de={class:"mb-4 grid grid-cols-2 gap-4 rounded-lg bg-gray-50 p-4"},ge={class:"text-center"},ve={class:"text-2xl font-bold text-green-600"},me=m(()=>t("p",{class:"text-sm text-gray-600"},"Doğru",-1)),pe={class:"text-center"},xe={class:"text-2xl font-bold text-red-600"},he=m(()=>t("p",{class:"text-sm text-gray-600"},"Yanlış",-1)),fe={class:"mb-4 max-h-60 overflow-y-auto"},_e=m(()=>t("h3",{class:"mb-2 font-medium text-gray-700"},"Cevaplarınız:",-1)),we={class:"space-y-2 text-left text-sm text-gray-800"},ye={class:"flex flex-col"},be={class:"text-xs text-gray-500"},ke={class:"space-y-2"},Ce=["disabled"],Ie={class:"flex gap-2"},Qe={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-gray-200"},Se={class:"mb-4 text-right text-sm text-gray-500"},Ae={class:"flex items-center justify-between"},Re={class:"text-xl font-semibold text-gray-900"},Te=["disabled"],Pe={class:"mt-1 text-sm text-gray-500"},Be={key:0,class:"rounded-lg bg-blue-50 p-3"},De=m(()=>t("p",{class:"text-sm text-blue-600"},"Örnek Cümle:",-1)),Me={key:0,class:"mt-1 text-sm text-gray-700"},ze={key:1,class:"mt-1 text-sm text-gray-700"},He={class:"space-y-4"},We=["disabled"],Ge=["disabled"],Le={class:"mt-1 text-gray-700"},je={key:0,class:"mt-3"},Ne=m(()=>t("p",{class:"text-sm font-medium text-gray-600"},"Diğer Anlamlar:",-1)),Ke={class:"mt-1 list-inside list-disc space-y-1 text-sm text-gray-700"},Ue={__name:"TranslateWord",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(f,{emit:z}){const d=f,k=z,C=Y(),H=C.props.languagePacks||[],I=x(()=>{var s;return!!((s=C.props.auth)!=null&&s.user)});x(()=>d.packSlug?H.find(s=>s.slug===d.packSlug):null);const e=v({isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),_=v([]),Q=x(()=>Object.fromEntries(_.value.map(s=>[s.id,s]))),S=v(null),b=v(null),A=v(null),a=v(null),p=v(!1),W=()=>{g.fromTo(A.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),g.fromTo(a.value,{opacity:0,y:10},{opacity:1,y:0,duration:.3,delay:.2,ease:"power2.out"})},G=()=>{g.timeline().to(a.value,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}).to(a.value,{scale:1,duration:.2,ease:"power2.out"});const n=50,l=["#34d399","#10b981","#059669"];for(let o=0;o<n;o++){const r=document.createElement("div");r.style.position="absolute",r.style.width="8px",r.style.height="8px",r.style.backgroundColor=l[Math.floor(Math.random()*l.length)],r.style.borderRadius="50%",document.body.appendChild(r);const w=a.value.getBoundingClientRect().left+a.value.offsetWidth/2,B=a.value.getBoundingClientRect().top;g.fromTo(r,{x:w,y:B,scale:0},{x:w+(Math.random()-.5)*200,y:B-100-Math.random()*100,scale:1,opacity:0,duration:1,ease:"power4.out",onComplete:()=>r.remove()})}},L=()=>{g.timeline().to(a.value,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(a.value,{x:-10,duration:.1}).to(a.value,{x:10,duration:.1}).to(a.value,{x:-5,duration:.1}).to(a.value,{x:5,duration:.1}).to(a.value,{x:0,scale:1,duration:.2})},j=s=>{g.to(S.value,{width:`${s}%`,duration:.5,ease:"power2.out"}),g.fromTo(b.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),g.to(b.value,{opacity:s===100?0:.5,duration:.3})},R=async()=>{if(!d.words||d.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let s=[...d.words];if(d.gameConfig.prioritizeUnlearned){const n=s.filter(r=>r.learning_status===0),l=s.filter(r=>r.learning_status===1),o=s.filter(r=>r.learning_status===2);s=[...n,...l,...o]}d.gameConfig.prioritizeRecentlyLearned&&s.sort((n,l)=>{const o=new Date(n.last_reviewed_at||0);return new Date(l.last_reviewed_at||0)-o}),d.gameConfig.prioritizeFlagged&&s.sort((n,l)=>n.is_flagged&&!l.is_flagged?-1:!n.is_flagged&&l.is_flagged?1:0),d.gameConfig.prioritizeMostIncorrect&&s.sort((n,l)=>{const o=n.incorrect_count||0;return(l.incorrect_count||0)-o}),s=s.sort(()=>Math.random()-.5),await new Promise(n=>{_.value=s,e.value.totalQuestions=_.value.length,e.value.currentIndex=0,e.value.userResponses=[],n()}),e.value.isLoading=!1,e.value.isPlaying=!0,T()},N=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},T=()=>{if(e.value.currentIndex>=_.value.length){E();return}e.value.currentQuestion=_.value[e.value.currentIndex],e.value.userInput="",e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,re(()=>{W()})},P=()=>{if(!e.value.userInput.trim())return;const s=e.value.userInput.trim().toLowerCase(),l=(e.value.currentQuestion.meanings||[{meaning:e.value.currentQuestion.meaning}]).some(r=>r.meaning.toLowerCase()===s);e.value.isCorrect=l,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:e.value.isCorrect}),e.value.showAnswer=!0,e.value.isCorrect?G():L();const o=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);j(o),setTimeout(()=>{g.set(a.value,{clearProps:"all"}),a.value.style.backgroundColor="",a.value.style.borderColor="",e.value.currentIndex++,e.value.userInput="",e.value.showAnswer=!1,e.value.progress=0,T()},2e3)},K=x(()=>{if(!e.value.userResponses.length)return 0;const s=e.value.userResponses.filter(n=>n.correct).length;return Math.round(s/e.value.userResponses.length*100)}),U=s=>{switch(s){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},E=()=>{e.value.isPlaying=!1},F=()=>{if(!I.value||!e.value.userResponses.length||p.value)return;p.value=!0;const s=e.value.userResponses.map(n=>({word_id:n.word_id,review_count:1,incorrect_count:n.correct?0:1}));ne.post("/update-words",{words:s},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),p.value=!1,setTimeout(()=>{k("game-completed")},1e3)},onError:n=>{console.error("İstatistik güncelleme hatası:",n),p.value=!1}})},O=x(()=>e.value.userResponses.filter(s=>s.correct).length),$=x(()=>e.value.userResponses.filter(s=>!s.correct).length),q=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},R()};return J(()=>{R()}),(s,n)=>{var l;return c(),i("div",oe,[!e.value.isPlaying&&e.value.userResponses.length>0?(c(),i("div",ae,[le,t("div",ue,[t("p",ie,u(K.value)+" / 100",1),ce]),t("div",de,[t("div",ge,[t("p",ve,u(O.value),1),me]),t("div",pe,[t("p",xe,u($.value),1),he])]),t("div",fe,[_e,t("ul",we,[(c(!0),i(D,null,M(e.value.userResponses,o=>{var r,w;return c(),i("li",{key:o.word_id,class:"flex items-center justify-between rounded-md bg-gray-50 px-4 py-2"},[t("div",ye,[t("span",{class:y(o.correct?"font-medium text-green-600":"font-medium text-red-600")},u(((r=Q.value[o.word_id])==null?void 0:r.word)||"Unknown"),3),t("span",be,u(((w=Q.value[o.word_id])==null?void 0:w.meaning)||""),1)]),t("span",{class:y(o.correct?"text-lg text-green-600":"text-lg text-red-600")},u(o.correct?"✓":"✗"),3)])}),128))])]),t("div",ke,[I.value?(c(),i("button",{key:0,onClick:F,class:"w-full rounded-lg bg-blue-600 px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-blue-700",disabled:p.value},u(p.value?"Güncelleniyor...":"Kelime İstatistiklerini Güncelle"),9,Ce)):h("",!0),t("div",Ie,[t("button",{onClick:n[0]||(n[0]=o=>k("game-completed")),class:"flex-1 rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700"}," Pakete Dön "),t("button",{onClick:q,class:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Tekrar Başla ")])])])):(c(),i("div",{key:1,class:y(["relative w-full max-w-md rounded-2xl border border-gray-200 p-6 shadow-sm transition-colors duration-500",{"bg-white":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",Qe,[t("div",{ref_key:"progressBar",ref:S,class:"h-full w-0 bg-black"},null,512),t("div",{ref_key:"progressBarGlow",ref:b,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),t("div",Se," Soru "+u(e.value.currentIndex+1)+" / "+u(e.value.totalQuestions),1),e.value.currentQuestion?(c(),i("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:A},[t("div",null,[t("div",Ae,[t("h2",Re,' "'+u(e.value.currentQuestion.word)+'" kelimesinin anlamı nedir? ',1),e.value.showAnswer?h("",!0):(c(),i("button",{key:0,onClick:N,class:"rounded-lg border border-gray-200 px-3 py-1 text-sm text-gray-600 hover:bg-gray-50",disabled:e.value.hintShown&&(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length<=1)},u(e.value.hintShown?`İpucu (${e.value.currentHintIndex+1}/${((l=e.value.currentQuestion.example_sentences)==null?void 0:l.length)||0})`:"İpucu Göster"),9,Te))]),t("p",Pe,"Kelime Türü: "+u(U(e.value.currentQuestion.type)),1)]),e.value.hintShown?(c(),i("div",Be,[De,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(c(),i("p",Me,u(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)):(c(),i("p",ze,"Bu kelime için örnek cümle bulunmuyor."))])):h("",!0),t("div",He,[X(t("input",{ref_key:"answerInput",ref:a,"onUpdate:modelValue":n[1]||(n[1]=o=>e.value.userInput=o),type:"text",disabled:e.value.showAnswer,onKeyup:ee(P,["enter"]),placeholder:"Cevabınızı yazın...",class:"w-full rounded-lg border border-gray-300 p-3 text-gray-900 focus:border-black focus:outline-none focus:ring-1 focus:ring-black disabled:cursor-not-allowed"},null,40,We),[[Z,e.value.userInput]]),t("button",{onClick:P,disabled:!e.value.userInput.trim()||e.value.showAnswer,class:"w-full rounded-lg bg-black px-4 py-3 text-center text-sm font-medium text-white transition hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-50"},u(e.value.showAnswer?"Sonraki Soru":"Cevapla"),9,Ge)]),e.value.showAnswer?(c(),i("div",{key:1,class:y(["mt-4 rounded-lg p-4",{"bg-red-50":!e.value.isCorrect,"bg-green-50":e.value.isCorrect}])},[t("p",{class:y(["text-sm font-medium",{"text-red-600":!e.value.isCorrect,"text-green-600":e.value.isCorrect}])}," Doğru Cevap: ",2),t("p",Le,u(e.value.currentQuestion.meaning),1),e.value.currentQuestion.meanings&&e.value.currentQuestion.meanings.length>1?(c(),i("div",je,[Ne,t("ul",Ke,[(c(!0),i(D,null,M(e.value.currentQuestion.meanings,(o,r)=>(c(),i("li",{key:r},u(o.meaning),1))),128))])])):h("",!0)],2)):h("",!0)],512)):h("",!0)],2))])}}},$e=V(Ue,[["__scopeId","data-v-ba0fc5e2"]]);export{$e as default};
