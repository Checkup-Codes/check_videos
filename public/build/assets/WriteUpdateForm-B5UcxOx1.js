import{Q,l as b,T as W,x as R,L as k,A as J,g as n,o as d,b as e,p as X,e as Z,h as m,j as v,q as h,u as s,n as p,t as _,D as A,F as ee,m as te,v as se,s as O,N as le}from"./app-LhKPFfpS.js";import{Q as ae}from"./quill.snow-CGLxXHA4.js";import"./lodash-aSqrwiG9.js";/* empty css            */const oe={class:"card"},re={class:"card-body p-6"},ie=X('<div class="card-title flex items-center justify-between"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg><h2 class="text-gray-800 dark:text-white">Yazıyı Güncelle</h2></div></div>',1),ne={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},de={class:"md:col-span-2"},ue={class:"form-control w-full"},ce=e("label",{class:"label"},[e("span",{class:"label-text"},"Başlık")],-1),pe={class:"relative"},_e={key:0,class:"label"},me={class:"label-text-alt text-error"},ve={class:"form-control w-full"},be=e("label",{class:"label"},[e("span",{class:"label-text"},"Slug")],-1),he={class:"relative"},ge={key:0,class:"label"},ye={class:"label-text-alt text-error"},fe={class:"form-control w-full"},xe=e("label",{class:"label"},[e("span",{class:"label-text"},"Yayınlama Tarihi")],-1),ke={class:"flex space-x-2"},we={key:0,class:"label"},Te={class:"label-text-alt text-error"},ze={class:"md:col-span-2"},Se={class:"form-control w-full"},Me=e("label",{class:"label"},[e("span",{class:"label-text"},"Özet")],-1),De={class:"relative"},Ee={key:0,class:"label"},Ue={class:"label-text-alt text-error"},Be={class:"md:col-span-2"},Ce={class:"form-control w-full"},Fe=e("label",{class:"label"},[e("span",{class:"label-text"},"İçerik")],-1),Le={class:"relative"},Ve={key:0,class:"upload-loading-overlay bg-base-100/50 absolute inset-0 z-20 flex items-center justify-center"},je=e("div",{class:"flex flex-col items-center gap-2"},[e("span",{class:"loading loading-spinner loading-lg text-primary"}),e("span",{class:"text-sm"},"Resim yükleniyor...")],-1),Ie=[je],He={key:0,class:"label"},Ne={class:"label-text-alt text-error"},Re={key:1,class:"toast toast-end z-50"},Ae=e("label",{class:"label"},[e("span",{class:"label-text"},"Kategori")],-1),Oe=e("option",{value:"",disabled:""},"Kategori seç",-1),qe=["value"],Ge={key:0,class:"label"},Ke={class:"label-text-alt text-error"},Ye=e("label",{class:"label"},[e("span",{class:"label-text"},"Durumu")],-1),$e=e("option",{value:"draft"},"Şablon",-1),Pe=e("option",{value:"published"},"Yayında",-1),Qe=e("option",{value:"private"},"Gizli",-1),We=[$e,Pe,Qe],Je={key:0,class:"label"},Xe={class:"label-text-alt text-error"},Ze={class:"form-control w-full"},et=e("label",{class:"label"},[e("span",{class:"label-text"},"Kapak Resmi URL")],-1),tt={class:"relative"},st={key:0,class:"label"},lt={class:"label-text-alt text-error"},at={class:"form-control w-full"},ot=e("label",{class:"label"},[e("span",{class:"label-text"},"Etiketler")],-1),rt={class:"relative"},it={key:0,class:"label"},nt={class:"label-text-alt text-error"},dt={class:"form-control w-full"},ut=e("label",{class:"label"},[e("span",{class:"label-text"},"SEO Anahtar Kelimeleri")],-1),ct={class:"relative"},pt={key:0,class:"label"},_t={class:"label-text-alt text-error"},mt={class:"form-control w-full"},vt=e("label",{class:"label"},[e("span",{class:"label-text"},"SEO Meta Açıklaması")],-1),bt={class:"relative"},ht={class:"mt-1 text-xs text-gray-500"},gt={key:0,class:"label"},yt={class:"label-text-alt text-error"},ft=e("div",{class:"mt-1 text-xs text-gray-500"},[e("span",null,"İpucu: Bu açıklama arama sonuçlarında gösterilir. Boş bırakırsanız, özet kısmı kullanılacaktır.")],-1),xt={class:"form-control w-full"},kt=e("label",{class:"label"},[e("span",{class:"label-text"},"Görüntülenme Sayısı")],-1),wt={class:"relative"},Tt={class:"flex items-center space-x-2"},zt={class:"label cursor-pointer justify-start gap-2"},St=e("span",{class:"label-text"},"Çizim İçerir",-1),Mt=e("div",{class:"divider"},null,-1),Dt={class:"flex justify-end space-x-3"},Et=["disabled"],Vt=Object.assign({name:"WriteUpdateForm"},{__name:"WriteUpdateForm",setup(Ut){const{props:B}=Q(),q=b(B.categories),c=b(B.write),t=W({title:c.value.title||"",slug:c.value.slug||"",content:c.value.content||"",published_at:c.value.published_at||"",summary:c.value.summary||"",status:c.value.status||"draft",category_id:c.value.category_id||"",cover_image:c.value.cover_image||"",seo_keywords:c.value.seo_keywords||"",meta_description:c.value.meta_description||"",tags:c.value.tags||"",views_count:c.value.views_count||0,hasDraw:c.value.hasDraw||!1}),l=b({title:"",slug:"",content:"",published_at:"",summary:"",status:"",category_id:"",cover_image:"",seo_keywords:"",meta_description:"",tags:""}),u=b({date:"",time:""});R(()=>{if(t.published_at){const o=new Date(t.published_at);isNaN(o.getTime())||(u.value.date=o.toISOString().split("T")[0],u.value.time=o.toTimeString().substring(0,5))}}),k(u.value,()=>{u.value.date&&u.value.time&&(t.published_at=`${u.value.date}T${u.value.time}:00`)},{deep:!0});const G=()=>{l.value.title=t.title?"":"Başlık zorunludur.",l.value.slug=t.slug?"":"Slug zorunludur.",l.value.content=t.content?"":"İçerik zorunludur.",l.value.published_at=u.value.date&&u.value.time?"":"Yayınlama tarihi zorunludur.",l.value.summary=t.summary?"":"Özet zorunludur.",l.value.category_id=t.category_id?"":"Kategori seçilmelidir.",l.value.published_at||(t.published_at=`${u.value.date}T${u.value.time}:00`)},K=()=>{G(),Object.values(l.value).some(o=>o!=="")||O.get("/sanctum/csrf-cookie").then(()=>{t.put(route("writes.update",{write:c.value.slug}),{onSuccess:()=>{le.visit(route("writes.show",{write:t.slug}))},onError:o=>{(o.hasOwnProperty("token")||o.message==="CSRF token mismatch")&&window.location.reload()}})})};let z=!0;k(()=>t.title,o=>{z||(t.slug=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),k(()=>t.slug,(o,a)=>{o!==a&&(z=!0)}),k(()=>t.slug,o=>{o===""&&(z=!1)});const y=b(null);let i,C=!1;const S=b(!1),Y=b(""),M=b(!1),F=b(""),L=b("alert-info"),V=["#570DF8","#F000B8","#37CDBE","#3ABFF8","#36D399","#FBBD23","#F87272","#1f2937","#2A303C","#ffffff","#000000"],x=(o,a="alert-info")=>{F.value=o,L.value=a,M.value=!0,setTimeout(()=>{M.value=!1},3e3)},$=()=>{const o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("accept","image/*"),o.click(),o.onchange=async()=>{var r,j;const a=o.files[0];if(!a)return;if(!["image/jpeg","image/png","image/gif","image/jpg"].includes(a.type)){x("Sadece JPEG, PNG veya GIF formatları desteklenmektedir.","alert-error");return}if(a.size>10*1024*1024){x("Resim boyutu 10MB'dan küçük olmalıdır.","alert-error");return}S.value=!0,Y.value="";try{const f=i.getSelection(),U="img-loading-"+Date.now(),P=`
        <div id="${U}" class="skeleton-placeholder w-full my-4">
          <div class="skeleton h-32 w-full rounded-lg"></div>
          <div class="flex justify-center mt-2">
            <span class="loading loading-dots loading-md"></span>
          </div>
        </div>
      `;i.clipboard.dangerouslyPasteHTML(f.index,P);const I=new FormData;I.append("image",a);const H=document.head.querySelector('meta[name="csrf-token"]'),N={"Content-Type":"multipart/form-data"};H&&(N["X-CSRF-TOKEN"]=H.getAttribute("content"));const w=await O.post("/image-upload",I,{headers:N,withCredentials:!0});if(w.data.success&&w.data.url){const g=document.getElementById(U);if(g){const T=i.getIndex(i.scroll.descendant(Node,g)[0][0]);i.deleteText(T,g.outerHTML.length),i.insertEmbed(T,"image",w.data.url)}else i.insertEmbed(f.index,"image",w.data.url);x("Resim başarıyla yüklendi","alert-success")}else{const g=document.getElementById(U);if(g){const T=i.getIndex(i.scroll.descendant(Node,g)[0][0]);i.deleteText(T,g.outerHTML.length)}console.error("Resim yüklenemedi"),x("Resim yüklenirken bir hata oluştu.","alert-error")}}catch(f){console.error("Resim yükleme hatası:",f),x("Resim yüklenirken bir hata oluştu: "+(((j=(r=f.response)==null?void 0:r.data)==null?void 0:j.message)||f.message),"alert-error")}finally{S.value=!1}}};R(()=>{i=new ae(y.value,{theme:"snow",modules:{toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{color:V},{background:V}],[{font:[]}],[{align:[]}],["link","image"],["clean"]],handlers:{image:$}}},placeholder:"İçeriği buraya yazın...",bounds:y.value,maxLength:1/0}),i.on("text-change",()=>{try{const o=i.root.innerHTML;t.content=o}catch(o){console.error("Content update error:",o)}}),setTimeout(()=>{if(t.content&&!C)try{i.root.innerHTML=t.content,C=!0}catch(o){console.error("Initial content load error:",o)}},100),y.value.style.height="400px",y.value&&y.value.classList.add("daisy-quill-editor")});let D=null;return k(()=>t.content,o=>{D&&clearTimeout(D),D=setTimeout(()=>{if(i&&o!==i.root.innerHTML)try{i.root.innerHTML=o||""}catch(a){console.error("Content update error in watcher:",a)}},300)}),J(()=>{i&&(i=null)}),(o,a)=>{var E;return d(),n("div",oe,[e("div",re,[ie,e("form",{onSubmit:Z(K,["prevent"]),class:"space-y-6"},[e("div",ne,[e("div",de,[e("div",ue,[ce,e("div",pe,[v(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>s(t).title=r),placeholder:"Yazının başlığını girin",class:p(["input-bordered input w-full",{"input-error":l.value.title||s(t).errors.title}])},null,2),[[h,s(t).title]])]),l.value.title||s(t).errors.title?(d(),n("label",_e,[e("span",me,_(l.value.title||s(t).errors.title),1)])):m("",!0)])]),e("div",null,[e("div",ve,[be,e("div",he,[v(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=r=>s(t).slug=r),placeholder:"örnek-yazı-slug",class:p(["input-bordered input w-full",{"input-error":l.value.slug||s(t).errors.slug}])},null,2),[[h,s(t).slug]])]),l.value.slug||s(t).errors.slug?(d(),n("label",ge,[e("span",ye,_(l.value.slug||s(t).errors.slug),1)])):m("",!0)])]),e("div",null,[e("div",fe,[xe,e("div",ke,[v(e("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=r=>u.value.date=r),class:p(["input-bordered input w-full",{"input-error":l.value.published_at||s(t).errors.published_at}])},null,2),[[h,u.value.date]]),v(e("input",{type:"time","onUpdate:modelValue":a[3]||(a[3]=r=>u.value.time=r),class:p(["input-bordered input w-full",{"input-error":l.value.published_at||s(t).errors.published_at}])},null,2),[[h,u.value.time]])]),l.value.published_at||s(t).errors.published_at?(d(),n("label",we,[e("span",Te,_(l.value.published_at||s(t).errors.published_at),1)])):m("",!0)])]),e("div",ze,[e("div",Se,[Me,e("div",De,[v(e("textarea",{"onUpdate:modelValue":a[4]||(a[4]=r=>s(t).summary=r),rows:"3",placeholder:"Yazının kısa özeti",class:p(["textarea-bordered textarea w-full",{"textarea-error":l.value.summary||s(t).errors.summary}])},null,2),[[h,s(t).summary]])]),l.value.summary||s(t).errors.summary?(d(),n("label",Ee,[e("span",Ue,_(l.value.summary||s(t).errors.summary),1)])):m("",!0)])]),e("div",Be,[e("div",Ce,[Fe,e("div",Le,[e("div",{ref_key:"quillEditor",ref:y,class:p(["min-h-[300px] rounded border border-base-300 bg-base-100 p-3",{"border-error":l.value.content||s(t).errors.content}]),style:{height:"400px"}},null,2),S.value?(d(),n("div",Ve,Ie)):m("",!0)]),l.value.content||s(t).errors.content?(d(),n("label",He,[e("span",Ne,_(l.value.content||s(t).errors.content),1)])):m("",!0),M.value?(d(),n("div",Re,[e("div",{class:p(`alert ${L.value}`)},[e("span",null,_(F.value),1)],2)])):m("",!0)])]),e("div",null,[Ae,v(e("select",{"onUpdate:modelValue":a[5]||(a[5]=r=>s(t).category_id=r),class:p(["select-bordered select w-full",{"select-error":l.value.category_id||s(t).errors.category_id}])},[Oe,(d(!0),n(ee,null,te(q.value,r=>(d(),n("option",{key:r.id,value:r.id},_(r.name),9,qe))),128))],2),[[A,s(t).category_id]]),l.value.category_id||s(t).errors.category_id?(d(),n("label",Ge,[e("span",Ke,_(l.value.category_id||s(t).errors.category_id),1)])):m("",!0)]),e("div",null,[Ye,v(e("select",{"onUpdate:modelValue":a[6]||(a[6]=r=>s(t).status=r),class:p(["select-bordered select w-full",{"select-error":l.value.status||s(t).errors.status}])},We,2),[[A,s(t).status]]),l.value.status||s(t).errors.status?(d(),n("label",Je,[e("span",Xe,_(l.value.status||s(t).errors.status),1)])):m("",!0)]),e("div",null,[e("div",Ze,[et,e("div",tt,[v(e("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=r=>s(t).cover_image=r),placeholder:"https://example.com/image.jpg",class:p(["input-bordered input w-full",{"input-error":l.value.cover_image||s(t).errors.cover_image}])},null,2),[[h,s(t).cover_image]])]),l.value.cover_image||s(t).errors.cover_image?(d(),n("label",st,[e("span",lt,_(l.value.cover_image||s(t).errors.cover_image),1)])):m("",!0)])]),e("div",null,[e("div",at,[ot,e("div",rt,[v(e("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=r=>s(t).tags=r),placeholder:"etiket1, etiket2, etiket3",class:p(["input-bordered input w-full",{"input-error":l.value.tags||s(t).errors.tags}])},null,2),[[h,s(t).tags]])]),l.value.tags||s(t).errors.tags?(d(),n("label",it,[e("span",nt,_(l.value.tags||s(t).errors.tags),1)])):m("",!0)])]),e("div",null,[e("div",dt,[ut,e("div",ct,[v(e("input",{type:"text","onUpdate:modelValue":a[9]||(a[9]=r=>s(t).seo_keywords=r),placeholder:"anahtar1, anahtar2, anahtar3",class:p(["input-bordered input w-full",{"input-error":l.value.seo_keywords||s(t).errors.seo_keywords}])},null,2),[[h,s(t).seo_keywords]])]),l.value.seo_keywords||s(t).errors.seo_keywords?(d(),n("label",pt,[e("span",_t,_(l.value.seo_keywords||s(t).errors.seo_keywords),1)])):m("",!0)])]),e("div",null,[e("div",mt,[vt,e("div",bt,[v(e("textarea",{"onUpdate:modelValue":a[10]||(a[10]=r=>s(t).meta_description=r),placeholder:"Arama motorları için kısa bir açıklama (max 160 karakter)",class:p(["textarea-bordered textarea w-full",{"textarea-error":l.value.meta_description||s(t).errors.meta_description}]),maxlength:"160",rows:"2"},null,2),[[h,s(t).meta_description]]),e("div",ht,_(((E=s(t).meta_description)==null?void 0:E.length)||0)+"/160",1)]),l.value.meta_description||s(t).errors.meta_description?(d(),n("label",gt,[e("span",yt,_(l.value.meta_description||s(t).errors.meta_description),1)])):m("",!0),ft])]),e("div",null,[e("div",xt,[kt,e("div",wt,[v(e("input",{type:"number","onUpdate:modelValue":a[11]||(a[11]=r=>s(t).views_count=r),class:"input-bordered input w-full",readonly:""},null,512),[[h,s(t).views_count]])])])]),e("div",Tt,[e("label",zt,[v(e("input",{type:"checkbox","onUpdate:modelValue":a[12]||(a[12]=r=>s(t).hasDraw=r),class:"checkbox checkbox-primary"},null,512),[[se,s(t).hasDraw]]),St])])]),Mt,e("div",Dt,[e("button",{type:"submit",class:p(["btn btn-primary",{loading:s(t).processing}]),disabled:s(t).processing}," Güncelle ",10,Et)])],32)])])}}});export{Vt as default};
