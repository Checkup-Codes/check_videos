const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-BMQI6xGF.js","assets/index-C2prPKSV.js","assets/ssr-BDs4_-3i.js","assets/ssr-xLtVJYZI.css","assets/index-DspXi2E_.js","assets/client-Cq8RJupn.js"])))=>i.map(i=>d[i]);
import{a as v}from"./app-0xZ4nMUH.js";import{Q as S,e as n,y as N,m as O,p as T,c as h,h as _,a as l,u as M,f as I,t as B,z as L,o as g}from"./ssr-BDs4_-3i.js";const R={class:"relative h-full w-full"},J={key:0,class:"absolute left-32 top-[53px] z-10 lg:left-36 lg:top-4"},P={key:1,class:"absolute left-32 top-[101px] z-20 rounded-lg border border-green-300 bg-green-100 px-3 py-2 text-sm text-green-800 shadow-lg lg:left-36 lg:top-16"},H={__name:"ExcalidrawComponent",setup(z,{expose:x}){const{props:r}=S(),o=n([]),i=n(""),s=n(r.write.write_draws),c=n(null),u=n(null),p=n(!1),d=n(document.documentElement.getAttribute("data-theme")==="dark");N(d,t=>{c.value&&c.value.updateScene({theme:t?"dark":"light"})}),O(()=>{const t=new MutationObserver(e=>{e.forEach(a=>{a.attributeName==="data-theme"&&(d.value=document.documentElement.getAttribute("data-theme")==="dark")})});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),b(),()=>t.disconnect()});const b=()=>{v(async()=>{const{Excalidraw:t}=await import("./main-BMQI6xGF.js").then(e=>e.m);return{Excalidraw:t}},__vite__mapDeps([0,1,2,3,4])).then(({Excalidraw:t})=>{v(()=>import("./index-C2prPKSV.js").then(e=>e.i),__vite__mapDeps([1,2,3])).then(e=>{v(()=>import("./client-Cq8RJupn.js").then(a=>a.c),__vite__mapDeps([5,4,1,2,3])).then(a=>{const y=document.getElementById("excali"),V=a.createRoot(y),w=s.value.length>0?JSON.parse(s.value[0].elements):[];u.value=JSON.stringify(w);const A={elements:w,scrollToContent:!0,theme:d.value?"dark":"light"},C=m=>{o.value=m},D=e.createElement(t,{initialData:A,onChange:C,viewModeEnabled:!r.auth.user,theme:d.value?"dark":"light",onMount:m=>{c.value=m}});V.render(D)})})})},E=T(()=>u.value?JSON.stringify(o.value)!==u.value:!1),k=()=>{const t=o.value.length>0?o.value:[],e=JSON.stringify(t);p.value=!0,L.post(`/writes/${r.write.id}/draw`,{elements:e,version:1}).then(a=>{f("Canvas durumu başarıyla kaydedildi!"),u.value=e,s.value.length>0?s.value[0]=a.data:s.value.push(a.data)}).catch(()=>{f("Kaydetme sırasında bir hata oluştu. Lütfen tekrar deneyin.")}).finally(()=>{p.value=!1})};x({hasUnsavedChanges:E});const f=t=>{i.value=t,setTimeout(()=>{i.value=""},3e3)};return(t,e)=>(g(),h("div",R,[M(r).auth.user?(g(),h("div",J,[l("button",{onClick:k,class:"flex items-center gap-2 rounded-lg border border-input bg-background px-3 py-2 text-sm text-foreground shadow-lg transition-all hover:bg-accent"},[...e[0]||(e[0]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 3.75V16.5L12 14.25 7.5 16.5V3.75m9 0H18A2.25 2.25 0 0120.25 6v12A2.25 2.25 0 0118 20.25H6A2.25 2.25 0 013.75 18V6A2.25 2.25 0 016 3.75h1.5m9 0h-9"})],-1),I(" Kaydet ",-1)])])])):_("",!0),i.value?(g(),h("div",P,B(i.value),1)):_("",!0),e[1]||(e[1]=l("div",{id:"excalidraw-container",class:"h-full w-full"},[l("div",{id:"excali",class:"h-full w-full"})],-1))]))}};export{H as _};
