import{_ as X,Q as ee,i as m,r as g,l as te,g as u,o as c,b as t,t as i,F as k,q as C,h as j,n as L,J as se,K as re,N as oe,P as ne}from"./app-BjhyfXx-.js";import{g as v}from"./index-D3jsOSc0.js";/* empty css            */const h=p=>(se("data-v-1460d52d"),p=p(),re(),p),le={class:"flex min-h-screen flex-col items-center justify-center"},ae={key:0,class:"w-full max-w-md rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"},ie=h(()=>t("h2",{class:"mb-2 text-2xl font-semibold text-gray-900"},"Test Özeti",-1)),ue={class:"mb-4 text-center"},ce={class:"text-4xl font-bold text-gray-900"},de=h(()=>t("p",{class:"text-sm text-gray-600"},"Puan",-1)),ge={class:"mb-4 grid grid-cols-2 gap-4 rounded-lg bg-gray-50 p-4"},ve={class:"text-center"},me={class:"text-2xl font-bold text-green-600"},fe=h(()=>t("p",{class:"text-sm text-gray-600"},"Doğru",-1)),he={class:"text-center"},pe={class:"text-2xl font-bold text-red-600"},xe=h(()=>t("p",{class:"text-sm text-gray-600"},"Yanlış",-1)),we={class:"mb-4 max-h-60 overflow-y-auto"},ye=h(()=>t("h3",{class:"mb-2 font-medium text-gray-700"},"Cevaplarınız:",-1)),be={class:"space-y-2 text-left text-sm text-gray-800"},_e={class:"flex flex-col"},ke={class:"text-xs text-gray-500"},Ce={class:"space-y-2"},Le=["disabled"],Ie={class:"flex gap-2"},Se={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-gray-200"},Ae={class:"mb-4 text-right text-sm text-gray-500"},Re=h(()=>t("div",{class:"flex items-center justify-between"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"Eksik harfleri tamamlayın:")],-1)),Pe={class:"mt-1 text-sm text-gray-500"},Qe=["onClick","disabled"],Be=["disabled"],Me={__name:"WordCompletion",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(p,{emit:E}){const x=p,I=E,S=ee(),G=S.props.languagePacks||[],y=m(()=>{var s;return!!((s=S.props.auth)!=null&&s.user)});m(()=>x.packSlug?G.find(s=>s.slug===x.packSlug):null);const e=g({isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0}),w=g([]),A=m(()=>Object.fromEntries(w.value.map(s=>[s.id,s]))),R=m(()=>e.value.maskedIndices.length===e.value.selectedLetters.length),f=g(!1),P=async()=>{if(!x.words||x.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let s=[...x.words];s.sort(()=>Math.random()-.5),await new Promise(r=>{w.value=s,e.value.totalQuestions=w.value.length,e.value.currentIndex=0,e.value.userResponses=[],r()}),e.value.isLoading=!1,e.value.isPlaying=!0,Q()},z=m(()=>{if(!e.value.userResponses.length)return 0;const s=e.value.userResponses.filter(r=>r.correct).length;return Math.round(s/e.value.userResponses.length*100)}),N=m(()=>e.value.userResponses.filter(s=>s.correct).length),W=m(()=>e.value.userResponses.filter(s=>!s.correct).length),Q=()=>{if(e.value.currentIndex>=w.value.length){J();return}e.value.currentQuestion=w.value[e.value.currentIndex],e.value.selectedLetters=[],e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,D()},D=()=>{const r=e.value.currentQuestion.word.length,o={1:1,2:1,3:1,4:2,5:2,6:3,7:3,8:3,9:4,10:4},n=Math.min(4,Math.floor(r/2)),l=o[r]||n,d=new Set;for(;d.size<l;){const _=Math.floor(Math.random()*r);d.add(_)}e.value.maskedIndices=Array.from(d).sort((_,Z)=>_-Z)},H=g(null),B=g(null),b=g(null),K=g(null),a=g(null),O=(s,r)=>{const o=r.cloneNode(!0);o.style.position="absolute",o.style.zIndex="1000",o.style.left=`${r.offsetLeft}px`,o.style.top=`${r.offsetTop}px`,document.body.appendChild(o);const n=a.value.children[e.value.selectedLetters.length-1],l=n.getBoundingClientRect(),d=r.getBoundingClientRect();v.to(o,{x:l.left-d.left,y:l.top-d.top,scale:.9,duration:.3,ease:"power2.out",onComplete:()=>{o.remove(),v.from(n,{scale:1.2,duration:.2,ease:"power2.out"})}})},U=()=>{v.timeline().to(a.value.children,{scale:1.1,backgroundColor:"#ecfdf5",borderColor:"#34d399",duration:.2,stagger:.05,ease:"power2.out"}).to(a.value.children,{scale:1,duration:.2,stagger:.05})},$=()=>{v.timeline().to(a.value.children,{scale:1.1,backgroundColor:"#fef2f2",borderColor:"#f87171",duration:.2,stagger:.05,ease:"power2.out"}).to(a.value,{x:-10,duration:.1}).to(a.value,{x:10,duration:.1}).to(a.value,{x:-5,duration:.1}).to(a.value,{x:5,duration:.1}).to(a.value,{x:0,duration:.1}).to(a.value.children,{scale:1,duration:.2,stagger:.05})},q=s=>{v.to(B.value,{width:`${s}%`,duration:.5,ease:"power2.out"}),v.fromTo(b.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),v.to(b.value,{opacity:s===100?0:.5,duration:.3})},F=(s,r)=>{e.value.showAnswer||e.value.selectedLetters.length>=e.value.maskedIndices.length||(e.value.selectedLetters.push(s),O(s,r.target),e.value.selectedLetters.length===e.value.maskedIndices.length&&M())},V=()=>{e.value.showAnswer||(e.value.selectedLetters=[])},M=()=>{if(e.value.showAnswer||!R.value)return;const s=e.value.currentQuestion.word;let r=!0;for(let n=0;n<e.value.maskedIndices.length;n++){const l=s[e.value.maskedIndices[n]].toLowerCase(),d=e.value.selectedLetters[n].toLowerCase();if(l!==d){r=!1;break}}e.value.isCorrect=r,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:r}),e.value.showAnswer=!0,r?U():$();const o=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);q(o),setTimeout(()=>{const n=a.value.children;for(let l of n)v.set(l,{clearProps:"all"}),l.style.backgroundColor="",l.style.borderColor="";e.value.currentIndex++,e.value.selectedLetters=[],e.value.showAnswer=!1,e.value.progress=0,Q()},1500)},J=()=>{e.value.isPlaying=!1,ne(()=>{y.value&&e.value.userResponses.length>0&&(console.log("İstatistikler güncelleniyor..."),T())})},Y=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],maskedIndices:[],selectedLetters:[],hintShown:!1,currentHintIndex:0},P()},T=()=>{if(!y.value||!e.value.userResponses.length||f.value)return;f.value=!0;const s=e.value.userResponses.map(r=>({word_id:r.word_id,review_count:1,incorrect_count:r.correct?0:1}));oe.post("/update-words",{words:s},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),f.value=!1,I("game-completed")},onError:r=>{console.error("İstatistik güncelleme hatası:",r),f.value=!1}})};return te(()=>{P()}),(s,r)=>(c(),u("div",le,[!e.value.isPlaying&&e.value.userResponses.length>0?(c(),u("div",ae,[ie,t("div",ue,[t("p",ce,i(z.value)+" / 100",1),de]),t("div",ge,[t("div",ve,[t("p",me,i(N.value),1),fe]),t("div",he,[t("p",pe,i(W.value),1),xe])]),t("div",we,[ye,t("ul",be,[(c(!0),u(k,null,C(e.value.userResponses,o=>{var n,l;return c(),u("li",{key:o.word_id,class:"flex items-center justify-between rounded-md bg-gray-50 px-4 py-2"},[t("div",_e,[t("span",{class:L(o.correct?"font-medium text-green-600":"font-medium text-red-600")},i(((n=A.value[o.word_id])==null?void 0:n.word)||"Unknown"),3),t("span",ke,i(((l=A.value[o.word_id])==null?void 0:l.meaning)||""),1)]),t("span",{class:L(o.correct?"text-lg text-green-600":"text-lg text-red-600")},i(o.correct?"✓":"✗"),3)])}),128))])]),t("div",Ce,[y.value?(c(),u("button",{key:0,onClick:T,class:"w-full rounded-lg bg-blue-600 px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-blue-700",disabled:f.value},i(f.value?"Güncelleniyor...":"Kelime İstatistiklerini Güncelle"),9,Le)):j("",!0),t("div",Ie,[t("button",{onClick:r[0]||(r[0]=o=>I("game-completed")),class:"flex-1 rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700"}," Pakete Dön "),t("button",{onClick:Y,class:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Tekrar Başla ")])])])):(c(),u("div",{key:1,class:L(["relative w-full max-w-md rounded-2xl border border-gray-200 p-6 shadow-sm transition-colors duration-500",{"bg-white":!e.value.showAnswer,"bg-green-50":e.value.showAnswer&&e.value.isCorrect,"bg-red-50":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",Se,[t("div",{ref_key:"progressBar",ref:B,class:"h-full w-0 bg-black"},null,512),t("div",{ref_key:"progressBarGlow",ref:b,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),t("div",Ae," Soru "+i(e.value.currentIndex+1)+" / "+i(e.value.totalQuestions),1),e.value.currentQuestion?(c(),u("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:K},[t("div",null,[Re,t("p",Pe,"Anlam: "+i(e.value.currentQuestion.meaning),1)]),t("div",{class:"flex justify-center space-x-2",ref_key:"selectedLettersContainer",ref:a},[(c(!0),u(k,null,C(e.value.maskedIndices,(o,n)=>(c(),u("div",{key:n,class:"flex h-12 w-12 items-center justify-center rounded-lg border border-gray-300 text-xl font-semibold"},i(e.value.selectedLetters[n]||""),1))),128))],512),t("div",{class:"grid grid-cols-7 gap-2",ref_key:"letterButtons",ref:H},[(c(!0),u(k,null,C("ABCÇDEFGĞHIİJKLMNOÖPRSŞTUÜVYZ".split(""),o=>(c(),u("button",{key:o,onClick:n=>F(o,n),disabled:e.value.showAnswer||e.value.selectedLetters.includes(o)||e.value.selectedLetters.length>=e.value.maskedIndices.length,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 text-lg font-medium transition hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50"},i(o),9,Qe))),128))],512),t("button",{onClick:V,class:"w-full rounded-lg border border-gray-300 px-4 py-2 text-center text-sm font-medium text-gray-700 transition hover:bg-gray-100"}," Seçilen Harfleri Temizle "),t("button",{onClick:M,disabled:e.value.showAnswer||!R.value,class:"w-full rounded-lg bg-black px-4 py-2 text-center text-sm font-medium text-white transition hover:bg-gray-700 disabled:opacity-50"}," Kontrol Et ",8,Be)],512)):j("",!0)],2))]))}},Ge=X(Me,[["__scopeId","data-v-1460d52d"]]);export{Ge as default};
