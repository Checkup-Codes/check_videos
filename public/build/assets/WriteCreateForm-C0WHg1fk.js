import{g as f,b as T,T as xe,Q as ye,s as M,y as L,x as he,c as u,a as o,j as m,n as y,u as l,t as b,i as C,m as F,f as Q,G as X,F as Z,l as ee,I as ke,k as we,h as _e,N as te,o as d,H as V}from"./ssr-D-O19Sjt.js";import Se from"./RichTextEditor-DWTcFMbg.js";import{_ as Ce}from"./WriteImageUploader-DuIKvbeq.js";import"./quill-DUyr3fey.js";import"./app-Ld--xmxC.js";/* empty css            */const Ee={class:"space-y-4 py-6"},Ie={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Re=["value"],Te={key:0,class:"mt-1 text-xs text-destructive"},Le=["value"],Fe={key:0,class:"mt-1 text-xs text-destructive"},je={class:"flex gap-2"},ze={key:0,class:"mt-1 text-xs text-destructive"},Oe=["value"],Me={key:0,class:"mt-1 text-xs text-destructive"},Ve={class:"md:col-span-2"},Ae={class:"relative"},De={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Be=["onMousedown"],Pe={key:0,class:"mt-1 text-xs text-destructive"},Ke={class:"relative"},$e={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Ne=["onMousedown"],Ue={class:"flex flex-col"},He={key:0,class:"text-xs text-muted-foreground"},Ye={key:0,class:"mt-1 text-xs text-destructive"},Ge=["value"],qe={key:0,class:"mt-1 text-xs text-destructive"},Je=["value"],We={key:0,class:"mt-1 text-xs text-destructive"},Qe=["value"],Xe={class:"mt-1 flex items-center justify-between"},Ze={key:0,class:"text-xs text-destructive"},et={class:"text-xs text-muted-foreground"},tt=["value"],st={class:"flex items-center"},rt={class:"flex cursor-pointer items-center gap-2"},ot={key:0,class:"rounded-md border border-destructive bg-destructive/10 p-3"},lt={class:"flex justify-end gap-2 pt-2"},it=["disabled"],nt=["disabled"],at={key:0,class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},_="write_create_form",pt=Object.assign({name:"WriteCreateForm"},{__name:"WriteCreateForm",setup(ut){const A=f(null),D=f(null),B=f(null),P=f(null),K=f(null),$=f(null),N=f(null),j=f(null),U=T(()=>t.content?/data:image\/[^;]+;base64,/.test(t.content):!1),se=r=>{j.value&&j.value.insertImage(r.full_url,r.alt_text)},{props:re}=ye(),oe=r=>{const e=[],n=new Set,s=c=>{!c||!Array.isArray(c)||c.forEach(a=>{a&&a.id&&!n.has(a.id)&&(n.add(a.id),e.push(a),a.children&&Array.isArray(a.children)&&a.children.length>0&&s(a.children))})};return s(r),e},le=f(re.categories||[]),g=T(()=>oe(le.value)),t=xe({title:"",slug:"",content:"",published_at:"",summary:"",status:"published",category_id:"",seo_keywords:"",meta_description:"",tags:"",views_count:0,hasDraw:!1});t.processing=!1;const i=f({title:"",slug:"",content:"",published_at:"",summary:"",status:"",category_id:"",seo_keywords:"",meta_description:"",tags:""}),v=f({date:"",time:""}),S=[{value:"published",label:"Herkese Açık"},{value:"private",label:"Gizli"},{value:"link_only",label:"Sadece Link"}],x=f(""),h=f(""),k=f(!1),w=f(!1),H=f(null),Y=f(null),G=T(()=>{if(!x.value)return S;const r=S.find(n=>n.value===t.status);if(r&&x.value===r.label)return S;const e=x.value.toLowerCase();return S.filter(n=>n.label.toLowerCase().includes(e))}),z=r=>{if(!r||!g.value||g.value.length===0)return"";const e=c=>g.value.find(a=>a.id===c),n=(c,a=[])=>{const p=e(c);return p?(a.unshift(p.name),p.parent_id?n(p.parent_id,a):a):a},s=n(r);return s.length>1?s.slice(0,-1).join(" > "):""},O=r=>{if(!r||!g.value||g.value.length===0)return"";const e=c=>g.value.find(a=>a.id===c),n=(c,a=[])=>{const p=e(c);return p?(a.unshift(p.name),p.parent_id?n(p.parent_id,a):a):a};return n(r).join(" > ")},E=T(()=>{if(!g.value||g.value.length===0)return[];if(!h.value){const s=[],c=new Set;return g.value.forEach(a=>{a&&a.id&&!c.has(a.id)&&(c.add(a.id),s.push(a))}),s}const r=h.value.toLowerCase(),e=[],n=new Set;return g.value.forEach(s=>{if(!s||!s.name||n.has(s.id))return;const c=s.name.toLowerCase().includes(r),p=z(s.id).toLowerCase().includes(r),pe=O(s.id).toLowerCase().includes(r);(c||p||pe)&&(n.add(s.id),e.push(s))}),e}),ie=()=>{x.value.length>=1&&(w.value=!0)},ne=()=>{clearTimeout(Y.value),w.value=!0},ae=()=>{Y.value=setTimeout(()=>{w.value=!1},100)},ue=()=>{h.value.length>=1&&(k.value=!0)},de=()=>{clearTimeout(H.value),E.value.length>0&&(k.value=!0)},ce=()=>{H.value=setTimeout(()=>{k.value=!1},100)},fe=r=>{!r||!r.value||(t.status=r.value,x.value=r.label,V(()=>{w.value=!1}))},ve=r=>{if(!r||!r.id)return;t.category_id=r.id;const e=O(r.id);h.value=e,V(()=>{k.value=!1})},me=()=>{x.value="",t.status="",w.value=!1},be=()=>{h.value="",t.category_id="",k.value=!1};M(()=>{const r=S.find(e=>e.value===t.status);if(r&&(x.value=r.label),t.category_id){const e=g.value.find(n=>n.id===t.category_id);if(e){const n=O(e.id);h.value=n}}document.addEventListener("keydown",e=>{e.key==="Escape"&&(k.value=!1,w.value=!1)})}),M(()=>{const r=new Date;v.value.date=r.toISOString().split("T")[0],v.value.time=r.toTimeString().slice(0,5)}),L(v.value,()=>{v.value.date&&v.value.time&&(t.published_at=`${v.value.date}T${v.value.time}:00`)},{deep:!0}),L(t,r=>{const{processing:e,...n}=r;localStorage.setItem(_,JSON.stringify(n))},{deep:!0}),L(()=>t.processing,r=>{window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:r}}))});let I=null,R=null;M(()=>{t.processing=!1;const r=localStorage.getItem(_);if(r)try{const e=JSON.parse(r),{processing:n,...s}=e;Object.keys(s).length>0&&(s.title||s.content||s.category_id)?Object.assign(t,s):localStorage.removeItem(_)}catch(e){console.error("Error parsing localStorage data:",e),localStorage.removeItem(_)}t.processing=!1,I=()=>{J()},window.addEventListener("sidebarFormSubmit",I),R=()=>{W()},window.addEventListener("sidebarFormReset",R)});const q=()=>{V(()=>{var n;const e=[{ref:A,error:i.value.title||t.errors.title},{ref:D,error:i.value.slug||t.errors.slug},{ref:K,error:i.value.content||t.errors.content},{ref:N,error:i.value.category_id||t.errors.category_id},{ref:B,error:i.value.published_at||t.errors.published_at},{ref:P,error:i.value.summary||t.errors.summary},{ref:$,error:i.value.status||t.errors.status}].find(s=>s.error);if(e&&((n=e.ref)!=null&&n.value)){e.ref.value.scrollIntoView({behavior:"smooth",block:"center"});const s=e.ref.value.querySelector("input, textarea");s&&setTimeout(()=>s.focus(),300)}})},ge=()=>{Object.keys(i.value).forEach(e=>{i.value[e]=""});let r=!1;return(!t.title||t.title.trim()==="")&&(i.value.title="Başlık zorunludur.",r=!0),(!t.slug||t.slug.trim()==="")&&(i.value.slug="Slug zorunludur.",r=!0),(!t.content||t.content.trim()===""||t.content==="<p><br></p>")&&(i.value.content="İçerik zorunludur.",r=!0),t.category_id||(i.value.category_id="Kategori seçilmelidir.",r=!0),v.value.date&&v.value.time?t.published_at=`${v.value.date}T${v.value.time}:00`:t.published_at=null,r&&q(),!r},J=()=>{ge()&&t.post(route("writes.store"),{onSuccess:r=>{var e,n;localStorage.removeItem(_),(n=(e=r==null?void 0:r.props)==null?void 0:e.write)!=null&&n.slug?te.visit(route("writes.show",{write:r.props.write.slug})):t.slug&&te.visit(route("writes.show",{write:t.slug}))},onError:r=>{r&&(Object.keys(r).forEach(e=>{i.value.hasOwnProperty(e)&&(i.value[e]=r[e])}),q())}})},W=()=>{t.reset(),t.processing=!1,Object.keys(i.value).forEach(r=>{i.value[r]=""}),v.value={date:"",time:""},localStorage.removeItem(_),console.log("Form reset completed")};return L(()=>t.title,r=>{const e={ı:"i",İ:"i",ğ:"g",Ğ:"g",ü:"u",Ü:"u",ş:"s",Ş:"s",ö:"o",Ö:"o",ç:"c",Ç:"c"};let n=r;Object.entries(e).forEach(([s,c])=>{n=n.replace(new RegExp(s,"g"),c)}),t.slug=n.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}),he(()=>{I&&window.removeEventListener("sidebarFormSubmit",I),R&&window.removeEventListener("sidebarFormReset",R)}),(r,e)=>{var n;return d(),u("div",Ee,[o("form",{onSubmit:_e(J,["prevent"]),class:"space-y-4"},[o("div",Ie,[o("div",{class:"md:col-span-2",ref_key:"titleRef",ref:A},[o("div",null,[e[15]||(e[15]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Başlık",-1)),o("input",{type:"text",value:l(t).title,onInput:e[0]||(e[0]=s=>l(t).title=s.target.value),placeholder:"Yazının başlığını girin",class:y(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.title||l(t).errors.title}])},null,42,Re),i.value.title||l(t).errors.title?(d(),u("p",Te,b(i.value.title||l(t).errors.title),1)):m("",!0)])],512),o("div",{ref_key:"slugRef",ref:D},[e[16]||(e[16]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Slug",-1)),o("input",{type:"text",value:l(t).slug,onInput:e[1]||(e[1]=s=>l(t).slug=s.target.value),placeholder:"örnek-yazı-slug",class:y(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.slug||l(t).errors.slug}])},null,42,Le),i.value.slug||l(t).errors.slug?(d(),u("p",Fe,b(i.value.slug||l(t).errors.slug),1)):m("",!0)],512),o("div",{ref_key:"publishedAtRef",ref:B},[e[17]||(e[17]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Yayınlama Tarihi",-1)),o("div",je,[C(o("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>v.value.date=s),class:y(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||l(t).errors.published_at}])},null,2),[[F,v.value.date]]),C(o("input",{type:"time","onUpdate:modelValue":e[3]||(e[3]=s=>v.value.time=s),class:y(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||l(t).errors.published_at}])},null,2),[[F,v.value.time]])]),i.value.published_at||l(t).errors.published_at?(d(),u("p",ze,b(i.value.published_at||l(t).errors.published_at),1)):m("",!0)],512),o("div",{class:"md:col-span-2",ref_key:"summaryRef",ref:P},[e[18]||(e[18]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Özet",-1)),o("textarea",{value:l(t).summary,onInput:e[4]||(e[4]=s=>l(t).summary=s.target.value),placeholder:"Yazının kısa özeti",rows:"2",class:y(["flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.summary||l(t).errors.summary}])},null,42,Oe),i.value.summary||l(t).errors.summary?(d(),u("p",Me,b(i.value.summary||l(t).errors.summary),1)):m("",!0)],512),o("div",{class:"md:col-span-2",ref_key:"contentRef",ref:K},[Q(Se,{ref_key:"richTextEditorRef",ref:j,modelValue:l(t).content,"onUpdate:modelValue":e[5]||(e[5]=s=>l(t).content=s),label:"İçerik",error:i.value.content||l(t).errors.content,placeholder:"İçeriği buraya yazın...",height:"400px"},null,8,["modelValue","error"])],512),o("div",Ve,[Q(Ce,{"write-id":null,category:"writes",onInsertImage:se})]),o("div",{ref_key:"statusRef",ref:$},[e[19]||(e[19]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Durumu",-1)),o("div",Ae,[C(o("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s),onFocus:ne,onBlur:ae,onInput:ie,onKeydown:e[7]||(e[7]=X(s=>w.value=!1,["esc"])),placeholder:"Durum seçin...",class:y(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.status||l(t).errors.status}]),tabindex:"0"},null,34),[[F,x.value]]),x.value?(d(),u("button",{key:0,onClick:me,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),w.value&&G.value.length>0?(d(),u("ul",De,[(d(!0),u(Z,null,ee(G.value,s=>(d(),u("li",{key:s.value,onMousedown:c=>fe(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},b(s.label),41,Be))),128))])):m("",!0)]),i.value.status||l(t).errors.status?(d(),u("p",Pe,b(i.value.status||l(t).errors.status),1)):m("",!0)],512),o("div",{ref_key:"categoryRef",ref:N},[e[20]||(e[20]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Kategori",-1)),o("div",Ke,[C(o("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>h.value=s),onFocus:de,onBlur:ce,onInput:ue,onKeydown:e[9]||(e[9]=X(s=>k.value=!1,["esc"])),placeholder:"Kategori seçin...",class:y(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.category_id||l(t).errors.category_id}]),tabindex:"0"},null,34),[[F,h.value]]),h.value?(d(),u("button",{key:0,onClick:be,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),k.value&&E.value&&E.value.length>0?(d(),u("ul",$e,[(d(!0),u(Z,null,ee(E.value,s=>(d(),u("li",{key:s.id,onMousedown:c=>ve(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},[o("div",Ue,[o("span",null,b(s.name),1),z(s.id)?(d(),u("span",He,b(z(s.id)),1)):m("",!0)])],40,Ne))),128))])):m("",!0)]),i.value.category_id||l(t).errors.category_id?(d(),u("p",Ye,b(i.value.category_id||l(t).errors.category_id),1)):m("",!0)],512),o("div",null,[e[21]||(e[21]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Etiketler",-1)),o("input",{type:"text",value:l(t).tags,onInput:e[10]||(e[10]=s=>l(t).tags=s.target.value),placeholder:"etiket1, etiket2, etiket3",class:y(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.tags||l(t).errors.tags}])},null,42,Ge),i.value.tags||l(t).errors.tags?(d(),u("p",qe,b(i.value.tags||l(t).errors.tags),1)):m("",!0)]),o("div",null,[e[22]||(e[22]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Anahtar Kelimeleri",-1)),o("input",{type:"text",value:l(t).seo_keywords,onInput:e[11]||(e[11]=s=>l(t).seo_keywords=s.target.value),placeholder:"anahtar1, anahtar2, anahtar3",class:y(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.seo_keywords||l(t).errors.seo_keywords}])},null,42,Je),i.value.seo_keywords||l(t).errors.seo_keywords?(d(),u("p",We,b(i.value.seo_keywords||l(t).errors.seo_keywords),1)):m("",!0)]),o("div",null,[e[23]||(e[23]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Meta Açıklaması",-1)),o("textarea",{value:l(t).meta_description,onInput:e[12]||(e[12]=s=>l(t).meta_description=s.target.value),placeholder:"Arama motorları için kısa bir açıklama (max 160 karakter)",class:y(["flex min-h-[60px] w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.meta_description||l(t).errors.meta_description}]),maxlength:"160",rows:"2"},null,42,Qe),o("div",Xe,[i.value.meta_description||l(t).errors.meta_description?(d(),u("p",Ze,b(i.value.meta_description||l(t).errors.meta_description),1)):m("",!0),o("span",et,b(((n=l(t).meta_description)==null?void 0:n.length)||0)+"/160",1)])]),o("div",null,[e[24]||(e[24]=o("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Görüntülenme Sayısı",-1)),o("input",{type:"number",value:l(t).views_count,onInput:e[13]||(e[13]=s=>l(t).views_count=s.target.value),class:"flex h-9 w-full rounded border border-input bg-muted px-3 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50",readonly:""},null,40,tt)]),o("div",st,[o("label",rt,[C(o("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>l(t).hasDraw=s),class:"h-4 w-4 rounded border-input text-primary"},null,512),[[ke,l(t).hasDraw]]),e[25]||(e[25]=o("span",{class:"text-xs text-foreground"},"Çizim İçerir",-1))])])]),U.value?(d(),u("div",ot,[...e[26]||(e[26]=[o("div",{class:"flex items-center gap-2 text-sm text-destructive"},[o("svg",{class:"h-5 w-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),o("span",null,'İçerikte base64 formatında resim var. Lütfen resimleri yukarıdaki "Resim Yükle" panelinden yükleyin ve editöre ekleyin.')],-1)])])):m("",!0),o("div",lt,[o("button",{type:"button",onClick:W,class:"inline-flex h-9 items-center justify-center rounded-md border border-input bg-background px-4 text-sm font-medium ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:l(t).processing}," Sıfırla ",8,it),o("button",{type:"submit",class:"inline-flex h-9 items-center justify-center rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:l(t).processing||!l(t).title||!l(t).slug||!l(t).content||!l(t).category_id||U.value},[l(t).processing?(d(),u("svg",at,[...e[27]||(e[27]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("",!0),we(" "+b(l(t).processing?"Kaydediliyor...":"Kaydet"),1)],8,nt)])],32)])}}});export{pt as default};
