import{Q as q,p as v,e as f,m as K,c as u,a as t,t as a,F as D,g as j,h as p,n as b,k as $,v as X,D as Z,N as J,E as ee,o as d}from"./ssr-DE0PqSHa.js";import{g}from"./index-CH_iu5NA.js";import{_ as te}from"./app-Vsdp8_Ja.js";/* empty css            */const re={class:"flex flex-col items-center justify-center"},ne={key:0,class:"w-full max-w-2xl rounded-lg border border-border bg-card p-6 shadow-sm"},se={class:"mb-4 text-center"},oe={class:"inline-flex items-center gap-2 rounded bg-muted px-3 py-1"},ae={class:"text-lg font-bold text-foreground"},ie={class:"mb-4 grid grid-cols-2 gap-4"},le={class:"rounded border border-border bg-muted p-3 text-center"},ue={class:"mb-1"},de={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30"},ce={class:"text-sm font-bold text-green-600 dark:text-green-400"},ge={class:"rounded border border-border bg-muted p-3 text-center"},fe={class:"mb-1"},me={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30"},ve={class:"text-sm font-bold text-red-600 dark:text-red-400"},pe={class:"mb-4"},xe={class:"max-h-48 space-y-2 overflow-y-auto"},be={class:"flex items-center gap-2"},he={class:"flex flex-col"},we={class:"text-sm font-medium text-foreground"},_e={class:"text-muted-foreground text-xs"},ye={class:"space-y-2"},ke=["disabled"],Ce={class:"flex gap-2"},Ie={class:"relative mb-4 h-1 w-full overflow-hidden rounded-full bg-muted"},Qe={class:"text-muted-foreground mb-4 text-right text-sm"},Se={class:"mb-2 text-2xl font-semibold text-foreground"},Ae={class:"flex items-center justify-between"},Re={class:"inline-flex items-center rounded border border-border bg-muted px-2 py-1 text-xs text-foreground"},Te={key:0,class:"rounded border border-border bg-muted p-3"},De={key:0,class:"mt-1 text-sm text-foreground"},je={key:1,class:"mt-1 text-sm text-foreground"},Be={class:"space-y-4"},Pe=["disabled"],Me=["disabled"],He={class:"mt-1 text-foreground"},ze={key:0,class:"mt-3"},We={class:"mt-1 list-inside list-disc space-y-1 text-sm text-foreground"},Le={__name:"TranslateWord",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(B,{emit:P}){const c=B,w=P,_=q(),M=_.props.languagePacks||[],y=v(()=>{var n;return!!((n=_.props.auth)!=null&&n.user)});v(()=>c.packSlug?M.find(n=>n.slug===c.packSlug):null);const e=f({isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),x=f([]),k=v(()=>Object.fromEntries(x.value.map(n=>[n.id,n]))),C=f(null),h=f(null),I=f(null),i=f(null),m=f(!1),H=()=>{g.fromTo(I.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),g.fromTo(i.value,{opacity:0,y:10},{opacity:1,y:0,duration:.3,delay:.2,ease:"power2.out"})},z=()=>{g.timeline().to(i.value,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}).to(i.value,{scale:1,duration:.2,ease:"power2.out"});const r=50,s=["#34d399","#10b981","#059669"];for(let l=0;l<r;l++){const o=document.createElement("div");o.style.position="absolute",o.style.width="8px",o.style.height="8px",o.style.backgroundColor=s[Math.floor(Math.random()*s.length)],o.style.borderRadius="50%",document.body.appendChild(o);const R=i.value.getBoundingClientRect().left+i.value.offsetWidth/2,T=i.value.getBoundingClientRect().top;g.fromTo(o,{x:R,y:T,scale:0},{x:R+(Math.random()-.5)*200,y:T-100-Math.random()*100,scale:1,opacity:0,duration:1,ease:"power4.out",onComplete:()=>o.remove()})}},W=()=>{g.timeline().to(i.value,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(i.value,{x:-10,duration:.1}).to(i.value,{x:10,duration:.1}).to(i.value,{x:-5,duration:.1}).to(i.value,{x:5,duration:.1}).to(i.value,{x:0,scale:1,duration:.2})},L=n=>{g.to(C.value,{width:`${n}%`,duration:.5,ease:"power2.out"}),g.fromTo(h.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),g.to(h.value,{opacity:n===100?0:.5,duration:.3})},Q=async()=>{if(!c.words||c.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let n=[...c.words];if(c.gameConfig.prioritizeUnlearned){const r=n.filter(o=>o.learning_status===0),s=n.filter(o=>o.learning_status===1),l=n.filter(o=>o.learning_status===2);n=[...r,...s,...l]}c.gameConfig.prioritizeRecentlyLearned&&n.sort((r,s)=>{const l=new Date(r.last_reviewed_at||0);return new Date(s.last_reviewed_at||0)-l}),c.gameConfig.prioritizeFlagged&&n.sort((r,s)=>r.is_flagged&&!s.is_flagged?-1:!r.is_flagged&&s.is_flagged?1:0),c.gameConfig.prioritizeMostIncorrect&&n.sort((r,s)=>{const l=r.incorrect_count||0;return(s.incorrect_count||0)-l}),n=n.sort(()=>Math.random()-.5),await new Promise(r=>{x.value=n,e.value.totalQuestions=x.value.length,e.value.currentIndex=0,e.value.userResponses=[],r()}),e.value.isLoading=!1,e.value.isPlaying=!0,S()},G=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},S=()=>{if(e.value.currentIndex>=x.value.length){U();return}e.value.currentQuestion=x.value[e.value.currentIndex],e.value.userInput="",e.value.showAnswer=!1,e.value.hintShown=!1,e.value.currentHintIndex=0,e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0&&(e.value.hintShown=!0,e.value.currentHintIndex=0),ee(()=>{H()})},A=()=>{if(!e.value.userInput.trim())return;const n=e.value.userInput.trim().toLowerCase(),s=(e.value.currentQuestion.meanings||[{meaning:e.value.currentQuestion.meaning}]).some(o=>o.meaning.toLowerCase()===n);e.value.isCorrect=s,e.value.userResponses.push({word_id:e.value.currentQuestion.id,correct:e.value.isCorrect}),e.value.showAnswer=!0,e.value.isCorrect?z():W();const l=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);L(l),setTimeout(()=>{g.set(i.value,{clearProps:"all"}),i.value.style.backgroundColor="",i.value.style.borderColor="",e.value.currentIndex++,e.value.userInput="",e.value.showAnswer=!1,e.value.progress=0,S()},2e3)},N=v(()=>{if(!e.value.userResponses.length)return 0;const n=e.value.userResponses.filter(r=>r.correct).length;return Math.round(n/e.value.userResponses.length*100)}),E=n=>{switch(n){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},U=()=>{e.value.isPlaying=!1},F=()=>{if(!y.value||!e.value.userResponses.length||m.value)return;m.value=!0;const n=e.value.userResponses.map(r=>({word_id:r.word_id,review_count:1,incorrect_count:r.correct?0:1}));J.post("/update-words",{words:n},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),m.value=!1,setTimeout(()=>{w("game-completed")},1e3)},onError:r=>{console.error("İstatistik güncelleme hatası:",r),m.value=!1}})},O=v(()=>e.value.userResponses.filter(n=>n.correct).length),V=v(()=>e.value.userResponses.filter(n=>!n.correct).length),Y=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,userInput:"",showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},Q()};return K(()=>{Q()}),(n,r)=>(d(),u("div",re,[!e.value.isPlaying&&e.value.userResponses.length>0?(d(),u("div",ne,[t("div",se,[r[3]||(r[3]=t("h2",{class:"mb-2 text-xl font-semibold text-foreground"},"Test Tamamlandı",-1)),t("div",oe,[r[2]||(r[2]=t("span",{class:"text-muted-foreground text-sm"},"Puan:",-1)),t("span",ae,a(N.value)+" / 100",1)])]),t("div",ie,[t("div",le,[t("div",ue,[t("div",de,[t("span",ce,a(O.value),1)])]),r[4]||(r[4]=t("p",{class:"text-muted-foreground text-xs"},"Doğru",-1))]),t("div",ge,[t("div",fe,[t("div",me,[t("span",ve,a(V.value),1)])]),r[5]||(r[5]=t("p",{class:"text-muted-foreground text-xs"},"Yanlış",-1))])]),t("div",pe,[r[6]||(r[6]=t("h3",{class:"mb-2 text-sm font-medium text-foreground"},"Cevaplarınız",-1)),t("div",xe,[(d(!0),u(D,null,j(e.value.userResponses,s=>{var l,o;return d(),u("div",{key:s.word_id,class:"flex items-center justify-between rounded border border-border bg-muted p-2"},[t("div",be,[t("div",{class:b(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",s.correct?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400"])},a(s.correct?"✓":"✗"),3),t("div",he,[t("span",we,a(((l=k.value[s.word_id])==null?void 0:l.word)||"Unknown"),1),t("span",_e,a(((o=k.value[s.word_id])==null?void 0:o.meaning)||""),1)])]),t("span",{class:b(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",s.correct?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400"])},a(s.correct?"Doğru":"Yanlış"),3)])}),128))])]),t("div",ye,[y.value?(d(),u("button",{key:0,onClick:F,class:"inline-flex w-full items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-primary/90",disabled:m.value},a(m.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,ke)):p("",!0),t("div",Ce,[t("button",{onClick:r[0]||(r[0]=s=>w("game-completed")),class:"flex-1 inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-primary/90"}," Pakete Dön "),t("button",{onClick:Y,class:"flex-1 inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground"}," Tekrar Başla ")])])])):(d(),u("div",{key:1,class:b(["relative w-full max-w-2xl rounded-lg border border-border bg-card p-6 shadow-sm transition-colors duration-500",{"bg-card":!e.value.showAnswer,"bg-green-50 dark:bg-green-900/10":e.value.showAnswer&&e.value.isCorrect,"bg-red-50 dark:bg-red-900/10":e.value.showAnswer&&!e.value.isCorrect}])},[t("div",Ie,[t("div",{ref_key:"progressBar",ref:C,class:"h-full w-0 bg-primary"},null,512),t("div",{ref_key:"progressBarGlow",ref:h,class:"absolute left-0 top-0 h-full w-[50px] bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,512)]),t("div",Qe," Soru "+a(e.value.currentIndex+1)+" / "+a(e.value.totalQuestions),1),e.value.currentQuestion?(d(),u("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:I},[t("div",null,[t("h2",Se,'"'+a(e.value.currentQuestion.word)+'"',1),r[7]||(r[7]=t("p",{class:"text-muted-foreground mb-3"},"Bu kelimenin anlamı nedir?",-1)),t("div",Ae,[t("span",Re,a(E(e.value.currentQuestion.type)),1),!e.value.showAnswer&&e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>1?(d(),u("button",{key:0,onClick:G,class:"text-muted-foreground text-xs transition-colors hover:text-foreground"}," Sonraki İpucu ("+a(e.value.currentHintIndex+1)+"/"+a(e.value.currentQuestion.example_sentences.length)+") ",1)):p("",!0)])]),e.value.hintShown?(d(),u("div",Te,[r[8]||(r[8]=t("p",{class:"text-sm font-medium text-foreground"},"Örnek Cümle:",-1)),e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(d(),u("p",De,a(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)):(d(),u("p",je,"Bu kelime için örnek cümle bulunmuyor."))])):p("",!0),t("div",Be,[$(t("input",{ref_key:"answerInput",ref:i,"onUpdate:modelValue":r[1]||(r[1]=s=>e.value.userInput=s),type:"text",disabled:e.value.showAnswer,onKeyup:Z(A,["enter"]),placeholder:"Cevabınızı yazın...",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},null,40,Pe),[[X,e.value.userInput]]),t("button",{onClick:A,disabled:!e.value.userInput.trim()||e.value.showAnswer,class:"inline-flex w-full items-center justify-center rounded-md bg-primary px-4 py-3 text-sm font-medium text-primary-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-primary/90"},a(e.value.showAnswer?"Sonraki Soru":"Cevapla"),9,Me)]),e.value.showAnswer?(d(),u("div",{key:1,class:b(["mt-4 rounded border border-border p-4",{"bg-red-50 dark:bg-red-900/20":!e.value.isCorrect,"bg-green-50 dark:bg-green-900/20":e.value.isCorrect}])},[t("p",{class:b(["text-sm font-medium",{"text-red-600 dark:text-red-400":!e.value.isCorrect,"text-green-600 dark:text-green-400":e.value.isCorrect}])}," Doğru Cevap: ",2),t("p",He,a(e.value.currentQuestion.meaning),1),e.value.currentQuestion.meanings&&e.value.currentQuestion.meanings.length>1?(d(),u("div",ze,[r[9]||(r[9]=t("p",{class:"text-muted-foreground text-sm font-medium"},"Diğer Anlamlar:",-1)),t("ul",We,[(d(!0),u(D,null,j(e.value.currentQuestion.meanings,(s,l)=>(d(),u("li",{key:l},a(s.meaning),1))),128))])])):p("",!0)],2)):p("",!0)],512)):p("",!0)],2))]))}},Fe=te(Le,[["__scopeId","data-v-77f344b1"]]);export{Fe as default};
