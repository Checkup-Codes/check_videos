import{e as c,Q as me,p as j,T as pe,m as Q,D as L,y as V,A as ge,c as n,a as l,k as g,h as m,v as h,u as o,n as k,t as p,b as xe,J as X,F as Z,g as ee,I as ye,f as he,l as we,N as ke,o as d}from"./ssr-Dd8vfvSV.js";import _e from"./RichTextEditor-Df2gKquW.js";import"./quill-DVXvsZRj.js";import"./app-DPZOeyyi.js";/* empty css            */const Se={class:"space-y-4 py-6"},Ce={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Te={key:0,class:"mt-1 text-xs text-destructive"},Ve={key:0,class:"mt-1 text-xs text-destructive"},Ee={class:"flex gap-2"},ze={key:0,class:"mt-1 text-xs text-destructive"},Le={key:0,class:"mt-1 text-xs text-destructive"},Re={class:"relative"},Ue={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},De=["onMousedown"],Me={key:0,class:"mt-1 text-xs text-destructive"},Oe={class:"relative"},je={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Ae=["onMousedown"],Fe={class:"flex flex-col"},Pe={key:0,class:"text-xs text-muted-foreground"},$e={key:0,class:"mt-1 text-xs text-destructive"},Be={key:0,class:"mt-1 text-xs text-destructive"},Ie={key:0,class:"mt-1 text-xs text-destructive"},Ne={class:"mt-1 flex items-center justify-between"},Ke={key:0,class:"text-xs text-destructive"},Ge={class:"text-xs text-muted-foreground"},Ye={class:"flex items-center"},qe={class:"flex cursor-pointer items-center gap-2"},He={class:"flex justify-end gap-2 pt-2"},Je=["disabled"],We={key:0,class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ot=Object.assign({name:"WriteUpdateForm"},{__name:"WriteUpdateForm",setup(Qe){const A=c(null),F=c(null),P=c(null),$=c(null),B=c(null),I=c(null),N=c(null),{props:K}=me(),te=r=>{const e=[],a=new Set,s=f=>{!f||!Array.isArray(f)||f.forEach(u=>{u&&u.id&&!a.has(u.id)&&(a.add(u.id),e.push(u),u.children&&Array.isArray(u.children)&&u.children.length>0&&s(u.children))})};return s(r),e},se=c(K.categories||[]),x=j(()=>te(se.value)),v=c(K.write),_=c(""),S=c(!1),G=c(null),T=[{value:"published",label:"Herkese Açık"},{value:"private",label:"Gizli"},{value:"link_only",label:"Sadece Link"}],w=c(""),C=c(!1),Y=c(null),q=j(()=>{if(!w.value)return T;const r=T.find(a=>a.value===t.status);if(r&&w.value===r.label)return T;const e=w.value.toLowerCase();return T.filter(a=>a.label.toLowerCase().includes(e))}),t=pe({title:v.value.title||"",slug:v.value.slug||"",content:v.value.content||"",published_at:v.value.published_at||"",summary:v.value.summary||"",status:v.value.status||"published",category_id:v.value.category_id||"",seo_keywords:v.value.seo_keywords||"",meta_description:v.value.meta_description||"",tags:v.value.tags||"",views_count:v.value.views_count||0,hasDraw:v.value.hasDraw||!1}),i=c({title:"",slug:"",content:"",published_at:"",summary:"",status:"",category_id:"",seo_keywords:"",meta_description:"",tags:""}),b=c({date:"",time:""}),R=r=>{if(!r||!x.value||x.value.length===0)return"";const e=f=>x.value.find(u=>u.id===f),a=(f,u=[])=>{const y=e(f);return y?(u.unshift(y.name),y.parent_id?a(y.parent_id,u):u):u},s=a(r);return s.length>1?s.slice(0,-1).join(" > "):""},U=r=>{if(!r||!x.value||x.value.length===0)return"";const e=f=>x.value.find(u=>u.id===f),a=(f,u=[])=>{const y=e(f);return y?(u.unshift(y.name),y.parent_id?a(y.parent_id,u):u):u};return a(r).join(" > ")},E=j(()=>{if(!x.value||x.value.length===0)return[];if(!_.value){const s=[],f=new Set;return x.value.forEach(u=>{u&&u.id&&!f.has(u.id)&&(f.add(u.id),s.push(u))}),s}const r=_.value.toLowerCase(),e=[],a=new Set;return x.value.forEach(s=>{if(!s||!s.name||a.has(s.id))return;const f=s.name.toLowerCase().includes(r),y=R(s.id).toLowerCase().includes(r),be=U(s.id).toLowerCase().includes(r);(f||y||be)&&(a.add(s.id),e.push(s))}),e}),re=()=>{_.value.length>=1&&(S.value=!0)},oe=()=>{clearTimeout(G.value),E.value.length>0&&(S.value=!0)},le=()=>{G.value=setTimeout(()=>{S.value=!1},100)},ie=r=>{if(!r||!r.id)return;t.category_id=r.id;const e=U(r.id);_.value=e,L(()=>{S.value=!1})},ue=()=>{_.value="",t.category_id="",S.value=!1},ae=()=>{w.value.length>=1&&(C.value=!0)},ne=()=>{clearTimeout(Y.value),C.value=!0},de=()=>{Y.value=setTimeout(()=>{C.value=!1},100)},ce=r=>{!r||!r.value||(t.status=r.value,w.value=r.label,L(()=>{C.value=!1}))},fe=()=>{w.value="",t.status="",C.value=!1},D=c(!0);Q(()=>{if(t.published_at){const e=new Date(t.published_at);isNaN(e.getTime())||(b.value.date=e.toISOString().split("T")[0],b.value.time=e.toTimeString().substring(0,5))}if(t.category_id){const e=x.value.find(a=>a.id===t.category_id);if(e){const a=U(e.id);_.value=a}}const r=T.find(e=>e.value===t.status);r&&(w.value=r.label),t.slug&&t.slug!==""&&(O.value=!0),document.addEventListener("keydown",e=>{e.key==="Escape"&&(S.value=!1,C.value=!1)}),L(()=>{setTimeout(()=>{D.value=!1},100)})}),V(b.value,()=>{D.value||b.value.date&&b.value.time&&(t.published_at=`${b.value.date}T${b.value.time}:00`)},{deep:!0});const H=()=>{L(()=>{var a;const e=[{ref:A,error:i.value.title||t.errors.title},{ref:F,error:i.value.slug||t.errors.slug},{ref:B,error:i.value.content||t.errors.content},{ref:N,error:i.value.category_id||t.errors.category_id},{ref:P,error:i.value.published_at||t.errors.published_at},{ref:$,error:i.value.summary||t.errors.summary},{ref:I,error:i.value.status||t.errors.status}].find(s=>s.error);if(e&&((a=e.ref)!=null&&a.value)){e.ref.value.scrollIntoView({behavior:"smooth",block:"center"});const s=e.ref.value.querySelector("input, textarea");s&&setTimeout(()=>s.focus(),300)}})},ve=()=>{Object.keys(i.value).forEach(e=>{i.value[e]=""});let r=!1;return(!t.title||t.title.trim()==="")&&(i.value.title="Başlık zorunludur.",r=!0),(!t.slug||t.slug.trim()==="")&&(i.value.slug="Slug zorunludur.",r=!0),(!t.content||t.content.trim()===""||t.content==="<p><br></p>")&&(i.value.content="İçerik zorunludur.",r=!0),t.category_id||(i.value.category_id="Kategori seçilmelidir.",r=!0),b.value.date&&b.value.time?t.published_at=`${b.value.date}T${b.value.time}:00`:t.published_at=null,r&&H(),!r},M=`write_edit_form_${v.value.id||v.value.slug||"unknown"}`;V(t,r=>{D.value||localStorage.setItem(M,JSON.stringify(r))},{deep:!0}),V(()=>t.processing,r=>{window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:r}}))});let z=null;const J=localStorage.getItem(M);if(J)try{const r=JSON.parse(J);if(r&&typeof r=="object"){const{processing:e,...a}=r;Object.assign(t,a)}}catch(r){console.error("Error loading saved form data:",r)}Q(()=>{z=()=>{W()},window.addEventListener("sidebarFormSubmit",z)}),ge(()=>{z&&window.removeEventListener("sidebarFormSubmit",z)});const W=()=>{ve()&&t.put(route("writes.update",{write:v.value.slug}),{onSuccess:()=>{localStorage.removeItem(M),ke.visit(route("writes.show",{write:t.slug}))},onError:r=>{r&&(Object.keys(r).forEach(e=>{i.value.hasOwnProperty(e)&&(i.value[e]=r[e])}),H())}})};let O=c(!1);return V(()=>t.title,r=>{!O.value&&r&&(t.slug=r.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").trim())}),V(()=>t.slug,(r,e)=>{e!==void 0&&r!==e&&e!==""&&(O.value=!0)}),(r,e)=>{var a;return d(),n("div",Se,[l("form",{onSubmit:we(W,["prevent"]),class:"space-y-4"},[l("div",Ce,[l("div",{class:"md:col-span-2",ref_key:"titleRef",ref:A},[e[15]||(e[15]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Başlık",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>o(t).title=s),placeholder:"Yazının başlığını girin",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.title||o(t).errors.title}])},null,2),[[h,o(t).title]]),i.value.title||o(t).errors.title?(d(),n("p",Te,p(i.value.title||o(t).errors.title),1)):m("",!0)],512),l("div",{ref_key:"slugRef",ref:F},[e[16]||(e[16]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Slug",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>o(t).slug=s),placeholder:"örnek-yazı-slug",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.slug||o(t).errors.slug}])},null,2),[[h,o(t).slug]]),i.value.slug||o(t).errors.slug?(d(),n("p",Ve,p(i.value.slug||o(t).errors.slug),1)):m("",!0)],512),l("div",{ref_key:"publishedAtRef",ref:P},[e[17]||(e[17]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Yayınlama Tarihi",-1)),l("div",Ee,[g(l("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>b.value.date=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||o(t).errors.published_at}])},null,2),[[h,b.value.date]]),g(l("input",{type:"time","onUpdate:modelValue":e[3]||(e[3]=s=>b.value.time=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||o(t).errors.published_at}])},null,2),[[h,b.value.time]])]),i.value.published_at||o(t).errors.published_at?(d(),n("p",ze,p(i.value.published_at||o(t).errors.published_at),1)):m("",!0)],512),l("div",{class:"md:col-span-2",ref_key:"summaryRef",ref:$},[e[18]||(e[18]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Özet",-1)),g(l("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(t).summary=s),rows:"2",placeholder:"Yazının kısa özeti",class:k(["flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.summary||o(t).errors.summary}])},null,2),[[h,o(t).summary]]),i.value.summary||o(t).errors.summary?(d(),n("p",Le,p(i.value.summary||o(t).errors.summary),1)):m("",!0)],512),l("div",{class:"md:col-span-2",ref_key:"contentRef",ref:B},[xe(_e,{modelValue:o(t).content,"onUpdate:modelValue":e[5]||(e[5]=s=>o(t).content=s),label:"İçerik",error:i.value.content||o(t).errors.content,placeholder:"İçeriği buraya yazın...",height:"400px"},null,8,["modelValue","error"])],512),l("div",{ref_key:"statusRef",ref:I},[e[19]||(e[19]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Durumu",-1)),l("div",Re,[g(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>w.value=s),onFocus:ne,onBlur:de,onInput:ae,onKeydown:e[7]||(e[7]=X(s=>C.value=!1,["esc"])),placeholder:"Durum seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.status||o(t).errors.status}]),tabindex:"0"},null,34),[[h,w.value]]),w.value?(d(),n("button",{key:0,onClick:fe,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),C.value&&q.value.length>0?(d(),n("ul",Ue,[(d(!0),n(Z,null,ee(q.value,s=>(d(),n("li",{key:s.value,onMousedown:f=>ce(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},p(s.label),41,De))),128))])):m("",!0)]),i.value.status||o(t).errors.status?(d(),n("p",Me,p(i.value.status||o(t).errors.status),1)):m("",!0)],512),l("div",{ref_key:"categoryRef",ref:N},[e[20]||(e[20]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Kategori",-1)),l("div",Oe,[g(l("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>_.value=s),onFocus:oe,onBlur:le,onInput:re,onKeydown:e[9]||(e[9]=X(s=>S.value=!1,["esc"])),placeholder:"Kategori seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.category_id||o(t).errors.category_id}]),tabindex:"0"},null,34),[[h,_.value]]),_.value?(d(),n("button",{key:0,onClick:ue,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),S.value&&E.value&&E.value.length>0?(d(),n("ul",je,[(d(!0),n(Z,null,ee(E.value,s=>(d(),n("li",{key:s.id,onMousedown:f=>ie(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},[l("div",Fe,[l("span",null,p(s.name),1),R(s.id)?(d(),n("span",Pe,p(R(s.id)),1)):m("",!0)])],40,Ae))),128))])):m("",!0)]),i.value.category_id||o(t).errors.category_id?(d(),n("p",$e,p(i.value.category_id||o(t).errors.category_id),1)):m("",!0)],512),l("div",null,[e[21]||(e[21]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Etiketler",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=s=>o(t).tags=s),placeholder:"etiket1, etiket2, etiket3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.tags||o(t).errors.tags}])},null,2),[[h,o(t).tags]]),i.value.tags||o(t).errors.tags?(d(),n("p",Be,p(i.value.tags||o(t).errors.tags),1)):m("",!0)]),l("div",null,[e[22]||(e[22]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Anahtar Kelimeleri",-1)),g(l("input",{type:"text","onUpdate:modelValue":e[11]||(e[11]=s=>o(t).seo_keywords=s),placeholder:"anahtar1, anahtar2, anahtar3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.seo_keywords||o(t).errors.seo_keywords}])},null,2),[[h,o(t).seo_keywords]]),i.value.seo_keywords||o(t).errors.seo_keywords?(d(),n("p",Ie,p(i.value.seo_keywords||o(t).errors.seo_keywords),1)):m("",!0)]),l("div",null,[e[23]||(e[23]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Meta Açıklaması",-1)),g(l("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o(t).meta_description=s),placeholder:"Arama motorları için kısa bir açıklama (max 160 karakter)",class:k(["flex min-h-[60px] w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.meta_description||o(t).errors.meta_description}]),maxlength:"160",rows:"2"},null,2),[[h,o(t).meta_description]]),l("div",Ne,[i.value.meta_description||o(t).errors.meta_description?(d(),n("p",Ke,p(i.value.meta_description||o(t).errors.meta_description),1)):m("",!0),l("span",Ge,p(((a=o(t).meta_description)==null?void 0:a.length)||0)+"/160",1)])]),l("div",null,[e[24]||(e[24]=l("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Görüntülenme Sayısı",-1)),g(l("input",{type:"number","onUpdate:modelValue":e[13]||(e[13]=s=>o(t).views_count=s),class:"flex h-9 w-full rounded border border-input bg-muted px-3 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50",readonly:""},null,512),[[h,o(t).views_count]])]),l("div",Ye,[l("label",qe,[g(l("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>o(t).hasDraw=s),class:"h-4 w-4 rounded border-input text-primary"},null,512),[[ye,o(t).hasDraw]]),e[25]||(e[25]=l("span",{class:"text-xs text-foreground"},"Çizim İçerir",-1))])])]),l("div",He,[l("button",{type:"submit",class:"inline-flex h-9 items-center justify-center rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:o(t).processing},[o(t).processing?(d(),n("svg",We,[...e[26]||(e[26]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("",!0),he(" "+p(o(t).processing?"Güncelleniyor...":"Güncelle"),1)],8,Je)])],32)])}}});export{ot as default};
