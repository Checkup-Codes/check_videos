import{g as c,b as R,T as xe,Q as ye,s as X,H as z,y as T,x as he,c as a,a as r,j as m,i as g,m as h,u as o,n as k,t as p,f as Z,G as ee,F as te,l as se,I as we,k as ke,h as _e,N as Se,o as d}from"./ssr-D-O19Sjt.js";import Ce from"./RichTextEditor-DWTcFMbg.js";import{_ as Ee}from"./WriteImageUploader-DuIKvbeq.js";import"./quill-DUyr3fey.js";import"./app-Ld--xmxC.js";/* empty css            */const Te={class:"space-y-4 py-6"},Ve={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Le={key:0,class:"mt-1 text-xs text-destructive"},Re={key:0,class:"mt-1 text-xs text-destructive"},ze={class:"flex gap-2"},Me={key:0,class:"mt-1 text-xs text-destructive"},Ue={key:0,class:"mt-1 text-xs text-destructive"},Ie={class:"md:col-span-2"},je={class:"relative"},Fe={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Ae=["onMousedown"],De={key:0,class:"mt-1 text-xs text-destructive"},Oe={class:"relative"},Be={key:1,tabindex:"0",class:"absolute z-50 mt-1 max-h-48 w-full overflow-y-auto rounded border border-border bg-popover shadow-lg"},Pe=["onMousedown"],$e={class:"flex flex-col"},Ne={key:0,class:"text-xs text-muted-foreground"},Ke={key:0,class:"mt-1 text-xs text-destructive"},Ge={key:0,class:"mt-1 text-xs text-destructive"},Ye={key:0,class:"mt-1 text-xs text-destructive"},He={class:"mt-1 flex items-center justify-between"},qe={key:0,class:"text-xs text-destructive"},We={class:"text-xs text-muted-foreground"},Je={class:"flex items-center"},Qe={class:"flex cursor-pointer items-center gap-2"},Xe={key:0,class:"rounded-md border border-destructive bg-destructive/10 p-3"},Ze={class:"flex justify-end gap-2 pt-2"},et=["disabled"],tt={key:0,class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},dt=Object.assign({name:"WriteUpdateForm"},{__name:"WriteUpdateForm",setup(st){const A=c(null),D=c(null),O=c(null),B=c(null),P=c(null),$=c(null),N=c(null),M=c(null),K=R(()=>t.content?/data:image\/[^;]+;base64,/.test(t.content):!1),re=l=>{M.value&&M.value.insertImage(l.full_url,l.alt_text)},{props:G}=ye(),le=l=>{const e=[],u=new Set,s=f=>{!f||!Array.isArray(f)||f.forEach(n=>{n&&n.id&&!u.has(n.id)&&(u.add(n.id),e.push(n),n.children&&Array.isArray(n.children)&&n.children.length>0&&s(n.children))})};return s(l),e},oe=c(G.categories||[]),x=R(()=>le(oe.value)),v=c(G.write),_=c(""),S=c(!1),Y=c(null),E=[{value:"published",label:"Herkese Açık"},{value:"private",label:"Gizli"},{value:"link_only",label:"Sadece Link"}],w=c(""),C=c(!1),H=c(null),q=R(()=>{if(!w.value)return E;const l=E.find(u=>u.value===t.status);if(l&&w.value===l.label)return E;const e=w.value.toLowerCase();return E.filter(u=>u.label.toLowerCase().includes(e))}),t=xe({title:v.value.title||"",slug:v.value.slug||"",content:v.value.content||"",published_at:v.value.published_at||"",summary:v.value.summary||"",status:v.value.status||"published",category_id:v.value.category_id||"",seo_keywords:v.value.seo_keywords||"",meta_description:v.value.meta_description||"",tags:v.value.tags||"",views_count:v.value.views_count||0,hasDraw:v.value.hasDraw||!1}),i=c({title:"",slug:"",content:"",published_at:"",summary:"",status:"",category_id:"",seo_keywords:"",meta_description:"",tags:""}),b=c({date:"",time:""}),U=l=>{if(!l||!x.value||x.value.length===0)return"";const e=f=>x.value.find(n=>n.id===f),u=(f,n=[])=>{const y=e(f);return y?(n.unshift(y.name),y.parent_id?u(y.parent_id,n):n):n},s=u(l);return s.length>1?s.slice(0,-1).join(" > "):""},I=l=>{if(!l||!x.value||x.value.length===0)return"";const e=f=>x.value.find(n=>n.id===f),u=(f,n=[])=>{const y=e(f);return y?(n.unshift(y.name),y.parent_id?u(y.parent_id,n):n):n};return u(l).join(" > ")},V=R(()=>{if(!x.value||x.value.length===0)return[];if(!_.value){const s=[],f=new Set;return x.value.forEach(n=>{n&&n.id&&!f.has(n.id)&&(f.add(n.id),s.push(n))}),s}const l=_.value.toLowerCase(),e=[],u=new Set;return x.value.forEach(s=>{if(!s||!s.name||u.has(s.id))return;const f=s.name.toLowerCase().includes(l),y=U(s.id).toLowerCase().includes(l),ge=I(s.id).toLowerCase().includes(l);(f||y||ge)&&(u.add(s.id),e.push(s))}),e}),ie=()=>{_.value.length>=1&&(S.value=!0)},ne=()=>{clearTimeout(Y.value),V.value.length>0&&(S.value=!0)},ue=()=>{Y.value=setTimeout(()=>{S.value=!1},100)},ae=l=>{if(!l||!l.id)return;t.category_id=l.id;const e=I(l.id);_.value=e,z(()=>{S.value=!1})},de=()=>{_.value="",t.category_id="",S.value=!1},ce=()=>{w.value.length>=1&&(C.value=!0)},fe=()=>{clearTimeout(H.value),C.value=!0},ve=()=>{H.value=setTimeout(()=>{C.value=!1},100)},me=l=>{!l||!l.value||(t.status=l.value,w.value=l.label,z(()=>{C.value=!1}))},be=()=>{w.value="",t.status="",C.value=!1},j=c(!0);X(()=>{if(t.published_at){const e=new Date(t.published_at);isNaN(e.getTime())||(b.value.date=e.toISOString().split("T")[0],b.value.time=e.toTimeString().substring(0,5))}if(t.category_id){const e=x.value.find(u=>u.id===t.category_id);if(e){const u=I(e.id);_.value=u}}const l=E.find(e=>e.value===t.status);l&&(w.value=l.label),t.slug&&t.slug!==""&&(F.value=!0),document.addEventListener("keydown",e=>{e.key==="Escape"&&(S.value=!1,C.value=!1)}),z(()=>{setTimeout(()=>{j.value=!1},100)})}),T(b.value,()=>{j.value||b.value.date&&b.value.time&&(t.published_at=`${b.value.date}T${b.value.time}:00`)},{deep:!0});const W=()=>{z(()=>{var u;const e=[{ref:A,error:i.value.title||t.errors.title},{ref:D,error:i.value.slug||t.errors.slug},{ref:P,error:i.value.content||t.errors.content},{ref:N,error:i.value.category_id||t.errors.category_id},{ref:O,error:i.value.published_at||t.errors.published_at},{ref:B,error:i.value.summary||t.errors.summary},{ref:$,error:i.value.status||t.errors.status}].find(s=>s.error);if(e&&((u=e.ref)!=null&&u.value)){e.ref.value.scrollIntoView({behavior:"smooth",block:"center"});const s=e.ref.value.querySelector("input, textarea");s&&setTimeout(()=>s.focus(),300)}})},pe=()=>{Object.keys(i.value).forEach(e=>{i.value[e]=""});let l=!1;return(!t.title||t.title.trim()==="")&&(i.value.title="Başlık zorunludur.",l=!0),(!t.slug||t.slug.trim()==="")&&(i.value.slug="Slug zorunludur.",l=!0),(!t.content||t.content.trim()===""||t.content==="<p><br></p>")&&(i.value.content="İçerik zorunludur.",l=!0),t.category_id||(i.value.category_id="Kategori seçilmelidir.",l=!0),b.value.date&&b.value.time?t.published_at=`${b.value.date}T${b.value.time}:00`:t.published_at=null,l&&W(),!l},J=`write_edit_form_${v.value.id||v.value.slug||"unknown"}`;T(t,l=>{j.value||localStorage.setItem(J,JSON.stringify(l))},{deep:!0}),T(()=>t.processing,l=>{window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:l}}))});let L=null;X(()=>{t.processing=!1,window.dispatchEvent(new CustomEvent("formProcessingState",{detail:{processing:!1}})),L=()=>{Q()},window.addEventListener("sidebarFormSubmit",L)}),he(()=>{L&&window.removeEventListener("sidebarFormSubmit",L)});const Q=()=>{pe()&&t.put(route("writes.update",{write:v.value.slug}),{onSuccess:()=>{localStorage.removeItem(J),Se.visit(route("writes.show",{write:t.slug}))},onError:l=>{l&&(Object.keys(l).forEach(e=>{i.value.hasOwnProperty(e)&&(i.value[e]=l[e])}),W())}})};let F=c(!1);return T(()=>t.title,l=>{!F.value&&l&&(t.slug=l.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").trim())}),T(()=>t.slug,(l,e)=>{e!==void 0&&l!==e&&e!==""&&(F.value=!0)}),(l,e)=>{var u;return d(),a("div",Te,[r("form",{onSubmit:_e(Q,["prevent"]),class:"space-y-4"},[r("div",Ve,[r("div",{class:"md:col-span-2",ref_key:"titleRef",ref:A},[e[15]||(e[15]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Başlık",-1)),g(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>o(t).title=s),placeholder:"Yazının başlığını girin",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.title||o(t).errors.title}])},null,2),[[h,o(t).title]]),i.value.title||o(t).errors.title?(d(),a("p",Le,p(i.value.title||o(t).errors.title),1)):m("",!0)],512),r("div",{ref_key:"slugRef",ref:D},[e[16]||(e[16]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Slug",-1)),g(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>o(t).slug=s),placeholder:"örnek-yazı-slug",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.slug||o(t).errors.slug}])},null,2),[[h,o(t).slug]]),i.value.slug||o(t).errors.slug?(d(),a("p",Re,p(i.value.slug||o(t).errors.slug),1)):m("",!0)],512),r("div",{ref_key:"publishedAtRef",ref:O},[e[17]||(e[17]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Yayınlama Tarihi",-1)),r("div",ze,[g(r("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>b.value.date=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||o(t).errors.published_at}])},null,2),[[h,b.value.date]]),g(r("input",{type:"time","onUpdate:modelValue":e[3]||(e[3]=s=>b.value.time=s),class:k(["flex h-9 flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.published_at||o(t).errors.published_at}])},null,2),[[h,b.value.time]])]),i.value.published_at||o(t).errors.published_at?(d(),a("p",Me,p(i.value.published_at||o(t).errors.published_at),1)):m("",!0)],512),r("div",{class:"md:col-span-2",ref_key:"summaryRef",ref:B},[e[18]||(e[18]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Özet",-1)),g(r("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(t).summary=s),rows:"2",placeholder:"Yazının kısa özeti",class:k(["flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.summary||o(t).errors.summary}])},null,2),[[h,o(t).summary]]),i.value.summary||o(t).errors.summary?(d(),a("p",Ue,p(i.value.summary||o(t).errors.summary),1)):m("",!0)],512),r("div",{class:"md:col-span-2",ref_key:"contentRef",ref:P},[Z(Ce,{ref_key:"richTextEditorRef",ref:M,modelValue:o(t).content,"onUpdate:modelValue":e[5]||(e[5]=s=>o(t).content=s),label:"İçerik",error:i.value.content||o(t).errors.content,placeholder:"İçeriği buraya yazın...",height:"400px"},null,8,["modelValue","error"])],512),r("div",Ie,[Z(Ee,{"write-id":v.value.id,category:"writes",onInsertImage:re},null,8,["write-id"])]),r("div",{ref_key:"statusRef",ref:$},[e[19]||(e[19]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Durumu",-1)),r("div",je,[g(r("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>w.value=s),onFocus:fe,onBlur:ve,onInput:ce,onKeydown:e[7]||(e[7]=ee(s=>C.value=!1,["esc"])),placeholder:"Durum seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.status||o(t).errors.status}]),tabindex:"0"},null,34),[[h,w.value]]),w.value?(d(),a("button",{key:0,onClick:be,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),C.value&&q.value.length>0?(d(),a("ul",Fe,[(d(!0),a(te,null,se(q.value,s=>(d(),a("li",{key:s.value,onMousedown:f=>me(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},p(s.label),41,Ae))),128))])):m("",!0)]),i.value.status||o(t).errors.status?(d(),a("p",De,p(i.value.status||o(t).errors.status),1)):m("",!0)],512),r("div",{ref_key:"categoryRef",ref:N},[e[20]||(e[20]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Kategori",-1)),r("div",Oe,[g(r("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>_.value=s),onFocus:ne,onBlur:ue,onInput:ie,onKeydown:e[9]||(e[9]=ee(s=>S.value=!1,["esc"])),placeholder:"Kategori seçin...",class:k(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 pr-8 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":i.value.category_id||o(t).errors.category_id}]),tabindex:"0"},null,34),[[h,_.value]]),_.value?(d(),a("button",{key:0,onClick:de,class:"absolute right-2 top-1/2 inline-flex h-5 w-5 -translate-y-1/2 items-center justify-center rounded text-xs hover:bg-accent"}," ✕ ")):m("",!0),S.value&&V.value&&V.value.length>0?(d(),a("ul",Be,[(d(!0),a(te,null,se(V.value,s=>(d(),a("li",{key:s.id,onMousedown:f=>ae(s),class:"cursor-pointer px-2 py-1.5 text-sm hover:bg-accent"},[r("div",$e,[r("span",null,p(s.name),1),U(s.id)?(d(),a("span",Ne,p(U(s.id)),1)):m("",!0)])],40,Pe))),128))])):m("",!0)]),i.value.category_id||o(t).errors.category_id?(d(),a("p",Ke,p(i.value.category_id||o(t).errors.category_id),1)):m("",!0)],512),r("div",null,[e[21]||(e[21]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Etiketler",-1)),g(r("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=s=>o(t).tags=s),placeholder:"etiket1, etiket2, etiket3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.tags||o(t).errors.tags}])},null,2),[[h,o(t).tags]]),i.value.tags||o(t).errors.tags?(d(),a("p",Ge,p(i.value.tags||o(t).errors.tags),1)):m("",!0)]),r("div",null,[e[22]||(e[22]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Anahtar Kelimeleri",-1)),g(r("input",{type:"text","onUpdate:modelValue":e[11]||(e[11]=s=>o(t).seo_keywords=s),placeholder:"anahtar1, anahtar2, anahtar3",class:k(["flex h-9 w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.seo_keywords||o(t).errors.seo_keywords}])},null,2),[[h,o(t).seo_keywords]]),i.value.seo_keywords||o(t).errors.seo_keywords?(d(),a("p",Ye,p(i.value.seo_keywords||o(t).errors.seo_keywords),1)):m("",!0)]),r("div",null,[e[23]||(e[23]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"SEO Meta Açıklaması",-1)),g(r("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o(t).meta_description=s),placeholder:"Arama motorları için kısa bir açıklama (max 160 karakter)",class:k(["flex min-h-[60px] w-full rounded border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":i.value.meta_description||o(t).errors.meta_description}]),maxlength:"160",rows:"2"},null,2),[[h,o(t).meta_description]]),r("div",He,[i.value.meta_description||o(t).errors.meta_description?(d(),a("p",qe,p(i.value.meta_description||o(t).errors.meta_description),1)):m("",!0),r("span",We,p(((u=o(t).meta_description)==null?void 0:u.length)||0)+"/160",1)])]),r("div",null,[e[24]||(e[24]=r("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Görüntülenme Sayısı",-1)),g(r("input",{type:"number","onUpdate:modelValue":e[13]||(e[13]=s=>o(t).views_count=s),class:"flex h-9 w-full rounded border border-input bg-muted px-3 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50",readonly:""},null,512),[[h,o(t).views_count]])]),r("div",Je,[r("label",Qe,[g(r("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>o(t).hasDraw=s),class:"h-4 w-4 rounded border-input text-primary"},null,512),[[we,o(t).hasDraw]]),e[25]||(e[25]=r("span",{class:"text-xs text-foreground"},"Çizim İçerir",-1))])])]),K.value?(d(),a("div",Xe,[...e[26]||(e[26]=[r("div",{class:"flex items-center gap-2 text-sm text-destructive"},[r("svg",{class:"h-5 w-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),r("span",null,'İçerikte base64 formatında resim var. Lütfen resimleri yukarıdaki "Resim Yükle" panelinden yükleyin ve editöre ekleyin.')],-1)])])):m("",!0),r("div",Ze,[r("button",{type:"submit",class:"inline-flex h-9 items-center justify-center rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:o(t).processing||K.value},[o(t).processing?(d(),a("svg",tt,[...e[27]||(e[27]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("",!0),ke(" "+p(o(t).processing?"Güncelleniyor...":"Güncelle"),1)],8,et)])],32)])}}});export{dt as default};
