import{Q as X,b as f,g as m,s as ee,c as i,a as r,t as o,F as j,l as M,j as h,n as _,N as te,o as l,k as re,H as ne}from"./ssr-ig3NHSec.js";import{g as c}from"./index-CH_iu5NA.js";import{_ as se}from"./app-BD4itwoa.js";/* empty css            */const oe={class:"flex flex-col items-center justify-center"},ae={key:0,class:"w-full max-w-2xl rounded-lg border border-border bg-card p-6 shadow-sm"},ie={class:"mb-4 text-center"},le={class:"inline-flex items-center gap-2 rounded bg-muted px-3 py-1"},ue={class:"text-lg font-bold text-foreground"},de={class:"mb-4 grid grid-cols-2 gap-4"},ce={class:"rounded border border-border bg-muted p-3 text-center"},ge={class:"mb-1"},fe={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30"},me={class:"text-sm font-bold text-green-600 dark:text-green-400"},xe={class:"rounded border border-border bg-muted p-3 text-center"},ve={class:"mb-1"},pe={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30"},be={class:"text-sm font-bold text-red-600 dark:text-red-400"},he={class:"mb-4"},_e={class:"max-h-48 space-y-2 overflow-y-auto"},we={class:"flex items-center gap-2"},ye={class:"flex flex-col"},ke={class:"text-sm font-medium text-foreground"},Ce={class:"text-muted-foreground text-xs"},Ie={class:"space-y-2"},Qe=["disabled"],Se={class:"flex gap-2"},Ae={key:1,class:"w-full max-w-4xl rounded-lg border border-border bg-card p-6 shadow-sm"},Oe={class:"mb-4 h-1 w-full overflow-hidden rounded-full bg-muted"},Te={class:"mb-6 text-right"},je={class:"text-muted-foreground text-sm"},Me={class:"mb-2 text-2xl font-semibold text-foreground"},Re={class:"inline-flex items-center rounded border border-border bg-muted px-2 py-1 text-xs text-foreground"},Pe={key:0,class:"rounded border border-border bg-muted p-3"},We={class:"mb-2 flex items-center justify-between"},De={class:"text-sm text-foreground"},He=["onClick","disabled"],Be={class:"flex items-center gap-3"},ze={class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary text-xs font-bold text-primary-foreground"},Le={key:1,class:"text-center"},Ne={__name:"MultipleChoice",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(R,{emit:P}){const u=R,w=P,y=X(),W=y.props.languagePacks||[],k=f(()=>{var t;return!!((t=y.props.auth)!=null&&t.user)});f(()=>u.packSlug?W.find(t=>t.slug===u.packSlug):null);const e=m({isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),x=m([]),C=f(()=>Object.fromEntries(x.value.map(t=>[t.id,t]))),I=m(null),Q=m(null),S=m(null),A=m(null),v=m(!1),D=()=>{c.fromTo(A.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),c.fromTo(I.value.children,{opacity:0,x:-20},{opacity:1,x:0,duration:.3,stagger:.1,ease:"power2.out"})},H=t=>{c.to(t,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}),c.to(t,{scale:1,duration:.2,delay:.2})},B=t=>{c.timeline().to(t,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(t,{x:-10,duration:.1}).to(t,{x:10,duration:.1}).to(t,{x:-5,duration:.1}).to(t,{x:5,duration:.1}).to(t,{x:0,scale:1,duration:.2})},z=t=>{c.to(Q.value,{width:`${t}%`,duration:.5,ease:"power2.out"}),c.fromTo(S.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),c.to(S.value,{opacity:t===100?0:.5,duration:.3})},L=()=>{e.value.currentIndex++,e.value.progress=Math.round(e.value.currentIndex/e.value.totalQuestions*100),e.value.currentIndex<e.value.totalQuestions?(e.value.selectedAnswer=null,e.value.showAnswer=!1,e.value.currentOptions=[],e.value.hintShown=x.value[e.value.currentIndex].example_sentences&&x.value[e.value.currentIndex].example_sentences.length>0,e.value.currentHintIndex=0,e.value.currentQuestion=x.value[e.value.currentIndex],ne(()=>{D()})):e.value.isPlaying=!1},O=async()=>{if(!u.words||u.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let t=[...u.words];if(u.gameConfig.prioritizeUnlearned){const s=t.filter(d=>d.learning_status===0),a=t.filter(d=>d.learning_status===1),g=t.filter(d=>d.learning_status===2);t=[...s,...a,...g]}u.gameConfig.prioritizeRecentlyLearned&&t.sort((s,a)=>{const g=new Date(s.last_reviewed_at||0);return new Date(a.last_reviewed_at||0)-g}),u.gameConfig.prioritizeFlagged&&t.sort((s,a)=>s.is_flagged&&!a.is_flagged?-1:!s.is_flagged&&a.is_flagged?1:0),u.gameConfig.prioritizeMostIncorrect&&t.sort((s,a)=>{const g=s.incorrect_count||0;return(a.incorrect_count||0)-g}),t=t.sort(()=>Math.random()-.5);const n=Math.min(u.gameConfig.questionCount,t.length);t=t.slice(0,n),e.value={isLoading:!1,isPlaying:!0,currentQuestion:t[0],currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:t.length,userResponses:[],hintShown:t[0].example_sentences&&t[0].example_sentences.length>0,currentHintIndex:0},x.value=t},N=f(()=>{if(!e.value.userResponses.length)return 0;const t=e.value.userResponses.filter(n=>n.correct).length;return Math.round(t/e.value.userResponses.length*100)}),G=t=>{switch(t){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},$=f(()=>e.value.userResponses.filter(t=>t.correct).length),E=f(()=>e.value.userResponses.filter(t=>!t.correct).length),F=f(()=>e.value.currentQuestion?(e.value.currentOptions.length===0&&(e.value.currentOptions=K(e.value.currentQuestion,x.value)),e.value.currentOptions):[]),U=t=>{e.value.selectedAnswer=t,e.value.showAnswer=!0,e.value.isCorrect=T(t,e.value.currentQuestion),e.value.userResponses.push({word_id:e.value.currentQuestion.id,selected_option:t.meaningText,correct:e.value.isCorrect});const n=event.target;e.value.isCorrect?H(n):B(n);const s=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);z(s),setTimeout(()=>{L()},1500)},q=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},O()},V=()=>{if(!k.value||!e.value.userResponses.length||v.value)return;v.value=!0;const t=e.value.userResponses.map(n=>({word_id:n.word_id,review_count:1,incorrect_count:n.correct?0:1}));te.post("/update-words",{words:t},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),v.value=!1,w("game-completed")},onError:n=>{console.error("İstatistik güncelleme hatası:",n),v.value=!1}})},Y=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},p=t=>{if(!t)return"";if(t.meanings&&t.meanings.length>0){const n=t.meanings.find(s=>s.is_primary);return n?n.meaning:t.meanings[0].meaning}return t.meaning||""},T=(t,n)=>!t||!n?!1:t.wordId===n.id,Z=t=>{var n;return((n=e.value.selectedAnswer)==null?void 0:n.wordId)===t.wordId},J=(t,n)=>e.value.showAnswer?T(t,e.value.currentQuestion)?"border-green-500 bg-green-50 dark:bg-green-900/30 text-green-800 dark:text-green-200":Z(t)?"border-red-500 bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-200":"border-border bg-background text-foreground":"border-border bg-background text-foreground",K=(t,n,s=4)=>{const a={wordId:t.id,meaningText:p(t),isCorrect:!0};return[...[...n.filter(b=>b.id!==t.id&&p(b)!==p(t))].sort(()=>.5-Math.random()).slice(0,s-1).map(b=>({wordId:b.id,meaningText:p(b),isCorrect:!1})),a].sort(()=>.5-Math.random())};return ee(()=>{O()}),(t,n)=>(l(),i("div",oe,[!e.value.isPlaying&&e.value.userResponses.length>0?(l(),i("div",ae,[r("div",ie,[n[2]||(n[2]=r("h2",{class:"mb-2 text-xl font-semibold text-foreground"},"Test Tamamlandı",-1)),r("div",le,[n[1]||(n[1]=r("span",{class:"text-muted-foreground text-sm"},"Puan:",-1)),r("span",ue,o(N.value)+" / 100",1)])]),r("div",de,[r("div",ce,[r("div",ge,[r("div",fe,[r("span",me,o($.value),1)])]),n[3]||(n[3]=r("p",{class:"text-muted-foreground text-xs"},"Doğru",-1))]),r("div",xe,[r("div",ve,[r("div",pe,[r("span",be,o(E.value),1)])]),n[4]||(n[4]=r("p",{class:"text-muted-foreground text-xs"},"Yanlış",-1))])]),r("div",he,[n[5]||(n[5]=r("h3",{class:"mb-2 text-sm font-medium text-foreground"},"Cevaplarınız",-1)),r("div",_e,[(l(!0),i(j,null,M(e.value.userResponses,s=>{var a;return l(),i("div",{key:s.word_id,class:"flex items-center justify-between rounded border border-border bg-muted p-2"},[r("div",we,[r("div",{class:_(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",s.correct?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400"])},o(s.correct?"✓":"✗"),3),r("div",ye,[r("span",ke,o(((a=C.value[s.word_id])==null?void 0:a.word)||"Unknown"),1),r("span",Ce,o(p(C.value[s.word_id])),1)])]),r("span",{class:_(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",s.correct?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400"])},o(s.correct?"Doğru":"Yanlış"),3)])}),128))])]),r("div",Ie,[k.value?(l(),i("button",{key:0,onClick:V,class:"inline-flex w-full items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-primary/90",disabled:v.value},o(v.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,Qe)):h("",!0),r("div",Se,[r("button",{onClick:n[0]||(n[0]=s=>w("game-completed")),class:"flex-1 inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-primary/90"}," Pakete Dön "),r("button",{onClick:q,class:"flex-1 inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground"}," Tekrar Başla ")])])])):(l(),i("div",Ae,[r("div",Oe,[r("div",{ref_key:"progressBar",ref:Q,class:"h-full w-0 bg-primary transition-all duration-500"},null,512)]),r("div",Te,[r("span",je," Soru "+o(e.value.currentIndex+1)+" / "+o(e.value.totalQuestions),1)]),e.value.currentQuestion?(l(),i("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:A},[r("div",null,[r("h2",Me,'"'+o(e.value.currentQuestion.word)+'"',1),n[6]||(n[6]=r("p",{class:"text-muted-foreground mb-3"},"Bu kelimenin anlamı nedir?",-1)),r("span",Re,o(G(e.value.currentQuestion.type)),1)]),e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(l(),i("div",Pe,[r("div",We,[n[7]||(n[7]=r("p",{class:"text-sm font-medium text-foreground"},"Örnek Cümle",-1)),e.value.currentQuestion.example_sentences.length>1?(l(),i("button",{key:0,onClick:Y,class:"text-muted-foreground text-xs transition-colors hover:text-foreground"}," Sonraki ("+o(e.value.currentHintIndex+1)+"/"+o(e.value.currentQuestion.example_sentences.length)+") ",1)):h("",!0)]),r("p",De,o(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)])):h("",!0),r("div",{class:"space-y-2",ref_key:"optionsContainer",ref:I},[(l(!0),i(j,null,M(F.value,(s,a)=>(l(),i("button",{key:`${e.value.currentIndex}-${a}`,onClick:g=>U(s),disabled:e.value.showAnswer,class:_(["w-full rounded border border-border bg-background p-3 text-left text-base text-foreground transition-all duration-200 hover:bg-muted disabled:cursor-not-allowed",J(s)])},[r("div",Be,[r("span",ze,o(String.fromCharCode(65+a)),1),re(" "+o(s.meaningText),1)])],10,He))),128))],512),e.value.showAnswer?(l(),i("div",Le,[r("p",{class:_(["text-lg font-medium",e.value.isCorrect?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},o(e.value.isCorrect?"Doğru!":"Yanlış!"),3)])):h("",!0)],512)):h("",!0)]))]))}},Ve=se(Ne,[["__scopeId","data-v-04ba64c3"]]);export{Ve as default};
