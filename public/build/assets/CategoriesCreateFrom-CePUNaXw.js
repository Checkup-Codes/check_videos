import{r as p,T,p as w,s as V,m as z,c as r,o as n,a as e,l as E,k as h,h as d,v,u as a,t as m,G as S,F as j,g as D,B as P,f as U,H as A}from"./ssr-C9XDUnK-.js";const N={class:"mx-auto mt-6 w-full max-w-full bg-base-100 px-3 sm:px-5 lg:mt-0"},R={class:"container mx-auto p-0 sm:p-4"},$={class:"card border border-base-200 bg-base-100 shadow-md"},q={class:"card-body p-4 sm:p-6"},G=e("h2",{class:"card-title text-primary"},"Yeni Kategori",-1),H=e("p",{class:"text-xs opacity-70 sm:text-sm"}," Kategorileriniz için kategoriler oluşturun. İsterseniz bir üst kategori seçebilirsiniz. ",-1),X=e("div",{class:"divider my-3"},null,-1),I={class:"form-control w-full"},O=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"İsim")],-1),W={key:0,class:"label py-1"},Y={class:"label-text-alt text-error"},J={class:"form-control mt-3 w-full"},Q=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Slug")],-1),Z={key:0,class:"label py-1"},ee={class:"label-text-alt text-error"},te={class:"form-control mt-3 w-full"},se=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Üst Kategori")],-1),ae={class:"relative w-full"},le={key:0,class:"absolute z-30 mt-1 w-full"},oe={class:"menu max-h-60 w-full overflow-y-auto rounded-box border border-base-200 bg-base-100 p-2 shadow-md"},re=["onMousedown"],ne={key:1,class:"mt-2 flex items-center"},ie={class:"badge badge-sm"},ce=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),ue=[ce],de={key:0,class:"label py-1"},pe={class:"label-text-alt text-error"},me={class:"form-control mt-3 w-full"},_e=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Durum")],-1),he=e("option",{value:"public"},"Açık",-1),be=e("option",{value:"hidden"},"Gizli",-1),ve=[he,be],ge={key:0,class:"label py-1"},fe={class:"label-text-alt text-error"},we={class:"card-actions mt-5 justify-end"},ye=["disabled"],xe={key:0,class:"loading loading-spinner loading-xs sm:loading-sm"},Me={__name:"CategoriesCreateFrom",props:{categories:{type:Array,default:()=>[]}},setup(y){const c=p(y.categories||[]),t=T({name:"",slug:"",parent_id:"",status:"public"}),i=p(""),_=p(""),u=p(!1),g=p(!1),f=p(null),x=()=>{clearTimeout(f.value),b.value.length>0&&(u.value=!0)},k=()=>{f.value=setTimeout(()=>{u.value=!1},100)},b=w(()=>!c.value||c.value.length===0?[]:i.value?c.value.filter(s=>s&&s.name&&s.name.toLowerCase().includes(i.value.toLowerCase())):c.value),C=w(()=>!t.name||!t.slug),L=()=>{t.parent_id="",i.value.length>=1&&(u.value=!0)},M=s=>{!s||!s.id||(t.parent_id=s.id,i.value=s.name,_.value=s.name,A(()=>{u.value=!1}))},B=()=>{t.parent_id="",i.value="",_.value=""};V(()=>t.name,s=>{s&&(t.slug=s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))});const F=()=>{t.post(route("categories.store")).then(()=>{console.log("Category created successfully"),t.reset(),i.value="",_.value=""}).catch(s=>{console.error("Error creating category:",s)})};z(()=>{(!c.value||c.value.length===0)&&K(),document.addEventListener("keydown",s=>{s.key==="Escape"&&(u.value=!1)})});const K=async()=>{g.value=!0;try{const s=await fetch(route("categories.index"),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch categories");const l=await s.json();c.value=l.categories||[]}catch(s){console.error("Error fetching categories:",s)}finally{g.value=!1}};return(s,l)=>(n(),r("div",N,[e("div",R,[e("div",$,[e("div",q,[G,H,X,e("form",{onSubmit:E(F,["prevent"])},[e("div",I,[O,h(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>a(t).name=o),class:"input-bordered input w-full",placeholder:"Kategori ismi"},null,512),[[v,a(t).name]]),a(t).errors.name?(n(),r("label",W,[e("span",Y,m(a(t).errors.name),1)])):d("",!0)]),e("div",J,[Q,h(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=o=>a(t).slug=o),class:"input-bordered input w-full",placeholder:"kategori-slug"},null,512),[[v,a(t).slug]]),a(t).errors.slug?(n(),r("label",Z,[e("span",ee,m(a(t).errors.slug),1)])):d("",!0)]),e("div",te,[se,e("div",ae,[h(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=o=>i.value=o),onFocus:x,onBlur:k,onInput:L,onKeydown:l[3]||(l[3]=S(o=>u.value=!1,["esc"])),class:"input-bordered input w-full",placeholder:"Üst kategori ara"},null,544),[[v,i.value]]),u.value&&b.value.length>0?(n(),r("div",le,[e("ul",oe,[(n(!0),r(j,null,D(b.value,o=>(n(),r("li",{key:o.id},[e("a",{onMousedown:Ce=>M(o),class:"py-2 text-sm hover:bg-base-200"},m(o.name),41,re)]))),128))])])):d("",!0),a(t).parent_id?(n(),r("div",ne,[e("div",ie,m(_.value),1),e("button",{type:"button",onClick:B,class:"btn btn-ghost btn-xs ml-2","aria-label":"Remove parent category"},ue)])):d("",!0)]),a(t).errors.parent_id?(n(),r("label",de,[e("span",pe,m(a(t).errors.parent_id),1)])):d("",!0)]),e("div",me,[_e,h(e("select",{"onUpdate:modelValue":l[4]||(l[4]=o=>a(t).status=o),class:"select-bordered select w-full"},ve,512),[[P,a(t).status]]),a(t).errors.status?(n(),r("label",ge,[e("span",fe,m(a(t).errors.status),1)])):d("",!0)]),e("div",we,[e("button",{type:"submit",class:"btn btn-primary btn-sm sm:btn-md",disabled:a(t).processing||C.value},[a(t).processing?(n(),r("span",xe)):d("",!0),U(" Kategori Oluştur ")],8,ye)])],32)])])])]))}};export{Me as default};
