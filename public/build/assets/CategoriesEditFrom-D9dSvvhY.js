import{Q as V,r as u,T as j,p as C,s as D,m as P,c as r,o as n,a as e,l as U,k as g,h as c,v as f,u as a,t as b,H as $,F as N,g as q,B as A,f as G,K as H}from"./ssr-DMiicSgz.js";const R={class:"mx-auto mt-6 w-full max-w-full bg-base-100 px-3 sm:px-5 lg:mt-0"},X={class:"container mx-auto p-0 sm:p-4"},I={class:"card border border-base-200 bg-base-100 shadow-md"},O={class:"card-body p-4 sm:p-6"},Q=e("h2",{class:"card-title text-primary"},"Kategori Düzenle",-1),W=e("p",{class:"text-xs opacity-70 sm:text-sm"}," Kategorileriniz için düzenlemeler yapabilirsiniz. İsterseniz bir üst kategori seçebilirsiniz. ",-1),J=e("div",{class:"divider my-3"},null,-1),Y={class:"form-control w-full"},Z=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"İsim")],-1),ee={key:0,class:"label py-1"},te={class:"label-text-alt text-error"},se={class:"form-control mt-3 w-full"},ae=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Slug")],-1),le={key:0,class:"label py-1"},oe={class:"label-text-alt text-error"},re={class:"form-control mt-3 w-full"},ne=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Üst Kategori")],-1),ie={class:"relative w-full"},de={key:0,class:"absolute z-30 mt-1 w-full"},ue={class:"menu max-h-60 w-full overflow-y-auto rounded-box border border-base-200 bg-base-100 p-2 shadow-md"},ce=["onMousedown"],pe={key:1,class:"mt-2 flex items-center"},me={class:"badge badge-sm"},be=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),_e=[be],ge={key:0,class:"label py-1"},ve={class:"label-text-alt text-error"},he={class:"form-control mt-3 w-full"},fe=e("label",{class:"label py-1.5"},[e("span",{class:"label-text"},"Durum")],-1),ye=e("option",{value:"public"},"Açık",-1),we=e("option",{value:"hidden"},"Gizli",-1),xe=[ye,we],ke={key:0,class:"label py-1"},Ce={class:"label-text-alt text-error"},ze={class:"mt-5 flex flex-col justify-between gap-3 sm:flex-row"},Ke=["disabled"],Le={key:0,class:"loading loading-spinner loading-xs sm:loading-sm"},Ee=Object.assign({name:"CategoriesEditFrom"},{__name:"CategoriesEditFrom",setup(Me){var x,k;const{props:_}=V(),p=u(_.categories||[]),m=u(_.category||{}),t=j({name:m.value.name||"",slug:m.value.slug||"",parent_id:m.value.parent_id||null,status:m.value.status||"public"}),i=u(((x=_.category.parent)==null?void 0:x.name)||""),v=u(((k=_.category.parent)==null?void 0:k.name)||""),d=u(!1),y=u(!1),w=u(null),h=C(()=>!p.value||p.value.length===0?[]:p.value.filter(s=>s&&s.id!==m.value.id&&(!i.value||s.name&&s.name.toLowerCase().includes(i.value.toLowerCase())))),z=C(()=>!t.name||!t.slug);D(()=>t.name,s=>{s&&(t.slug=s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))}),P(()=>{(!p.value||p.value.length===0)&&S(),document.addEventListener("keydown",s=>{s.key==="Escape"&&(d.value=!1)})});const K=()=>{clearTimeout(w.value),h.value.length>0&&(d.value=!0)},L=()=>{w.value=setTimeout(()=>{d.value=!1},100)},M=()=>{t.parent_id="",i.value.length>=1&&(d.value=!0)},B=s=>{!s||!s.id||(t.parent_id=s.id,i.value=s.name,v.value=s.name,H(()=>{d.value=!1}))},F=()=>{t.parent_id="",i.value="",v.value=""},E=()=>{t.put(route("categories.update",{category:m.value.id}))},S=async()=>{y.value=!0;try{const s=await fetch(route("categories.index"),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch categories");const l=await s.json();p.value=l.categories||[]}catch(s){console.error("Error fetching categories:",s)}finally{y.value=!1}},T=s=>{confirm("Bu kategoriyi silmek istediğinize emin misiniz?")&&t.delete(route("categories.destroy",{category:s})).then(()=>{console.log("Kategori başarıyla silindi")}).catch(l=>{console.error("Kategori silinirken hata:",l)})};return(s,l)=>(n(),r("div",R,[e("div",X,[e("div",I,[e("div",O,[Q,W,J,e("form",{onSubmit:U(E,["prevent"])},[e("div",Y,[Z,g(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>a(t).name=o),class:"input-bordered input w-full",placeholder:"Kategori ismi"},null,512),[[f,a(t).name]]),a(t).errors.name?(n(),r("label",ee,[e("span",te,b(a(t).errors.name),1)])):c("",!0)]),e("div",se,[ae,g(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=o=>a(t).slug=o),class:"input-bordered input w-full",placeholder:"kategori-slug"},null,512),[[f,a(t).slug]]),a(t).errors.slug?(n(),r("label",le,[e("span",oe,b(a(t).errors.slug),1)])):c("",!0)]),e("div",re,[ne,e("div",ie,[g(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=o=>i.value=o),onFocus:K,onBlur:L,onInput:M,onKeydown:l[3]||(l[3]=$(o=>d.value=!1,["esc"])),class:"input-bordered input w-full",placeholder:"Üst kategori ara"},null,544),[[f,i.value]]),d.value&&h.value.length>0?(n(),r("div",de,[e("ul",ue,[(n(!0),r(N,null,q(h.value,o=>(n(),r("li",{key:o.id},[e("a",{onMousedown:Be=>B(o),class:"py-2 text-sm hover:bg-base-200"},b(o.name),41,ce)]))),128))])])):c("",!0),a(t).parent_id?(n(),r("div",pe,[e("div",me,b(v.value),1),e("button",{type:"button",onClick:F,class:"btn btn-ghost btn-xs ml-2","aria-label":"Üst kategoriyi kaldır"},_e)])):c("",!0)]),a(t).errors.parent_id?(n(),r("label",ge,[e("span",ve,b(a(t).errors.parent_id),1)])):c("",!0)]),e("div",he,[fe,g(e("select",{"onUpdate:modelValue":l[4]||(l[4]=o=>a(t).status=o),class:"select-bordered select w-full"},xe,512),[[A,a(t).status]]),a(t).errors.status?(n(),r("label",ke,[e("span",Ce,b(a(t).errors.status),1)])):c("",!0)]),e("div",ze,[e("button",{type:"button",onClick:l[5]||(l[5]=o=>T(a(_).category.id)),class:"btn btn-error btn-outline btn-sm order-2 sm:btn-md sm:order-1"}," Kategoriyi Sil "),e("button",{type:"submit",class:"btn btn-primary btn-sm order-1 sm:btn-md sm:order-2",disabled:a(t).processing||z.value},[a(t).processing?(n(),r("span",Le)):c("",!0),G(" Kategoriyi Güncelle ")],8,Ke)])],32)])])])]))}});export{Ee as default};
