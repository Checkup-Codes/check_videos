import{Q as W,r as N,s as h,D,p as i,m as F,z as H,Y as _,c as P,e as S,u as c,w as k,a as j,n as p,b as z,j as L,h as I,o as f,_ as V,$ as A,F as E}from"./ssr-CUNQhKJF.js";import{_ as K,a as O}from"./FlashMessage-DQt_virA.js";import Q from"./SidebarLayoutWrite-CGwxXxZB.js";import Y from"./SidebarLayoutCategory-CcPBWs_z.js";import{u as q}from"./useSidebar-C-QC0wjl.js";import"./TopSubsidebar-CH2OnAve.js";import"./WriteList-CF8UYY7N.js";import"./app-D4kanwHI.js";/* empty css            */import"./CheckSubsidebar-BLm2N5M5.js";import"./SubSidebarScreen-DPLhfgUl.js";import"./CategoryTree-BBmFGP2d.js";function G(){var n;const{props:d}=W(),o=N(((n=d.flash)==null?void 0:n.success)||"");return h(()=>{var t;return(t=d.flash)==null?void 0:t.success},t=>{t&&(o.value=t,setTimeout(()=>{o.value=""},3e3))}),{flashMessage:o}}const le=Object.assign({name:"LayoutWritesCategories"},{__name:"LayoutWritesCategories",setup(d){var b;const{isCollapsed:o,isMobile:n,sidebarStyle:t}=q(),{flashMessage:x}=G(),m=D(),B=i(()=>m.getters["Theme/getCurrentTheme"]),v=W(),{props:s}=v,l=((b=s.screen)==null?void 0:b.name)||"",M={writes:Q,categories:Y},C=i(()=>!!(s.auth&&s.auth.user)),a=i(()=>{var y;if(console.log("LayoutWritesCategories Debug:",{isLoggedIn:C.value,currentUrl:s.url,currentWrite:s.write,writeStatus:(y=s.write)==null?void 0:y.status,screenName:l}),C.value)return console.log("User is logged in, showing sidebar"),!1;const e=v.url||s.url||"",g=e.includes("/writes/")&&!e.includes("/writes/create")&&!e.includes("/writes/edit"),w=e.includes("/categories/")&&!e.includes("/categories/create")&&!e.includes("/categories/edit");if(console.log("Page check:",{currentUrl:e,isWriteShowPage:g,isCategoryShowPage:w}),g||w){const r=s.write;if(console.log("Current write status:",r==null?void 0:r.status),r&&r.status==="link_only")return console.log("Hiding sidebar for link-only write"),!0}return console.log("Showing sidebar (default)"),!1});h(a,e=>{console.log("shouldHideSidebarContent changed:",e)},{immediate:!0});const U=i(()=>o.value&&l&&!a.value&&M[l]||null),u=N(m.getters["Writes/isCollapsed"]);h(()=>m.getters["Writes/isCollapsed"],e=>{u.value=e},{immediate:!0});const $=i(()=>({"transition-all duration-300":!0,"lg:ml-[-200px]":u.value&&!a.value,"lg:ml-[00px]":!u.value&&!a.value,"lg:ml-0":a.value})),T=e=>{u.value=e};return F(()=>{document.body.style.overflow="hidden"}),H(()=>{document.body.style.overflow=""}),_("categories",s.categories||[]),_("writes",s.writes||[]),(e,g)=>(f(),P(E,null,[S(K,{message:c(x)},null,8,["message"]),S(O,{isCollapsed:!a.value,class:p(B.value)},{sidebar:k(()=>[a.value?I("",!0):(f(),L(V,{key:0,max:5,include:["SidebarLayoutWrite","SidebarLayoutCategory"]},[(f(),L(A(U.value),{key:c(l),class:p(c(t)),"onUpdate:isNarrow":T},null,40,["class"]))],1024))]),default:k(()=>[j("div",{class:p([c(n)?"hidden lg:block":"block",$.value])},[z(e.$slots,"screen")],2)]),_:3},8,["isCollapsed","class"])],64))}});export{le as default};
