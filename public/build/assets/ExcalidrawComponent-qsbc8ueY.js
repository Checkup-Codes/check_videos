const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-xJT5jGAa.js","assets/index-yBjzXJbu.js","assets/index-fNjTmf9T.js","assets/index-BG9jLBGe.js","assets/app-M2WJPRDD.js","assets/app-SrdGh9Gs.css","assets/app-CN0irlqg.css","assets/client-DbQUXYha.js"])))=>i.map(i=>d[i]);
import{Q as S,l as _,x as T,C as r,g as d,o as u,h as w,b as o,t as x,j as I,D as L,F as E,m as O,u as D,s as V}from"./app-M2WJPRDD.js";const R={key:0,class:"rounded bg-green-200 p-3 text-green-800"},P={class:"bg-white px-2 lg:p-3"},A={class:"flex justify-between rounded-md px-1 py-2 text-gray-800 sm:mx-3 md:mx-5"},B={class:"flex"},M=o("label",{for:"versionDropdown",class:"my-auto px-3 font-semibold"},"Versiyon Seç:",-1),N=["value"],j={class:"ml-auto flex items-center justify-end space-x-2"},F=o("div",{id:"excalidraw-container",class:"h-[calc(79vh)] w-full"},[o("div",{id:"excali",class:"h-full w-full"})],-1),z={__name:"ExcalidrawComponent",setup(J){const{props:l}=S(),c=_([]),i=_(""),n=_(l.write.write_draws),s=_(n.value.length>0?n.value[0].id:null);T(()=>{b()});const b=()=>{r(async()=>{const{Excalidraw:a}=await import("./main-xJT5jGAa.js").then(e=>e.m);return{Excalidraw:a}},__vite__mapDeps([0,1,2])).then(({Excalidraw:a})=>{r(()=>import("./index-BG9jLBGe.js").then(e=>e.i),__vite__mapDeps([3,4,5,6,1])).then(e=>{r(()=>import("./client-DbQUXYha.js").then(t=>t.c),__vite__mapDeps([7,4,5,6,2,1])).then(t=>{const v=document.getElementById("excali"),m=t.createRoot(v),h=n.value.length>0?{elements:JSON.parse(n.value[0].elements),scrollToContent:!0}:{elements:[],scrollToContent:!0},p=f=>{c.value=f};m.render(e.createElement(a,{initialData:h,onChange:p,viewModeEnabled:!l.auth.user}))})})})},y=()=>{const a=n.value.find(e=>e.id===s.value);a&&r(async()=>{const{Excalidraw:e}=await import("./main-xJT5jGAa.js").then(t=>t.m);return{Excalidraw:e}},__vite__mapDeps([0,1,2])).then(({Excalidraw:e})=>{r(()=>import("./index-BG9jLBGe.js").then(t=>t.i),__vite__mapDeps([3,4,5,6,1])).then(t=>{r(()=>import("./client-DbQUXYha.js").then(v=>v.c),__vite__mapDeps([7,4,5,6,2,1])).then(v=>{const m=document.getElementById("excali"),h=v.createRoot(m),p={elements:JSON.parse(a.elements),scrollToContent:!0};h.render(t.createElement(e,{initialData:p,onChange:f=>{c.value=f},viewModeEnabled:!l.auth.user}))})})})},C=()=>{const a=c.value.length>0?c.value:[],e=JSON.stringify(a);V.post(`/writes/${l.write.id}/draw`,{elements:e}).then(t=>{g("Canvas durumu başarıyla kaydedildi!"),n.value.push(t.data)}).catch(()=>{g("Kaydetme sırasında bir hata oluştu. Lütfen tekrar deneyin.")})},k=()=>{n.value.find(e=>e.id===s.value)&&confirm("Bu versiyonu silmek istediğinizden emin misiniz?")&&V.delete(`/writes/${l.write.id}/draw/${s.value}`).then(()=>{i.value="Versiyon başarıyla silindi.",n.value=n.value.filter(e=>e.id!==s.value),n.value.length>0?(s.value=n.value[0].id,y()):(c.value=[],s.value=null)}).catch(e=>{i.value="Silme işlemi sırasında bir hata oluştu. Lütfen tekrar deneyin."})},g=a=>{i.value=a,setTimeout(()=>{i.value=""},3e3)};return(a,e)=>(u(),d(E,null,[i.value?(u(),d("div",R,x(i.value),1)):w("",!0),o("div",P,[o("div",A,[o("div",B,[M,I(o("select",{id:"versionDropdown","onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t),onChange:y,class:"mx-5 border py-0 pl-2 text-gray-800 shadow-sm focus:outline-none focus:ring focus:ring-gray-200"},[(u(!0),d(E,null,O(n.value,t=>(u(),d("option",{key:t.id,value:t.id},"Versiyon "+x(t.version),9,N))),128))],544),[[L,s.value]])]),o("div",j,[D(l).auth.user?(u(),d("button",{key:0,onClick:k,class:"rounded px-5 hover:underline"},"Sil")):w("",!0),D(l).auth.user?(u(),d("button",{key:1,onClick:C,class:"rounded px-5 hover:underline"},"Kaydet")):w("",!0)])]),F])],64))}};export{z as _};
