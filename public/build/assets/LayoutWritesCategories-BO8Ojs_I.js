import{Q as W,r as N,y as p,s as F,p as u,m as H,x as P,Y as y,c as j,e as S,u as c,w as _,a as D,n as k,b as I,j as L,h as V,o as g,_ as z,$ as A,F as E}from"./ssr-Dv_HsqzD.js";import{_ as K,a as O}from"./FlashMessage-HAGI3QFM.js";import Q from"./SidebarLayoutWrite-Cz7GNZkp.js";import T from"./SidebarLayoutCategory-DxIoy6yf.js";import{u as Y}from"./useSidebar-C9QilHTz.js";import"./WriteList-BSj6U-Qw.js";import"./app-ChiiLQ4B.js";/* empty css            */import"./CheckSubsidebar-AB0mO0m2.js";import"./SubSidebarScreen-BiLOuFQn.js";import"./CategoryTree-DISkmBOu.js";function q(){var i;const{props:d}=W(),o=N(((i=d.flash)==null?void 0:i.success)||"");return p(()=>{var t;return(t=d.flash)==null?void 0:t.success},t=>{t&&(o.value=t,setTimeout(()=>{o.value=""},3e3))}),{flashMessage:o}}const ie=Object.assign({name:"LayoutWritesCategories"},{__name:"LayoutWritesCategories",setup(d){var v;const{isCollapsed:o,isMobile:i,sidebarStyle:t}=Y(),{flashMessage:x}=q(),f=F(),b=W(),{props:s}=b,l=((v=s.screen)==null?void 0:v.name)||"",B={writes:Q,categories:T},h=u(()=>!!(s.auth&&s.auth.user)),a=u(()=>{var w;if(console.log("LayoutWritesCategories Debug:",{isLoggedIn:h.value,currentUrl:s.url,currentWrite:s.write,writeStatus:(w=s.write)==null?void 0:w.status,screenName:l}),h.value)return console.log("User is logged in, showing sidebar"),!1;const e=b.url||s.url||"",m=e.includes("/writes/")&&!e.includes("/writes/create")&&!e.includes("/writes/edit"),C=e.includes("/categories/")&&!e.includes("/categories/create")&&!e.includes("/categories/edit");if(console.log("Page check:",{currentUrl:e,isWriteShowPage:m,isCategoryShowPage:C}),m||C){const r=s.write;if(console.log("Current write status:",r==null?void 0:r.status),r&&r.status==="link_only")return console.log("Hiding sidebar for link-only write"),!0}return console.log("Showing sidebar (default)"),!1});p(a,e=>{console.log("shouldHideSidebarContent changed:",e)},{immediate:!0});const M=u(()=>o.value&&l&&!a.value&&B[l]||null),n=N(f.getters["Writes/isCollapsed"]);p(()=>f.getters["Writes/isCollapsed"],e=>{n.value=e},{immediate:!0});const U=u(()=>({"transition-all duration-300":!0,"lg:ml-[-200px]":n.value&&!a.value,"lg:ml-[00px]":!n.value&&!a.value,"lg:ml-0":a.value})),$=e=>{n.value=e};return H(()=>{document.body.style.overflow="hidden"}),P(()=>{document.body.style.overflow=""}),y("categories",s.categories||[]),y("writes",s.writes||[]),(e,m)=>(g(),j(E,null,[S(K,{message:c(x)},null,8,["message"]),S(O,{isCollapsed:!a.value},{sidebar:_(()=>[a.value?V("",!0):(g(),L(z,{key:0,max:5,include:["SidebarLayoutWrite","SidebarLayoutCategory"]},[(g(),L(A(M.value),{key:c(l),class:k(c(t)),"onUpdate:isNarrow":$},null,40,["class"]))],1024))]),default:_(()=>[D("div",{class:k([c(i)?"hidden lg:block":"block",U.value])},[I(e.$slots,"screen")],2)]),_:3},8,["isCollapsed"])],64))}});export{ie as default};
