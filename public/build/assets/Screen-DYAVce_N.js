import{Q,b as B,g,T as X,e as G,w as z,f as U,a as t,h as J,i as c,c as d,j as v,n as S,u as n,m as x,o as l,t as p,F as h,l as w,v as j,I as W,k as M,p as Z,C as I}from"./ssr-ig3NHSec.js";import{_ as ee}from"./CheckScreen-_FCSDmIW.js";import{_ as te}from"./TopScreen-CL_Fu0-O.js";import{_ as oe}from"./GoBackButton-CjZHkBkE.js";import"./app-BD4itwoa.js";/* empty css            */const se={class:"rounded-lg border border-border bg-card shadow-sm"},re={class:"p-6"},ie={class:"space-y-4"},ne={key:0,class:"mt-1 text-xs text-destructive"},le=["value"],de={key:0,class:"mt-1 text-xs text-destructive"},ue=["value"],ae={key:0,class:"mt-1 text-xs text-destructive"},ce={class:"space-y-4 border-t border-border pt-6"},pe={key:0,class:"flex items-center gap-3 rounded-md border border-border bg-muted/50 p-4 text-sm text-muted-foreground"},fe={key:1,class:"space-y-4"},me={class:"flex cursor-pointer items-center gap-3"},ge=["value","onChange"],be={class:"flex-1"},ve={class:"text-sm font-medium text-foreground"},xe={key:0,class:"mt-1 text-xs text-muted-foreground"},_e={key:0,class:"mt-4 space-y-3 border-t border-border pt-4 pl-7"},ke={class:"grid grid-cols-1 gap-3 md:grid-cols-2"},ye=["onUpdate:modelValue"],he=["onUpdate:modelValue"],we=["onUpdate:modelValue"],je=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],Te={class:"space-y-3 border-t border-border pt-4"},Be={class:"flex items-center justify-between"},Ue={class:"text-xs text-muted-foreground"},Se={class:"space-y-2"},Me=["checked","onChange"],ze=["onUpdate:modelValue","onBlur"],Oe=["onClick"],Pe=["onClick"],De={key:2,class:"text-xs text-destructive"},Ne={class:"flex justify-end gap-2 border-t border-border pt-4"},$e=["disabled"],Re={key:0,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ee={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Qe={__name:"Screen",setup(Ke){const{props:V}=Q(),C=B(()=>V.services||[]),O=B(()=>V.customers||[]),P=B(()=>V.categories||[]),D=g(null),N=g(null),$=g(null),u=g({project_name:"",customer_id:"",category_id:"",services:""}),k=g({}),b=g([]),f=g({}),i=X({project_name:"",customer_id:"",category_id:"",services:[]});i.processing=!1;const a=s=>(k.value[s]||(k.value[s]={id:s,price:null,status:"pending",payment_status:"unpaid",notes:"",service_start_date:null,service_end_date:null}),k.value[s]),T=s=>(f.value[s]||(f.value[s]=[]),f.value[s]),R=s=>{f.value[s]||(f.value[s]=[]),f.value[s].push({id:null,title:"",is_completed:!1,completed_at:null})},E=(s,e)=>{f.value[s].splice(e,1)},K=(s,e)=>{const o=f.value[s][e];o.is_completed=!o.is_completed,o.completed_at=o.is_completed?new Date().toISOString():null},F=(s,e)=>{},A=s=>{const e=T(s);if(e.length===0)return 0;const o=e.filter(r=>r.is_completed).length;return Math.round(o/e.length*100)},H=s=>{b.value.includes(s)||delete k.value[s]},q=()=>{i.services=b.value.map(s=>a(s)),i.post("/projects",{onSuccess:s=>{var o;const e=((o=s.props.project)==null?void 0:o.id)||s.url.split("/").pop();e&&L(e)},onError:s=>{s&&Object.keys(s).forEach(e=>{u.value.hasOwnProperty(e)&&(u.value[e]=s[e])})}})},L=async s=>{var r;const e=[],o=((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||"";b.value.forEach(m=>{T(m).forEach(y=>{y.title&&y.title.trim()&&e.push(I.post("/project-service-todos",{project_id:s,service_id:m,title:y.title,is_completed:y.is_completed||!1},{headers:{"X-CSRF-TOKEN":o}}).catch(Y=>{console.error("Todo oluşturulurken hata oluştu:",Y)}))})}),await Promise.all(e)};return(s,e)=>(l(),G(ee,null,{default:z(()=>[U(oe,{url:"/projects"}),U(te,{title:"Yeni Proje Oluştur"}),t("div",se,[t("div",re,[t("form",{onSubmit:J(q,["prevent"]),class:"space-y-6"},[t("div",ie,[e[10]||(e[10]=t("h3",{class:"text-sm font-semibold text-foreground"},"Proje Bilgileri",-1)),t("div",{ref_key:"projectNameRef",ref:D},[e[4]||(e[4]=t("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Proje Adı",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>n(i).project_name=o),type:"text",placeholder:"Proje adını girin",class:S(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":u.value.project_name||n(i).errors.project_name}]),required:""},null,2),[[x,n(i).project_name]]),u.value.project_name||n(i).errors.project_name?(l(),d("p",ne,p(u.value.project_name||n(i).errors.project_name),1)):v("",!0)],512),t("div",{ref_key:"customerIdRef",ref:N},[e[6]||(e[6]=t("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Müşteri Seçin",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>n(i).customer_id=o),class:S(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":u.value.customer_id||n(i).errors.customer_id}]),required:""},[e[5]||(e[5]=t("option",{disabled:"",value:""},"Bir müşteri seçin",-1)),(l(!0),d(h,null,w(O.value,o=>(l(),d("option",{key:o.id,value:o.id},p(o.first_name)+" "+p(o.last_name),9,le))),128))],2),[[j,n(i).customer_id]]),u.value.customer_id||n(i).errors.customer_id?(l(),d("p",de,p(u.value.customer_id||n(i).errors.customer_id),1)):v("",!0)],512),t("div",{ref_key:"categoryIdRef",ref:$},[e[8]||(e[8]=t("label",{class:"mb-1 block text-sm font-medium text-foreground"},"Kategori/Yazı Bağlantısı (Opsiyonel)",-1)),c(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>n(i).category_id=o),class:S(["flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive focus-visible:ring-destructive":u.value.category_id||n(i).errors.category_id}])},[e[7]||(e[7]=t("option",{value:""},"Kategori seçin (opsiyonel)",-1)),(l(!0),d(h,null,w(P.value,o=>(l(),d("option",{key:o.id,value:o.id},p(o.name),9,ue))),128))],2),[[j,n(i).category_id]]),u.value.category_id||n(i).errors.category_id?(l(),d("p",ae,p(u.value.category_id||n(i).errors.category_id),1)):v("",!0),e[9]||(e[9]=t("p",{class:"mt-1 text-xs text-muted-foreground"}," Bu projeye ait yazıların bulunduğu kategoriyi seçin. Bu kategori altındaki tüm yazılar bu projeyle ilişkilendirilir. ",-1))],512)]),t("div",ce,[e[23]||(e[23]=t("h3",{class:"text-sm font-semibold text-foreground"},"Servisler",-1)),!C.value||C.value.length===0?(l(),d("div",pe,[...e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"h-5 w-5 shrink-0",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("span",null,"Henüz servis bulunmamaktadır.",-1)])])):(l(),d("div",fe,[(l(!0),d(h,null,w(C.value,o=>(l(),d("div",{key:o.id,class:"rounded-md border border-input bg-card p-4"},[t("label",me,[c(t("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[3]||(e[3]=r=>b.value=r),onChange:r=>H(o.id),class:"h-4 w-4 rounded border-input text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2"},null,40,ge),[[W,b.value]]),t("div",be,[t("span",ve,p(o.name),1),o.description?(l(),d("p",xe,p(o.description),1)):v("",!0)])]),b.value.includes(o.id)?(l(),d("div",_e,[t("div",ke,[t("div",null,[e[12]||(e[12]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Projeye Özel Fiyat (₺)",-1)),c(t("input",{"onUpdate:modelValue":r=>a(o.id).price=r,type:"number",step:"0.01",min:"0",placeholder:"Fiyat girin",class:"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,ye),[[x,a(o.id).price,void 0,{number:!0}]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Durum",-1)),c(t("select",{"onUpdate:modelValue":r=>a(o.id).status=r,class:"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...e[13]||(e[13]=[t("option",{value:"pending"},"Beklemede",-1),t("option",{value:"active"},"Aktif",-1),t("option",{value:"completed"},"Tamamlandı",-1),t("option",{value:"cancelled"},"İptal Edildi",-1)])],8,he),[[j,a(o.id).status]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Ödeme Durumu",-1)),c(t("select",{"onUpdate:modelValue":r=>a(o.id).payment_status=r,class:"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[...e[15]||(e[15]=[t("option",{value:"unpaid"},"Ödenmedi",-1),t("option",{value:"partial"},"Kısmi Ödendi",-1),t("option",{value:"paid"},"Ödendi",-1)])],8,we),[[j,a(o.id).payment_status]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Hizmet Başlangıç Tarihi",-1)),c(t("input",{"onUpdate:modelValue":r=>a(o.id).service_start_date=r,type:"date",class:"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,je),[[x,a(o.id).service_start_date]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Hizmet Bitiş Tarihi",-1)),c(t("input",{"onUpdate:modelValue":r=>a(o.id).service_end_date=r,type:"date",class:"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ve),[[x,a(o.id).service_end_date]])])]),t("div",null,[e[19]||(e[19]=t("label",{class:"mb-1 block text-xs font-medium text-foreground"},"Notlar",-1)),c(t("textarea",{"onUpdate:modelValue":r=>a(o.id).notes=r,rows:"3",placeholder:"Bu servis hakkında notlar...",class:"flex w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,8,Ce),[[x,a(o.id).notes]])]),t("div",Te,[t("div",Be,[e[20]||(e[20]=t("label",{class:"block text-xs font-medium text-foreground"},"TO-DO'lar",-1)),t("span",Ue," Tamamlanma: "+p(A(o.id))+"% ",1)]),t("div",Se,[(l(!0),d(h,null,w(T(o.id),(r,m)=>(l(),d("div",{key:r.id||m,class:"flex items-center gap-2 rounded-md border border-input bg-background p-2"},[t("input",{type:"checkbox",checked:r.is_completed,onChange:_=>K(o.id,m),class:"h-4 w-4 rounded border-input text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2"},null,40,Me),c(t("input",{"onUpdate:modelValue":_=>r.title=_,type:"text",placeholder:"Todo başlığı...",class:"flex-1 border-none bg-transparent px-2 py-1 text-xs text-foreground focus:outline-none focus:ring-0",onBlur:_=>F(o.id,m)},null,40,ze),[[x,r.title]]),t("button",{type:"button",onClick:_=>E(o.id,m),class:"text-destructive hover:text-destructive/80"},[...e[21]||(e[21]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Oe)]))),128))]),t("button",{type:"button",onClick:r=>R(o.id),class:"inline-flex h-7 w-full items-center justify-center gap-2 rounded-md border border-input bg-background px-3 text-xs font-medium text-foreground transition-colors hover:bg-accent hover:text-accent-foreground"},[...e[22]||(e[22]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),M(" Yeni TO-DO Ekle ",-1)])],8,Pe)])])):v("",!0)]))),128))])),u.value.services||n(i).errors.services?(l(),d("p",De,p(u.value.services||n(i).errors.services),1)):v("",!0)]),t("div",Ne,[U(n(Z),{href:"/projects",class:"inline-flex h-9 items-center justify-center rounded-md border border-input bg-background px-4 text-sm font-medium text-foreground ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},{default:z(()=>[...e[24]||(e[24]=[M(" İptal ",-1)])]),_:1}),t("button",{type:"submit",class:"inline-flex h-9 items-center justify-center gap-2 rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:n(i).processing},[n(i).processing?(l(),d("svg",Re,[...e[25]||(e[25]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(l(),d("svg",Ee,[...e[26]||(e[26]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])),M(" "+p(n(i).processing?"Kaydediliyor...":"Projeyi Kaydet"),1)],8,$e)])],32)])])]),_:1}))}};export{Qe as default};
