import{Q as T,g as f,y as W,B as ue,b as s,s as de,N as O,z as ce,c as k,f as R,j as D,u as ve,a as c,C as fe,w as $,n as me,r as ge,e as A,o as v,L as we,a1 as pe,F as he,M as G}from"./ssr-AmW-FCLL.js";import{_ as be}from"./CheckLayout-HvJ8T4L4.js";import ye from"./SidebarLayoutWrite-BQOrgune.js";import Se from"./SidebarLayoutCategory-BCPfeUn8.js";import{_ as ke}from"./FlashMessage-dqOE8AIM.js";import{u as Ce}from"./useSidebar-DMREIepV.js";import"./WriteList-BDDK65UW.js";import"./IconCalendar-DT-eoeUA.js";import"./IconEye-zOsgJh1R.js";import"./IconLock-Dg6tD8WK.js";import"./IconLink-BQbtB0B0.js";import"./app-C5lgqGcU.js";/* empty css            */import"./SubSidebarScreen-BebsfVnG.js";import"./IconMenu-CSafTLuM.js";import"./IconFolder-DZ_syNTq.js";import"./IconX-CSzlQ_l6.js";import"./IconFilter-BArWsTtF.js";import"./CategoryTree-DIf2AqAT.js";import"./IconChevronDown-Dn8wKxFG.js";function xe(){var g;const{props:_}=T(),m=f(((g=_.flash)==null?void 0:g.success)||"");return W(()=>{var i;return(i=_.flash)==null?void 0:i.success},i=>{i?m.value=i:m.value=""}),{flashMessage:m}}const We={key:0,class:"fixed bottom-6 right-6 z-50 lg:bottom-8 lg:right-8"},_e={key:0,class:"absolute bottom-full right-0 mb-2 w-64 animate-in slide-in-from-bottom-2 rounded-lg border border-primary/20 bg-primary/10 p-3 shadow-lg backdrop-blur-sm"},Ie=["title"],Me={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Le={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Je=Object.assign({name:"LayoutWritesCategories"},{__name:"LayoutWritesCategories",setup(_){const{isCollapsed:m}=Ce(),{flashMessage:g}=xe(),i=ue(),I=f(typeof window<"u"?window.innerWidth:1024),B=s(()=>I.value<1024),N=()=>{typeof window<"u"&&(I.value=window.innerWidth)},K=()=>{g.value=""},a=T(),M=s(()=>{var e;return((e=a.props.screen)==null?void 0:e.name)||"writes"}),Q={writes:ye,categories:Se},j=s(()=>!!(a.props.auth&&a.props.auth.user)),n=s(()=>{const e=a.url||"";return e==="/writes"||e.startsWith("/writes?")||e==="/categories"||e.startsWith("/categories?")}),z=s(()=>{const e=a.url||"",t=e.startsWith("/writes/")&&e!=="/writes"&&!e.includes("/writes/create")&&!e.includes("/writes/edit"),o=e==="/writes/create"||e.includes("/writes/edit"),l=e.startsWith("/categories/")&&e!=="/categories"&&!e.includes("/categories/create")&&!e.includes("/categories/edit"),d=e==="/categories/create"||e.includes("/categories/edit");return t||o||l||d}),u=s(()=>{if(j.value)return!1;const e=a.url||"",t=e.includes("/writes/")&&!e.includes("/writes/create")&&!e.includes("/writes/edit"),o=e.includes("/categories/")&&!e.includes("/categories/create")&&!e.includes("/categories/edit");if(t||o){const l=a.props.write;if(l&&l.status==="link_only")return!0}return!1}),w=s(()=>B.value?!z.value:!0),E=s(()=>B.value?z.value:!0),q=s(()=>m.value&&M.value&&!u.value&&w.value&&(n.value||r.value)&&Q[M.value]||null),C=f(i.getters["Writes/isCollapsed"]);W(()=>i.getters["Writes/isCollapsed"],e=>{C.value=e},{immediate:!0});const J=s(()=>({"transition-all duration-300":!0,"lg:ml-[-200px]":C.value&&!u.value&&(n.value||r.value),"lg:ml-[00px]":!C.value&&!u.value&&(n.value||r.value),"lg:ml-0":u.value||!n.value&&!r.value})),X=e=>{C.value=e},x=f(!1),r=f(!0),p=f(!1),Y=f(!0),F=()=>{if(typeof window>"u"||typeof document>"u")return!1;const e=document.referrer,t=window.location.hostname;if(!e)return!0;try{const l=new URL(e).hostname,d=t.split(".").slice(-2).join("."),U=l.split(".").slice(-2).join(".");return d!==U}catch{return!0}},Z=()=>{if(typeof window>"u"||n.value)return!0;const e=sessionStorage.getItem("sidebar_visible");if(e!==null)return e==="true";const t=localStorage.getItem("sidebar_visible");return t!==null?t==="true":!F()},ee=()=>typeof window>"u"||n.value||localStorage.getItem("sidebar_hint_dismissed")==="true"||localStorage.getItem("sidebar_visible")!==null?!1:F(),L=()=>{p.value=!1,typeof window<"u"&&localStorage.setItem("sidebar_hint_dismissed","true")},te=()=>{typeof window<"u"&&(r.value=Z(),Y.value=!1,sessionStorage.setItem("sidebar_visible",r.value.toString()),ee()&&!r.value&&setTimeout(()=>{p.value=!0,setTimeout(()=>{p.value&&L()},8e3)},2e3))},se=()=>{typeof window<"u"&&(localStorage.setItem("sidebar_visible",r.value.toString()),sessionStorage.setItem("sidebar_visible",r.value.toString()))},re=()=>{r.value=!r.value,se(),p.value&&L()};let P=null;de(()=>{x.value=!0,document.body.style.overflow="hidden",te(),typeof window<"u"&&(I.value=window.innerWidth,window.addEventListener("resize",N)),w.value&&!u.value&&(n.value||r.value)&&H(),P=O.on("navigate",e=>{if(typeof window<"u"){const t=sessionStorage.getItem("sidebar_visible");t!==null&&(r.value=t==="true")}}),O.on("success",e=>{var l,d;const t=a.props.flash,o=e.detail.page.url||"";if(t!=null&&t.success&&(o.includes("/writes")||o.includes("/categories"))){const U=o.includes("/create"),le=o.includes("/edit");!U&&!le&&i.dispatch("Writes/invalidateAndReload",{currentUserId:((d=(l=a.props.auth)==null?void 0:l.user)==null?void 0:d.id)||null})}})}),ce(()=>{document.body.style.overflow="",typeof window<"u"&&window.removeEventListener("resize",N),P&&P()});const h=s(()=>a.props.categories||[]),b=s(()=>a.props.writes||a.props.allWrites||[]),V=s(()=>{var e,t;return((t=(e=a.props.auth)==null?void 0:e.user)==null?void 0:t.id)||null}),y=s(()=>i.getters["Writes/writes"]),S=s(()=>i.getters["Writes/categories"]),ie=s(()=>i.getters["Writes/sidebarDataLoaded"]),oe=s(()=>i.getters["Writes/lastUserId"]),ae=s(()=>S.value&&S.value.length>0?S.value:h.value&&h.value.length>0?h.value:[]),ne=s(()=>y.value&&y.value.length>0?y.value:b.value&&b.value.length>0?b.value:[]);G("categories",ae),G("writes",ne);const H=async()=>{const e=V.value,t=e!==oe.value;if(h.value.length>0||b.value.length>0){i.dispatch("Writes/setSidebarDataFromProps",{writes:b.value,categories:h.value,currentUserId:e});return}const o=(!y.value||y.value.length===0)&&(!S.value||S.value.length===0);(!ie.value||t||o)&&await i.dispatch("Writes/loadSidebarData",{currentUserId:e,forceRefresh:o})};return W([x,w,u,r,n],async([e,t,o,l,d])=>{e&&t&&!o&&(d||l)&&await H()},{immediate:!0}),W(V,(e,t)=>{e!==t&&x.value&&i.dispatch("Writes/loadSidebarData",{forceRefresh:!0,currentUserId:e})}),(e,t)=>(v(),k(he,null,[R(ke,{message:ve(g),onClose:K},null,8,["message"]),j.value&&!u.value&&!n.value?(v(),k("div",We,[p.value?(v(),k("div",_e,[c("div",{class:"flex items-start gap-2"},[t[1]||(t[1]=fe('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="flex-1"><p class="text-xs font-medium text-foreground">Daha fazla içerik keşfet!</p><p class="mt-1 text-xs text-muted-foreground">Sidebar&#39;ı açmak için tıklayın</p></div>',2)),c("button",{onClick:L,class:"flex-shrink-0 text-muted-foreground hover:text-foreground"},[...t[0]||(t[0]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):D("",!0),c("button",{onClick:re,class:"flex h-12 w-12 items-center justify-center rounded-full bg-primary text-primary-foreground shadow-lg transition-all hover:scale-110 hover:shadow-xl",title:r.value?"Sidebar'ı Gizle (Odaklanmış Okuma)":"Sidebar'ı Göster (Daha Fazla İçerik)"},[r.value?(v(),k("svg",Me,[...t[2]||(t[2]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)])])):(v(),k("svg",Le,[...t[3]||(t[3]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 5l7 7-7 7M5 5l7 7-7 7"},null,-1)])]))],8,Ie)])):D("",!0),R(be,{isCollapsed:!u.value&&(n.value||r.value),"show-sidebar-on-mobile":w.value,"show-main-content-on-mobile":E.value},{sidebar:$(()=>[w.value&&!u.value&&x.value&&(n.value||r.value)?(v(),A(we,{key:0,max:5,include:["SidebarLayoutWrite","SidebarLayoutCategory"]},[(v(),A(pe(q.value),{key:M.value,"onUpdate:isNarrow":X},null,32))],1024)):D("",!0)]),default:$(()=>[c("div",{class:me([E.value?"block":"hidden lg:block",J.value])},[ge(e.$slots,"screen")],2)]),_:3},8,["isCollapsed","show-sidebar-on-mobile","show-main-content-on-mobile"])],64))}});export{Je as default};
