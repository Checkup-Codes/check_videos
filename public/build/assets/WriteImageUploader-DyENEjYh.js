import{g as u,s as E,D as b,c as a,a as t,i as F,n as _,q as L,j as f,h as k,k as H,t as C,F as U,l as V,o as l}from"./ssr-BEZ_aUjz.js";const A={class:"rounded-lg border border-border bg-card"},N={class:"flex items-center justify-between border-b border-border px-4 py-3"},Y={class:"p-4 space-y-4"},G={class:"space-y-1 text-center"},q={class:"flex text-sm text-muted-foreground"},K={class:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80"},P={key:0,class:"flex items-center gap-2 text-sm text-muted-foreground"},J={key:1,class:"rounded-md bg-destructive/10 p-3 text-sm text-destructive"},W={key:2,class:"space-y-2"},O={class:"grid grid-cols-3 gap-2"},Q=["onDragstart"],X=["src","alt"],Z={class:"absolute inset-0 flex items-center justify-center gap-1 bg-black/60 opacity-0 transition-opacity group-hover:opacity-100"},ee=["onClick"],te=["onClick"],re=["onClick"],oe={key:3,class:"fixed bottom-4 right-4 z-50 rounded-lg bg-foreground px-4 py-2 text-background shadow-lg"},ae={__name:"WriteImageUploader",props:{writeId:{type:String,default:null},category:{type:String,default:"writes"}},emits:["insert-image"],setup(D,{expose:M,emit:$}){const d=D,I=$,v=u(!0),m=u(!1),y=u(!1),c=u(""),g=u(""),s=u([]);E(async()=>{d.writeId&&await h()});const h=async()=>{try{const r=await b.get("/api/write-images",{params:{category:d.category,related_id:d.writeId}});s.value=r.data.images||[]}catch(r){console.error("Failed to load images:",r)}},j=r=>{const e=r.target.files;e.length>0&&w(Array.from(e)),r.target.value=""},B=r=>{m.value=!1;const e=r.dataTransfer.files;e.length>0&&w(Array.from(e))},w=async r=>{var o,n;y.value=!0,c.value="";const e=new FormData;e.append("category",d.category),d.writeId&&e.append("related_id",d.writeId),r.forEach((i,x)=>{e.append(`images[${x}]`,i),e.append(`titles[${x}]`,i.name),e.append(`alt_texts[${x}]`,i.name)});try{const i=await b.post("/write-images",e,{headers:{"Content-Type":"multipart/form-data"}});s.value=[...s.value,...i.data.images],p("Resimler yüklendi!")}catch(i){c.value=((n=(o=i.response)==null?void 0:o.data)==null?void 0:n.message)||"Yükleme başarısız oldu."}finally{y.value=!1}},T=async r=>{try{await b.delete(`/write-images/${r}`),s.value=s.value.filter(e=>e.id!==r),p("Resim silindi")}catch{c.value="Silme başarısız oldu."}},S=async r=>{try{await navigator.clipboard.writeText(r),p("URL kopyalandı!")}catch{p("Kopyalama başarısız")}},z=r=>{I("insert-image",r),p("Resim editöre eklendi")},R=(r,e)=>{r.dataTransfer.setData("text/plain",e.full_url),r.dataTransfer.setData("text/html",`<img src="${e.full_url}" alt="${e.alt_text}" />`),r.dataTransfer.effectAllowed="copy"},p=r=>{g.value=r,setTimeout(()=>{g.value=""},2e3)};return M({uploadedImages:s,loadImages:h}),(r,e)=>(l(),a("div",A,[t("div",N,[e[4]||(e[4]=t("h3",{class:"text-sm font-medium text-foreground"},"Resim Yükle",-1)),t("button",{type:"button",onClick:e[0]||(e[0]=o=>v.value=!v.value),class:"text-muted-foreground hover:text-foreground"},[(l(),a("svg",{class:_(["h-5 w-5 transition-transform",{"rotate-180":v.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[3]||(e[3]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),F(t("div",Y,[t("div",{class:_(["flex justify-center rounded-md border-2 border-dashed border-border px-4 py-6 transition-colors",{"border-primary bg-primary/5":m.value}]),onDragover:e[1]||(e[1]=k(o=>m.value=!0,["prevent"])),onDragleave:e[2]||(e[2]=k(o=>m.value=!1,["prevent"])),onDrop:k(B,["prevent"])},[t("div",G,[e[7]||(e[7]=t("svg",{class:"mx-auto h-10 w-10 text-muted-foreground",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[t("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),t("div",q,[t("label",K,[e[5]||(e[5]=t("span",null,"Resim Seç",-1)),t("input",{type:"file",multiple:"",accept:"image/*",class:"sr-only",onChange:j},null,32)]),e[6]||(e[6]=t("p",{class:"pl-1"},"veya sürükle bırak",-1))]),e[8]||(e[8]=t("p",{class:"text-xs text-muted-foreground"},"PNG, JPG, GIF - max 5MB",-1))])],34),y.value?(l(),a("div",P,[...e[9]||(e[9]=[t("svg",{class:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),H(" Yükleniyor... ",-1)])])):f("",!0),c.value?(l(),a("div",J,C(c.value),1)):f("",!0),s.value.length>0?(l(),a("div",W,[e[13]||(e[13]=t("p",{class:"text-xs font-medium text-muted-foreground"},"Yüklenen Resimler (Editöre sürükleyin)",-1)),t("div",O,[(l(!0),a(U,null,V(s.value,o=>(l(),a("div",{key:o.id,class:"group relative aspect-square overflow-hidden rounded-md border border-border cursor-grab active:cursor-grabbing",draggable:"true",onDragstart:n=>R(n,o)},[t("img",{src:o.image_path,alt:o.alt_text,class:"h-full w-full object-cover"},null,8,X),t("div",Z,[t("button",{type:"button",onClick:n=>S(o.full_url),class:"rounded-full bg-primary p-1.5 text-primary-foreground hover:bg-primary/90",title:"URL Kopyala"},[...e[10]||(e[10]=[t("svg",{class:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,ee),t("button",{type:"button",onClick:n=>z(o),class:"rounded-full bg-green-600 p-1.5 text-white hover:bg-green-700",title:"Editöre Ekle"},[...e[11]||(e[11]=[t("svg",{class:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,te),t("button",{type:"button",onClick:n=>T(o.id),class:"rounded-full bg-destructive p-1.5 text-destructive-foreground hover:bg-destructive/90",title:"Sil"},[...e[12]||(e[12]=[t("svg",{class:"h-3.5 w-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,re)])],40,Q))),128))])])):f("",!0),g.value?(l(),a("div",oe,C(g.value),1)):f("",!0)],512),[[L,v.value]])]))}};export{ae as _};
