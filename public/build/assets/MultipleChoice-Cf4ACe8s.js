import{Q as ee,p as x,r as b,m as te,c as l,o as i,a as s,t as o,F as P,g as W,h as w,n as y,S as se,U as ne,N as re,f as oe,I as ae}from"./ssr-CelVhnxm.js";import{g as d}from"./index-D3jsOSc0.js";import{_ as le}from"./app-DqonJLi-.js";/* empty css            */const f=m=>(se("data-v-a8783795"),m=m(),ne(),m),ie={class:"flex flex-col items-center justify-center"},ce={key:0,class:"w-full max-w-2xl rounded-lg border border-base-300 bg-base-100 p-6"},ue={class:"mb-4 text-center"},de=f(()=>s("h2",{class:"mb-2 text-xl font-semibold text-base-content"},"Test Tamamlandı",-1)),ge={class:"inline-flex items-center gap-2 rounded bg-base-200 px-3 py-1"},xe=f(()=>s("span",{class:"text-base-content/70 text-sm"},"Puan:",-1)),be={class:"text-lg font-bold text-base-content"},fe={class:"mb-4 grid grid-cols-2 gap-4"},ve={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},pe={class:"mb-1"},me={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100"},_e={class:"text-sm font-bold text-green-600"},he=f(()=>s("p",{class:"text-base-content/70 text-xs"},"Doğru",-1)),we={class:"rounded border border-base-300 bg-base-200 p-3 text-center"},ye={class:"mb-1"},Ce={class:"mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-red-100"},ke={class:"text-sm font-bold text-red-600"},Ie=f(()=>s("p",{class:"text-base-content/70 text-xs"},"Yanlış",-1)),Se={class:"mb-4"},Qe=f(()=>s("h3",{class:"mb-2 text-sm font-medium text-base-content"},"Cevaplarınız",-1)),Ae={class:"max-h-48 space-y-2 overflow-y-auto"},Oe={class:"flex items-center gap-2"},Te={class:"flex flex-col"},Me={class:"text-sm font-medium text-base-content"},Re={class:"text-base-content/70 text-xs"},Pe={class:"space-y-2"},We=["disabled"],De={class:"flex gap-2"},je={key:1,class:"w-full max-w-4xl rounded-lg border border-base-300 bg-base-100 p-6"},He={class:"mb-4 h-1 w-full overflow-hidden rounded-full bg-base-200"},Be={class:"mb-6 text-right"},ze={class:"text-base-content/70 text-sm"},Le={class:"mb-2 text-2xl font-semibold text-base-content"},Ne=f(()=>s("p",{class:"text-base-content/70 mb-3"},"Bu kelimenin anlamı nedir?",-1)),Ge={class:"inline-flex items-center rounded border border-base-300 bg-base-200 px-2 py-1 text-xs text-base-content"},Ue={key:0,class:"rounded border border-base-300 bg-base-200 p-3"},$e={class:"mb-2 flex items-center justify-between"},Ee=f(()=>s("p",{class:"text-sm font-medium text-base-content"},"Örnek Cümle",-1)),Fe={class:"text-sm text-base-content"},qe=["onClick","disabled"],Ve={class:"flex items-center gap-3"},Ye={class:"flex h-6 w-6 items-center justify-center rounded-full bg-base-content text-xs font-bold text-base-100"},Ze={key:1,class:"text-center"},Je={__name:"MultipleChoice",props:{gameType:String,packSlug:String,words:Array,gameConfig:Object},emits:["game-completed"],setup(m,{emit:D}){const c=m,C=D,k=ee(),j=k.props.languagePacks||[],I=x(()=>{var t;return!!((t=k.props.auth)!=null&&t.user)});x(()=>c.packSlug?j.find(t=>t.slug===c.packSlug):null);const e=b({isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0}),v=b([]),S=x(()=>Object.fromEntries(v.value.map(t=>[t.id,t]))),Q=b(null),A=b(null),O=b(null),T=b(null),p=b(!1),H=()=>{d.fromTo(T.value,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power2.out"}),d.fromTo(Q.value.children,{opacity:0,x:-20},{opacity:1,x:0,duration:.3,stagger:.1,ease:"power2.out"})},B=t=>{d.to(t,{scale:1.05,duration:.2,backgroundColor:"#ecfdf5",borderColor:"#34d399",ease:"power2.out"}),d.to(t,{scale:1,duration:.2,delay:.2})},z=t=>{d.timeline().to(t,{scale:1.05,duration:.2,backgroundColor:"#fef2f2",borderColor:"#f87171",ease:"power2.out"}).to(t,{x:-10,duration:.1}).to(t,{x:10,duration:.1}).to(t,{x:-5,duration:.1}).to(t,{x:5,duration:.1}).to(t,{x:0,scale:1,duration:.2})},L=t=>{d.to(A.value,{width:`${t}%`,duration:.5,ease:"power2.out"}),d.fromTo(O.value,{x:"-100%"},{x:"100%",duration:1,ease:"none",repeat:-1}),d.to(O.value,{opacity:t===100?0:.5,duration:.3})},N=()=>{e.value.currentIndex++,e.value.progress=Math.round(e.value.currentIndex/e.value.totalQuestions*100),e.value.currentIndex<e.value.totalQuestions?(e.value.selectedAnswer=null,e.value.showAnswer=!1,e.value.currentOptions=[],e.value.hintShown=v.value[e.value.currentIndex].example_sentences&&v.value[e.value.currentIndex].example_sentences.length>0,e.value.currentHintIndex=0,e.value.currentQuestion=v.value[e.value.currentIndex],ae(()=>{H()})):e.value.isPlaying=!1},M=async()=>{if(!c.words||c.words.length<2){alert("Oyunu başlatmak için en az 2 kelime gereklidir.");return}e.value.isLoading=!0;let t=[...c.words];if(c.gameConfig.prioritizeUnlearned){const n=t.filter(u=>u.learning_status===0),a=t.filter(u=>u.learning_status===1),g=t.filter(u=>u.learning_status===2);t=[...n,...a,...g]}c.gameConfig.prioritizeRecentlyLearned&&t.sort((n,a)=>{const g=new Date(n.last_reviewed_at||0);return new Date(a.last_reviewed_at||0)-g}),c.gameConfig.prioritizeFlagged&&t.sort((n,a)=>n.is_flagged&&!a.is_flagged?-1:!n.is_flagged&&a.is_flagged?1:0),c.gameConfig.prioritizeMostIncorrect&&t.sort((n,a)=>{const g=n.incorrect_count||0;return(a.incorrect_count||0)-g}),t=t.sort(()=>Math.random()-.5);const r=Math.min(c.gameConfig.questionCount,t.length);t=t.slice(0,r),e.value={isLoading:!1,isPlaying:!0,currentQuestion:t[0],currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:t.length,userResponses:[],hintShown:t[0].example_sentences&&t[0].example_sentences.length>0,currentHintIndex:0},v.value=t},G=x(()=>{if(!e.value.userResponses.length)return 0;const t=e.value.userResponses.filter(r=>r.correct).length;return Math.round(t/e.value.userResponses.length*100)}),U=t=>{switch(t){case"noun":return"İsim";case"verb":return"Fiil";case"adjective":return"Sıfat";case"adverb":return"Zarf";default:return"Bilinmiyor"}},$=x(()=>e.value.userResponses.filter(t=>t.correct).length),E=x(()=>e.value.userResponses.filter(t=>!t.correct).length),F=x(()=>e.value.currentQuestion?(e.value.currentOptions.length===0&&(e.value.currentOptions=X(e.value.currentQuestion,v.value)),e.value.currentOptions):[]),q=t=>{e.value.selectedAnswer=t,e.value.showAnswer=!0,e.value.isCorrect=R(t,e.value.currentQuestion),e.value.userResponses.push({word_id:e.value.currentQuestion.id,selected_option:t.meaningText,correct:e.value.isCorrect});const r=event.target;e.value.isCorrect?B(r):z(r);const n=Math.round((e.value.currentIndex+1)/e.value.totalQuestions*100);L(n),setTimeout(()=>{N()},1500)},V=()=>{e.value={isLoading:!0,isPlaying:!1,currentQuestion:null,currentOptions:[],selectedAnswer:null,showAnswer:!1,isCorrect:!1,progress:0,currentIndex:0,totalQuestions:0,userResponses:[],hintShown:!1,currentHintIndex:0},M()},Y=()=>{if(!I.value||!e.value.userResponses.length||p.value)return;p.value=!0;const t=e.value.userResponses.map(r=>({word_id:r.word_id,review_count:1,incorrect_count:r.correct?0:1}));re.post("/update-words",{words:t},{preserveState:!0,onSuccess:()=>{console.log("İstatistikler başarıyla güncellendi"),p.value=!1,C("game-completed")},onError:r=>{console.error("İstatistik güncelleme hatası:",r),p.value=!1}})},Z=()=>{if(!e.value.currentQuestion.example_sentences||e.value.currentQuestion.example_sentences.length===0){e.value.hintShown=!0;return}e.value.hintShown?e.value.currentHintIndex=(e.value.currentHintIndex+1)%e.value.currentQuestion.example_sentences.length:(e.value.hintShown=!0,e.value.currentHintIndex=0)},_=t=>{if(!t)return"";if(t.meanings&&t.meanings.length>0){const r=t.meanings.find(n=>n.is_primary);return r?r.meaning:t.meanings[0].meaning}return t.meaning||""},R=(t,r)=>!t||!r?!1:t.wordId===r.id,J=t=>{var r;return((r=e.value.selectedAnswer)==null?void 0:r.wordId)===t.wordId},K=(t,r)=>e.value.showAnswer?R(t,e.value.currentQuestion)?"border-green-500 bg-green-50 text-green-800":J(t)?"border-red-500 bg-red-50 text-red-800":"border-base-300 bg-base-100 text-base-content":"border-base-300 bg-base-100 text-base-content",X=(t,r,n=4)=>{const a={wordId:t.id,meaningText:_(t),isCorrect:!0};return[...[...r.filter(h=>h.id!==t.id&&_(h)!==_(t))].sort(()=>.5-Math.random()).slice(0,n-1).map(h=>({wordId:h.id,meaningText:_(h),isCorrect:!1})),a].sort(()=>.5-Math.random())};return te(()=>{M()}),(t,r)=>(i(),l("div",ie,[!e.value.isPlaying&&e.value.userResponses.length>0?(i(),l("div",ce,[s("div",ue,[de,s("div",ge,[xe,s("span",be,o(G.value)+" / 100",1)])]),s("div",fe,[s("div",ve,[s("div",pe,[s("div",me,[s("span",_e,o($.value),1)])]),he]),s("div",we,[s("div",ye,[s("div",Ce,[s("span",ke,o(E.value),1)])]),Ie])]),s("div",Se,[Qe,s("div",Ae,[(i(!0),l(P,null,W(e.value.userResponses,n=>{var a;return i(),l("div",{key:n.word_id,class:"flex items-center justify-between rounded border border-base-300 bg-base-200 p-2"},[s("div",Oe,[s("div",{class:y(["flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold",n.correct?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},o(n.correct?"✓":"✗"),3),s("div",Te,[s("span",Me,o(((a=S.value[n.word_id])==null?void 0:a.word)||"Unknown"),1),s("span",Re,o(_(S.value[n.word_id])),1)])]),s("span",{class:y(["inline-flex items-center rounded px-2 py-1 text-xs font-medium",n.correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},o(n.correct?"Doğru":"Yanlış"),3)])}),128))])]),s("div",Pe,[I.value?(i(),l("button",{key:0,onClick:Y,class:"w-full rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content",disabled:p.value},o(p.value?"Güncelleniyor...":"İstatistikleri Güncelle"),9,We)):w("",!0),s("div",De,[s("button",{onClick:r[0]||(r[0]=n=>C("game-completed")),class:"flex-1 rounded border border-base-300 bg-base-content px-4 py-2 text-center text-sm font-medium text-base-100 transition hover:bg-base-300 hover:text-base-content"}," Pakete Dön "),s("button",{onClick:V,class:"flex-1 rounded border border-base-300 px-4 py-2 text-sm font-medium text-base-content transition hover:bg-base-200"}," Tekrar Başla ")])])])):(i(),l("div",je,[s("div",He,[s("div",{ref_key:"progressBar",ref:A,class:"h-full w-0 bg-base-content transition-all duration-500"},null,512)]),s("div",Be,[s("span",ze," Soru "+o(e.value.currentIndex+1)+" / "+o(e.value.totalQuestions),1)]),e.value.currentQuestion?(i(),l("div",{key:0,class:"space-y-4",ref_key:"questionContainer",ref:T},[s("div",null,[s("h2",Le,'"'+o(e.value.currentQuestion.word)+'"',1),Ne,s("span",Ge,o(U(e.value.currentQuestion.type)),1)]),e.value.currentQuestion.example_sentences&&e.value.currentQuestion.example_sentences.length>0?(i(),l("div",Ue,[s("div",$e,[Ee,e.value.currentQuestion.example_sentences.length>1?(i(),l("button",{key:0,onClick:Z,class:"text-base-content/70 text-xs transition-colors hover:text-base-content"}," Sonraki ("+o(e.value.currentHintIndex+1)+"/"+o(e.value.currentQuestion.example_sentences.length)+") ",1)):w("",!0)]),s("p",Fe,o(e.value.currentQuestion.example_sentences[e.value.currentHintIndex].sentence),1)])):w("",!0),s("div",{class:"space-y-2",ref_key:"optionsContainer",ref:Q},[(i(!0),l(P,null,W(F.value,(n,a)=>(i(),l("button",{key:`${e.value.currentIndex}-${a}`,onClick:g=>q(n),disabled:e.value.showAnswer,class:y(["w-full rounded border border-base-300 bg-base-100 p-3 text-left text-base text-base-content transition-all duration-200 hover:bg-base-200 disabled:cursor-not-allowed",K(n)])},[s("div",Ve,[s("span",Ye,o(String.fromCharCode(65+a)),1),oe(" "+o(n.meaningText),1)])],10,qe))),128))],512),e.value.showAnswer?(i(),l("div",Ze,[s("p",{class:y(["text-lg font-medium",e.value.isCorrect?"text-green-600":"text-red-600"])},o(e.value.isCorrect?"Doğru!":"Yanlış!"),3)])):w("",!0)],512)):w("",!0)]))]))}},rt=le(Je,[["__scopeId","data-v-a8783795"]]);export{rt as default};
